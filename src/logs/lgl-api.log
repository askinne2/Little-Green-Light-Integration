[2025-09-29 20:53:45] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:53:46] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:55:19] [debug] Membership cron jobs scheduled successfully
[2025-09-29 20:55:19] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87949
    [timestamp] => 2025-09-29 20:55:19
    [memory_usage] => 122MB
)

[2025-09-29 20:55:19] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87949
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 0
    [customer_email] => 
    [payment_method] => 
    [order_date] => 2025-09-29 20:55:19
    [item_count] => 0
)

[2025-09-29 20:55:19] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => 
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-09-29 20:55:19] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-29 20:55:19] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-09-29 20:55:19] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-29 20:55:19] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 0
    [order_id] => 87949
)

[2025-09-29 20:55:19] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-29 20:55:19] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87949
    [final_memory_usage] => 122MB
)

[2025-09-29 20:55:19] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-29 20:55:20] [debug] Membership cron jobs scheduled successfully
[2025-09-29 20:55:46] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:55:47] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:56:26] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:56:27] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:56:45] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:56:50] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:56:57] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:57:05] [debug] Membership cron jobs scheduled successfully
[2025-09-29 20:57:06] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87951
    [timestamp] => 2025-09-29 20:57:06
    [memory_usage] => 122MB
)

[2025-09-29 20:57:06] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87951
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 0
    [customer_email] => 
    [payment_method] => 
    [order_date] => 2025-09-29 20:57:06
    [item_count] => 0
)

[2025-09-29 20:57:06] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => 
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-09-29 20:57:06] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-29 20:57:06] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-09-29 20:57:06] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-29 20:57:06] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 0
    [order_id] => 87951
)

[2025-09-29 20:57:06] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-29 20:57:06] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87951
    [final_memory_usage] => 122MB
)

[2025-09-29 20:57:06] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-29 20:57:06] [debug] Membership cron jobs scheduled successfully
[2025-09-29 20:57:28] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:57:30] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:57:46] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:57:47] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:57:48] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:57:49] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:58:03] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:58:08] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:59:11] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:59:12] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:59:13] [debug] Membership cron jobs scheduled successfully
[2025-09-29 20:59:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87953
    [timestamp] => 2025-09-29 20:59:13
    [memory_usage] => 130MB
)

[2025-09-29 20:59:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87953
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 0
    [customer_email] => 
    [payment_method] => 
    [order_date] => 2025-09-29 20:59:13
    [item_count] => 0
)

[2025-09-29 20:59:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => 
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-09-29 20:59:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-29 20:59:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-09-29 20:59:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-29 20:59:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 0
    [order_id] => 87953
)

[2025-09-29 20:59:13] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-29 20:59:13] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87953
    [final_memory_usage] => 130MB
)

[2025-09-29 20:59:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-29 20:59:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-29 20:59:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87953
    [timestamp] => 2025-09-29 20:59:13
    [memory_usage] => 132MB
)

[2025-09-29 20:59:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87953
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 0
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-09-29 20:59:13
    [item_count] => 1
)

[2025-09-29 20:59:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-09-29 20:59:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-29 20:59:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-09-29 20:59:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-29 20:59:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 0
    [order_id] => 87953
)

[2025-09-29 20:59:13] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Debug Test Individual Membership
    [quantity] => 1
    [product_id] => 87952
    [parent_id] => 87952
    [categories] => Array
        (
            [0] => membership
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-09-29 20:59:13] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Debug Test Individual Membership
    [is_membership] => NO
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => membership
        )

)

[2025-09-29 20:59:13] [debug] âš ï¸ OrderProcessor: UNRECOGNIZED PRODUCT TYPE Array
(
    [product_name] => Debug Test Individual Membership
    [product_id] => 87952
    [categories] => Array
        (
            [0] => membership
        )

    [action] => Skipping product - no handler available
)

[2025-09-29 20:59:13] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-29 20:59:13] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87953
    [final_memory_usage] => 132MB
)

[2025-09-29 20:59:15] [debug] Membership cron jobs scheduled successfully
[2025-09-29 20:59:17] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:59:28] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:59:48] [debug] SettingsManager: Initialized successfully
[2025-09-29 20:59:49] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:38] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:39] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:45] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:45] [debug] Membership cron jobs scheduled successfully
[2025-09-29 21:00:46] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:47] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:47] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:48] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:48] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:50] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:56] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:00:57] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:01] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:03] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:03] [debug] Membership cron jobs scheduled successfully
[2025-09-29 21:01:05] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:08] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:08] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:08] [debug] Membership cron jobs scheduled successfully
[2025-09-29 21:01:11] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:17] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:18] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:19] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:20] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:28] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:30] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:39] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:48] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:49] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:01:50] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:02:58] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:03:03] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:03:13] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:03:33] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:03:37] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:03:39] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:03:43] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:03:49] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:03:51] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:03:53] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:04:02] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:04:03] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:04:03] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:05:04] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:05:50] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:05:52] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:06:03] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:07:04] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:07:51] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:07:53] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:08:04] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:09:05] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:10:26] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:10:27] [debug] SettingsManager: Initialized successfully
[2025-09-29 21:10:38] [debug] SettingsManager: Initialized successfully
[2025-09-29 22:38:46] [debug] SettingsManager: Initialized successfully
[2025-09-29 22:38:47] [debug] SettingsManager: Initialized successfully
[2025-09-29 22:58:05] [debug] SettingsManager: Initialized successfully
[2025-09-29 23:00:16] [debug] SettingsManager: Initialized successfully
[2025-09-29 23:46:25] [debug] SettingsManager: Initialized successfully
[2025-09-29 23:46:26] [debug] SettingsManager: Initialized successfully
[2025-09-29 23:46:26] [debug] SettingsManager: Initialized successfully
[2025-09-30 00:43:10] [debug] SettingsManager: Initialized successfully
[2025-09-30 00:43:11] [debug] SettingsManager: Initialized successfully
[2025-09-30 02:16:29] [debug] SettingsManager: Initialized successfully
[2025-09-30 02:16:31] [debug] SettingsManager: Initialized successfully
[2025-09-30 02:16:39] [debug] SettingsManager: Initialized successfully
[2025-09-30 03:19:20] [debug] SettingsManager: Initialized successfully
[2025-09-30 03:19:21] [debug] SettingsManager: Initialized successfully
[2025-09-30 03:19:27] [debug] Membership cron jobs scheduled successfully
[2025-09-30 03:19:28] [debug] Membership cron jobs scheduled successfully
[2025-09-30 04:32:43] [debug] SettingsManager: Initialized successfully
[2025-09-30 04:32:46] [debug] SettingsManager: Initialized successfully
[2025-09-30 04:55:39] [debug] SettingsManager: Initialized successfully
[2025-09-30 04:55:40] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:48:46] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:48:46] [debug] Starting daily membership renewal check
[2025-09-30 05:48:46] [debug] Starting membership renewal processing
[2025-09-30 05:48:46] [debug] User 794: -396 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1118 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 795 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1853 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1119: -522 days until renewal
[2025-09-30 05:48:46] [debug] User 796: -249 days until renewal
[2025-09-30 05:48:46] [debug] User 1120: -470 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1559 - not in-person membership
[2025-09-30 05:48:46] [debug] User 797: -306 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1713 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1121: 355837 days until renewal
[2025-09-30 05:48:46] [debug] User 798: -388 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1787 - not in-person membership
[2025-09-30 05:48:46] [debug] User 799: -504 days until renewal
[2025-09-30 05:48:46] [debug] User 1122: -217 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1679 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1545 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1364 - not in-person membership
[2025-09-30 05:48:46] [debug] User 801: -304 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1335 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1642 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1432 - not in-person membership
[2025-09-30 05:48:46] [debug] User 802: -451 days until renewal
[2025-09-30 05:48:46] [debug] User 803: -257 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 804 - not in-person membership
[2025-09-30 05:48:46] [debug] User 805: -572 days until renewal
[2025-09-30 05:48:46] [debug] User 806: -434 days until renewal
[2025-09-30 05:48:46] [debug] User 807: -221 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1357 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1299 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1608 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1560 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1402 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1091: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1780 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1123 - not in-person membership
[2025-09-30 05:48:46] [debug] User 808: 355837 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1384 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1806 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1662 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1783 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1233: -165 days until renewal
[2025-09-30 05:48:46] [debug] User 809: 355837 days until renewal
[2025-09-30 05:48:46] [debug] User 810: -291 days until renewal
[2025-09-30 05:48:46] [debug] User 811: -411 days until renewal
[2025-09-30 05:48:46] [debug] User 812: -228 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1727 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1567 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1724 - not in-person membership
[2025-09-30 05:48:46] [debug] User 813: -263 days until renewal
[2025-09-30 05:48:46] [debug] User 814: 355837 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1599 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1729 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1230 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1309 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1248 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 815 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1268 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1124: -269 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1232 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1753 - not in-person membership
[2025-09-30 05:48:46] [debug] User 816: -333 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1362 - not in-person membership
[2025-09-30 05:48:46] [debug] User 817: -287 days until renewal
[2025-09-30 05:48:46] [debug] User 1092: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1804 - not in-person membership
[2025-09-30 05:48:46] [debug] User 818: -368 days until renewal
[2025-09-30 05:48:46] [debug] User 1125: -290 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 819 - not in-person membership
[2025-09-30 05:48:46] [debug] User 820: -433 days until renewal
[2025-09-30 05:48:46] [debug] User 821: -242 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1416 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1606 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1126: -375 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1412 - not in-person membership
[2025-09-30 05:48:46] [debug] User 822: 355837 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1658 - not in-person membership
[2025-09-30 05:48:46] [debug] User 823: -275 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 824 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1127: -528 days until renewal
[2025-09-30 05:48:46] [debug] User 825: -267 days until renewal
[2025-09-30 05:48:46] [debug] User 826: 97 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1631 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1128: -286 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1394 - not in-person membership
[2025-09-30 05:48:46] [debug] User 827: -221 days until renewal
[2025-09-30 05:48:46] [debug] User 1129: -564 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1615 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1613 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1290 - not in-person membership
[2025-09-30 05:48:46] [debug] User 828: -348 days until renewal
[2025-09-30 05:48:46] [debug] User 829: -448 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1820 - not in-person membership
[2025-09-30 05:48:46] [debug] User 830: -253 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1404 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1618 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1093: -251 days until renewal
[2025-09-30 05:48:46] [debug] User 831: -580 days until renewal
[2025-09-30 05:48:46] [debug] User 832: -315 days until renewal
[2025-09-30 05:48:46] [debug] User 1130: -488 days until renewal
[2025-09-30 05:48:46] [debug] User 833: -521 days until renewal
[2025-09-30 05:48:46] [debug] User 834: -402 days until renewal
[2025-09-30 05:48:46] [debug] User 835: -379 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1803 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1298 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 836 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1815 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1480 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 837 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1433 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1277 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1816 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1800 - not in-person membership
[2025-09-30 05:48:46] [debug] User 838: 147 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1851 - not in-person membership
[2025-09-30 05:48:46] [debug] User 839: -397 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1682 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1779 - not in-person membership
[2025-09-30 05:48:46] [debug] User 840: -289 days until renewal
[2025-09-30 05:48:46] [debug] User 1094: -496 days until renewal
[2025-09-30 05:48:46] [debug] User 1131: -409 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1546 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1329 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1132 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1095: 106 days until renewal
[2025-09-30 05:48:46] [debug] User 841: -273 days until renewal
[2025-09-30 05:48:46] [debug] User 1087: 355837 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1730 - not in-person membership
[2025-09-30 05:48:46] [debug] User 842: -404 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1312 - not in-person membership
[2025-09-30 05:48:46] [debug] User 843: -242 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1096 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1417 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1625 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1376 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1822 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1771 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1594 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1764 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1478 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1133 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1502 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1784 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1414 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1735 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1097: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 844 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1134: -556 days until renewal
[2025-09-30 05:48:46] [debug] User 845: -235 days until renewal
[2025-09-30 05:48:46] [debug] User 846: -221 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1266 - not in-person membership
[2025-09-30 05:48:46] [debug] User 847: -404 days until renewal
[2025-09-30 05:48:46] [debug] User 1135: -511 days until renewal
[2025-09-30 05:48:46] [debug] User 848: -280 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1652 - not in-person membership
[2025-09-30 05:48:46] [debug] User 849: -422 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1296 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1427 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1257 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1430 - not in-person membership
[2025-09-30 05:48:46] [debug] User 850: -260 days until renewal
[2025-09-30 05:48:46] [debug] User 851: -261 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1634 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1641 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1136: -490 days until renewal
[2025-09-30 05:48:46] [debug] User 1137: -565 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1138 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1368 - not in-person membership
[2025-09-30 05:48:46] [debug] User 852: -509 days until renewal
[2025-09-30 05:48:46] [debug] User 853: -519 days until renewal
[2025-09-30 05:48:46] [debug] User 854: -250 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1825 - not in-person membership
[2025-09-30 05:48:46] [debug] User 855: -404 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1540 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1508 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1805 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1428 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1782 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 856 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 857 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1273 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1616 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1760 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1140 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 858 - not in-person membership
[2025-09-30 05:48:46] [debug] User 859: -515 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1344 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1667 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1141: -289 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 860 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1858 - not in-person membership
[2025-09-30 05:48:46] [debug] User 861: -254 days until renewal
[2025-09-30 05:48:46] [debug] User 1142: -563 days until renewal
[2025-09-30 05:48:46] [debug] User 862: -520 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1854 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 863 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1143: -459 days until renewal
[2025-09-30 05:48:46] [debug] User 864: -235 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 865 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 866 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1144: -552 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1280 - not in-person membership
[2025-09-30 05:48:46] [debug] User 867: -514 days until renewal
[2025-09-30 05:48:46] [debug] User 1145: -414 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1601 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1398 - not in-person membership
[2025-09-30 05:48:46] [debug] User 868: -258 days until renewal
[2025-09-30 05:48:46] [debug] User 869: -408 days until renewal
[2025-09-30 05:48:46] [debug] User 870: -419 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1245 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1513 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1630 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1736 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1146 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1147: -263 days until renewal
[2025-09-30 05:48:46] [debug] User 871: -268 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1341 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1812 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1098: 113 days until renewal
[2025-09-30 05:48:46] [debug] User 1099: -251 days until renewal
[2025-09-30 05:48:46] [debug] User 872: -403 days until renewal
[2025-09-30 05:48:46] [debug] User 873: -256 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1744 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1702 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1088: -494 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1288 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1148 - not in-person membership
[2025-09-30 05:48:46] [debug] User 874: -267 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 875 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1715 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1824 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1714 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1149: -214 days until renewal
[2025-09-30 05:48:46] [debug] User 876: -398 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1443 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1525 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1655 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 877 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1150: -277 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1777 - not in-person membership
[2025-09-30 05:48:46] [debug] User 878: -389 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 879 - not in-person membership
[2025-09-30 05:48:46] [debug] User 880: -264 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1550 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1354 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1378 - not in-person membership
[2025-09-30 05:48:46] [debug] User 881: -451 days until renewal
[2025-09-30 05:48:46] [debug] User 882: -508 days until renewal
[2025-09-30 05:48:46] [debug] User 883: 161 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1632 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1221 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 884 - not in-person membership
[2025-09-30 05:48:46] [debug] User 885: -327 days until renewal
[2025-09-30 05:48:46] [debug] User 886: -510 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1619 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1786 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1291 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1152: -385 days until renewal
[2025-09-30 05:48:46] [debug] User 887: -273 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1775 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1790 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1620 - not in-person membership
[2025-09-30 05:48:46] [debug] User 888: -563 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1742 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1153 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 889 - not in-person membership
[2025-09-30 05:48:46] [debug] User 890: -397 days until renewal
[2025-09-30 05:48:46] [debug] User 1154: -412 days until renewal
[2025-09-30 05:48:46] [debug] User 891: -525 days until renewal
[2025-09-30 05:48:46] [debug] User 892: -298 days until renewal
[2025-09-30 05:48:46] [debug] User 1155: -514 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1156 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1157: -503 days until renewal
[2025-09-30 05:48:46] [debug] User 893: -488 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1287 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1338 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1158: -496 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1551 - not in-person membership
[2025-09-30 05:48:46] [debug] User 894: -576 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1509 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1664 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 895 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1811 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1251 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1718 - not in-person membership
[2025-09-30 05:48:46] [debug] User 896: -538 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1481 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1549 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1159: -214 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1571 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1748 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1304 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1317 - not in-person membership
[2025-09-30 05:48:46] [debug] User 897: 355837 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1603 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1564 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1302 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 898 - not in-person membership
[2025-09-30 05:48:46] [debug] User 899: -260 days until renewal
[2025-09-30 05:48:46] [debug] User 900: -564 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1554 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1386 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 901 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1465 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1855 - not in-person membership
[2025-09-30 05:48:46] [debug] User 902: -458 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1316 - not in-person membership
[2025-09-30 05:48:46] [debug] User 903: -502 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1666 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1431 - not in-person membership
[2025-09-30 05:48:46] [debug] User 904: -271 days until renewal
[2025-09-30 05:48:46] [debug] User 1160: -245 days until renewal
[2025-09-30 05:48:46] [debug] User 905: -250 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1355 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1605 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1810 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1289 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 906 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 907 - not in-person membership
[2025-09-30 05:48:46] [debug] User 908: -387 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1239 - not in-person membership
[2025-09-30 05:48:46] [debug] User 909: -516 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 910 - not in-person membership
[2025-09-30 05:48:46] [debug] User 911: -298 days until renewal
[2025-09-30 05:48:46] [debug] User 912: -562 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1425 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1759 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 913 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1161 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1100: 106 days until renewal
[2025-09-30 05:48:46] [debug] User 1101: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1381 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1089: 355837 days until renewal
[2025-09-30 05:48:46] [debug] User 1162: -268 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1469 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1860 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1552 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1315 - not in-person membership
[2025-09-30 05:48:46] [debug] User 914: -438 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1426 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1406 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1595 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1665 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1676 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1597 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1624 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1405 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1336 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1795 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 915 - not in-person membership
[2025-09-30 05:48:46] [debug] User 916: -243 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1773 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 917 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 918 - not in-person membership
[2025-09-30 05:48:46] [debug] User 919: -521 days until renewal
[2025-09-30 05:48:46] [debug] User 920: -405 days until renewal
[2025-09-30 05:48:46] [debug] User 921: -403 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1798 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1423 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1638 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1675 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1163: -462 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1848 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1563 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1409 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1250 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1339 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1797 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1267 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1796 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1670 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1382 - not in-person membership
[2025-09-30 05:48:46] [debug] User 922: -277 days until renewal
[2025-09-30 05:48:46] [debug] User 1103: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1447 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1235 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 923 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1264 - not in-person membership
[2025-09-30 05:48:46] [debug] User 924: -576 days until renewal
[2025-09-30 05:48:46] [debug] User 925: -281 days until renewal
[2025-09-30 05:48:46] [debug] User 1164: -465 days until renewal
[2025-09-30 05:48:46] [debug] User 926: -435 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1589 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1534 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1609 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1556 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1285 - not in-person membership
[2025-09-30 05:48:46] [debug] User 927: -276 days until renewal
[2025-09-30 05:48:46] [debug] User 928: -270 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1345 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1750 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1612 - not in-person membership
[2025-09-30 05:48:46] [debug] User 929: -267 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1165 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1817 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1770 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 930 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1166: -270 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1400 - not in-person membership
[2025-09-30 05:48:46] [debug] User 931: 105 days until renewal
[2025-09-30 05:48:46] [debug] User 932: 355837 days until renewal
[2025-09-30 05:48:46] [debug] User 1167: -395 days until renewal
[2025-09-30 05:48:46] [debug] User 933: -261 days until renewal
[2025-09-30 05:48:46] [debug] User 934: -497 days until renewal
[2025-09-30 05:48:46] [debug] User 935: -386 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1819 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1761 - not in-person membership
[2025-09-30 05:48:46] [debug] User 936: -322 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1265 - not in-person membership
[2025-09-30 05:48:46] [debug] User 937: -578 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 938 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1308 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1168: -410 days until renewal
[2025-09-30 05:48:46] [debug] User 939: -247 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1169 - not in-person membership
[2025-09-30 05:48:46] [debug] User 940: 355837 days until renewal
[2025-09-30 05:48:46] [debug] User 1170: -577 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 941 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1633 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1222 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1390 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1611 - not in-person membership
[2025-09-30 05:48:46] [debug] User 942: -442 days until renewal
[2025-09-30 05:48:46] [debug] User 943: -284 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 944 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1366 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1231 - not in-person membership
[2025-09-30 05:48:46] [debug] User 945: -407 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1387 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1411 - not in-person membership
[2025-09-30 05:48:46] [debug] User 946: -412 days until renewal
[2025-09-30 05:48:46] [debug] User 1104: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 947 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1766 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 948 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1557 - not in-person membership
[2025-09-30 05:48:46] [debug] User 949: -396 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1644 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1333 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1225 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1627 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1808 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1754 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1849 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1234 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 950 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1793 - not in-person membership
[2025-09-30 05:48:46] [debug] User 951: -390 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1172 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1450 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1562 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1622 - not in-person membership
[2025-09-30 05:48:46] [debug] User 952: -523 days until renewal
[2025-09-30 05:48:46] [debug] User 953: 355837 days until renewal
[2025-09-30 05:48:46] [debug] User 954: -402 days until renewal
[2025-09-30 05:48:46] [debug] User 955: -323 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1838 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1173 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1772 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1569 - not in-person membership
[2025-09-30 05:48:46] [debug] User 957: -493 days until renewal
[2025-09-30 05:48:46] [debug] User 958: -221 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1530 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1342 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 959 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1801 - not in-person membership
[2025-09-30 05:48:46] [debug] User 960: -397 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1399 - not in-person membership
[2025-09-30 05:48:46] [debug] User 961: -241 days until renewal
[2025-09-30 05:48:46] [debug] User 962: -261 days until renewal
[2025-09-30 05:48:46] [debug] User 963: -374 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1419 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1445 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1359 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1371 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1774 - not in-person membership
[2025-09-30 05:48:46] [debug] User 965: -243 days until renewal
[2025-09-30 05:48:46] [debug] User 966: -262 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1617 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1794 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1353 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1174: -414 days until renewal
[2025-09-30 05:48:46] [debug] User 967: 122 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1710 - not in-person membership
[2025-09-30 05:48:46] [debug] User 968: -387 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1756 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1175: -283 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1176 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1482 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1555 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 969 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1436 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1799 - not in-person membership
[2025-09-30 05:48:46] [debug] User 970: -420 days until renewal
[2025-09-30 05:48:46] [debug] User 971: -486 days until renewal
[2025-09-30 05:48:46] [debug] User 972: 355837 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1177 - not in-person membership
[2025-09-30 05:48:46] [debug] User 973: -496 days until renewal
[2025-09-30 05:48:46] [debug] User 1105: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1852 - not in-person membership
[2025-09-30 05:48:46] [debug] User 974: -465 days until renewal
[2025-09-30 05:48:46] [debug] User 975: -267 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1458 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1526 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1614 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1424 - not in-person membership
[2025-09-30 05:48:46] [debug] User 976: -253 days until renewal
[2025-09-30 05:48:46] [debug] User 977: -374 days until renewal
[2025-09-30 05:48:46] [debug] User 1178: -571 days until renewal
[2025-09-30 05:48:46] [debug] User 978: -378 days until renewal
[2025-09-30 05:48:46] [debug] User 979: -375 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 980 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1218: -202 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1327 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1659 - not in-person membership
[2025-09-30 05:48:46] [debug] User 981: -538 days until renewal
[2025-09-30 05:48:46] [debug] User 1106: -251 days until renewal
[2025-09-30 05:48:46] [debug] User 982: -410 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1769 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1732 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1179 - not in-person membership
[2025-09-30 05:48:46] [debug] User 983: -404 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1300 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 984 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1636 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1635 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1721 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1536 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1180: -419 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1228 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1181: -221 days until renewal
[2025-09-30 05:48:46] [debug] User 985: -244 days until renewal
[2025-09-30 05:48:46] [debug] User 1182: -517 days until renewal
[2025-09-30 05:48:46] [debug] User 986: -268 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1444 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 987 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1660 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1639 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1763 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 988 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1107: 92 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1183 - not in-person membership
[2025-09-30 05:48:46] [debug] User 989: -516 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1184 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1216: -207 days until renewal
[2025-09-30 05:48:46] [debug] User 990: -421 days until renewal
[2025-09-30 05:48:46] [debug] User 991: -263 days until renewal
[2025-09-30 05:48:46] [debug] User 992: -502 days until renewal
[2025-09-30 05:48:46] [debug] User 993: -509 days until renewal
[2025-09-30 05:48:46] [debug] User 994: -501 days until renewal
[2025-09-30 05:48:46] [debug] User 995: -512 days until renewal
[2025-09-30 05:48:46] [debug] User 996: -578 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1446 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1643 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 997 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1224 - not in-person membership
[2025-09-30 05:48:46] [debug] User 998: -494 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1607 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1584 - not in-person membership
[2025-09-30 05:48:46] [debug] User 999: -374 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1826 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1185: -529 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1186 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1649 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1000: -572 days until renewal
[2025-09-30 05:48:46] [debug] User 1187: -403 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1441 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1001: -235 days until renewal
[2025-09-30 05:48:46] [debug] User 1002: -465 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1188 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1003: -556 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1696 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1722 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1005: -285 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1752 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1006: -561 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1593 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1389 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1007: -424 days until renewal
[2025-09-30 05:48:46] [debug] User 1008: -497 days until renewal
[2025-09-30 05:48:46] [debug] User 1189: -501 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1190 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1009: -377 days until renewal
[2025-09-30 05:48:46] [debug] User 1010: -263 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1435 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1765 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1108: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1637 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1191 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1807 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1109: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1420 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1242 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1192: -429 days until renewal
[2025-09-30 05:48:46] [debug] User 1011: -438 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1012 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1193: -511 days until renewal
[2025-09-30 05:48:46] [debug] User 1013: -323 days until renewal
[2025-09-30 05:48:46] [debug] User 1194: -229 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1195 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1196 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1197: -510 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1198 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1629 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1454 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1014: 355837 days until renewal
[2025-09-30 05:48:46] [debug] User 1199: -405 days until renewal
[2025-09-30 05:48:46] [debug] User 1200: -287 days until renewal
[2025-09-30 05:48:46] [debug] User 1015: -564 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1016 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1747 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1401 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1017: -467 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1610 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1493 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1018 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1523 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1110 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1019: 34 days until renewal
[2025-09-30 05:48:46] [debug] User 1111: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1020 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1254 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1021: -242 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1022 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1262 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1023: -263 days until renewal
[2025-09-30 05:48:46] [debug] User 1201: -293 days until renewal
[2025-09-30 05:48:46] [debug] User 1202: -36 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1751 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1203: -417 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1024 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1025: -359 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1592 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1857 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1442 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1026 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1027: -581 days until renewal
[2025-09-30 05:48:46] [debug] User 1028: -353 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1029 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1030 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1717 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1581 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1031: -557 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1565 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1578 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1654 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1476 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1572 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1346 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1363 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1204: -309 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1223 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1032: -410 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1033 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1034: -371 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1577 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1035 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1205: -456 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1818 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1036: -268 days until renewal
[2025-09-30 05:48:46] [debug] User 1037: -515 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1292 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1038: -501 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1039 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1437 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1579 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1253 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1464 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1283 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1206: -567 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1040 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1112 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1259 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1042: -223 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1275 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1260 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1043: -506 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1241 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1044: -266 days until renewal
[2025-09-30 05:48:46] [debug] User 1045: -542 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1621 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1591 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1046 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1047: -496 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1048 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1657 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1788 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1537 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1049: -572 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1440 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1661 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1383 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1313 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1050: -341 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1548 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1542 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1410 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1361 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1749 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1237 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1051: -527 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1306 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1052: -405 days until renewal
[2025-09-30 05:48:46] [debug] User 1053: -405 days until renewal
[2025-09-30 05:48:46] [debug] User 1217: -203 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1623 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1582 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1054: -214 days until renewal
[2025-09-30 05:48:46] [debug] User 1055: -560 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1575 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1473 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1056: -395 days until renewal
[2025-09-30 05:48:46] [debug] User 1057: -234 days until renewal
[2025-09-30 05:48:46] [debug] User 1058: -418 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1789 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1365 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1059: -415 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1060 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1061: -396 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1429 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1653 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1439 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1278 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1678 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1561 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1062: 355837 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1755 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1063: -557 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1113 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1064: -497 days until renewal
[2025-09-30 05:48:46] [debug] User 1065: -268 days until renewal
[2025-09-30 05:48:46] [debug] User 1219: -201 days until renewal
[2025-09-30 05:48:46] [debug] User 1066: -571 days until renewal
[2025-09-30 05:48:46] [debug] User 1114: -251 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 359 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1535 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1574 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1802 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1115 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1207 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1293 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1067: -555 days until renewal
[2025-09-30 05:48:46] [debug] User 1068: -395 days until renewal
[2025-09-30 05:48:46] [debug] User 1208: -394 days until renewal
[2025-09-30 05:48:46] [debug] User 1069: 114 days until renewal
[2025-09-30 05:48:46] [debug] User 1116: 113 days until renewal
[2025-09-30 05:48:46] [debug] User 1070: -337 days until renewal
[2025-09-30 05:48:46] [debug] User 1071: -291 days until renewal
[2025-09-30 05:48:46] [debug] User 1072: -522 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1073 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1781 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1553 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1074: -400 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1408 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1418 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1768 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1210: -242 days until renewal
[2025-09-30 05:48:46] [debug] User 1075: -571 days until renewal
[2025-09-30 05:48:46] [debug] User 1076: 355837 days until renewal
[2025-09-30 05:48:46] [debug] User 1077: -408 days until renewal
[2025-09-30 05:48:46] [debug] User 1211: -315 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1090 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1078: -276 days until renewal
[2025-09-30 05:48:46] [debug] User 1079: -396 days until renewal
[2025-09-30 05:48:46] [debug] User 1212: -270 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1726 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1809 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1080 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1081 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1082: -263 days until renewal
[2025-09-30 05:48:46] [debug] User 1213: -569 days until renewal
[2025-09-30 05:48:46] [debug] User 1083: -557 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1856 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1085: -526 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1261 - not in-person membership
[2025-09-30 05:48:46] [debug] Skipping user 1741 - not in-person membership
[2025-09-30 05:48:46] [debug] User 1086: -501 days until renewal
[2025-09-30 05:48:46] [debug] Skipping user 1276 - not in-person membership
[2025-09-30 05:48:46] [debug] Membership renewal processing completed Array
(
    [processed] => 778
    [notified] => 0
    [deactivated] => 0
    [skipped] => 778
    [errors] => Array
        (
        )

)

[2025-09-30 05:48:46] [debug] Daily membership check completed Array
(
    [execution_time_ms] => 186.39
    [results] => Array
        (
            [processed] => 778
            [notified] => 0
            [deactivated] => 0
            [skipped] => 778
            [errors] => Array
                (
                )

        )

)

[2025-09-30 05:48:46] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:50:46] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:52:41] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:52:41] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:52:50] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:53:00] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:55:01] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:55:02] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:57:02] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:57:47] [debug] Membership cron jobs scheduled successfully
[2025-09-30 05:57:48] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87959
    [timestamp] => 2025-09-30 05:57:48
    [memory_usage] => 120MB
)

[2025-09-30 05:57:48] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87959
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 0
    [customer_email] => 
    [payment_method] => 
    [order_date] => 2025-09-30 05:57:48
    [item_count] => 0
)

[2025-09-30 05:57:48] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => 
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-09-30 05:57:48] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-30 05:57:48] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-09-30 05:57:48] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 05:57:48] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 0
    [order_id] => 87959
)

[2025-09-30 05:57:48] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-30 05:57:48] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87959
    [final_memory_usage] => 120MB
)

[2025-09-30 05:57:48] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 05:57:48] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87959
    [product_id] => 67487
)

[2025-09-30 05:57:48] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 05:57:48] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87959
    [timestamp] => 2025-09-30 05:57:48
    [memory_usage] => 124MB
)

[2025-09-30 05:57:48] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87959
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 0
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-09-30 05:57:48
    [item_count] => 1
)

[2025-09-30 05:57:48] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-09-30 05:57:48] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-30 05:57:48] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-09-30 05:57:48] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 05:57:48] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 0
    [order_id] => 87959
)

[2025-09-30 05:57:48] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-09-30 05:57:48] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-09-30 05:57:48] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-09-30 05:57:48] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 0
    [order_id] => 87959
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-09-30 05:57:48] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-09-30 05:57:48] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 0
    [order_id] => 87959
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-09-30 05:57:48
)

[2025-09-30 05:57:48] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-09-30 05:57:48] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-09-30 05:57:48] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-09-30 05:57:48] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-09-30 05:57:48] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-09-30 05:57:48] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-09-30 05:57:48] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-09-30 05:57:48] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 0
    [old_role] => customer
    [new_role] => ui_member
)

[2025-09-30 05:57:48] [debug] âŒ Helper: User not found for role change 0
[2025-09-30 05:57:48] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 0
[2025-09-30 05:57:48] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-09-30 05:57:48] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-09-30 05:57:48] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-09-30 05:57:48] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => 
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759226268
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87959
    [user_id] => 0
)

[2025-09-30 05:57:48] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-09-30 05:57:48] [debug] MembershipOrderHandler: User data updated 0
[2025-09-30 05:57:48] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-09-30 05:57:48] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 0
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87959
)

[2025-09-30 05:57:48] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-09-30 05:57:48] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-09-30 05:57:48] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => 
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759226268
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87959
    [user_id] => 0
)

[2025-09-30 05:57:48] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 0
    [success] => Registration call completed
)

[2025-09-30 05:57:48] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 0
    [lgl_api_called] => YES
)

[2025-09-30 05:57:48] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-09-30 05:57:48] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87959
    [user_id] => 0
    [final_membership_level] => Individual Membership
)

[2025-09-30 05:57:48] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-09-30 05:57:48] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-30 05:57:48] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87959
    [final_memory_usage] => 124MB
)

[2025-09-30 05:57:49] [debug] Membership cron jobs scheduled successfully
[2025-09-30 05:59:03] [debug] SettingsManager: Initialized successfully
[2025-09-30 05:59:04] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:00:36] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:00:36] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:00:37] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:00:37] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:00:42] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:00:47] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:00:57] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:01:03] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:01:44] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:01:45] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:01:48] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:01:54] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:02:07] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:02:09] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:02:11] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:02:31] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:02:31] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:02:32] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:02:36] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:02:37] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:03:06] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:03:06] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:03:34] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:03:55] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:05:56] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:05:57] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:06:38] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:06:39] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:07:08] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:07:16] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:07:16] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87960
    [timestamp] => 2025-09-30 06:07:16
    [memory_usage] => 130MB
)

[2025-09-30 06:07:16] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87960
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 0
    [customer_email] => 
    [payment_method] => 
    [order_date] => 2025-09-30 06:07:16
    [item_count] => 0
)

[2025-09-30 06:07:16] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => 
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-09-30 06:07:16] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-30 06:07:16] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-09-30 06:07:16] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 06:07:16] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 0
    [order_id] => 87960
)

[2025-09-30 06:07:16] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-30 06:07:16] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87960
    [final_memory_usage] => 130MB
)

[2025-09-30 06:07:16] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 06:07:16] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87960
    [product_id] => 67487
)

[2025-09-30 06:07:17] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 06:07:17] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87960
    [timestamp] => 2025-09-30 06:07:17
    [memory_usage] => 132MB
)

[2025-09-30 06:07:17] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87960
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 0
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-09-30 06:07:16
    [item_count] => 1
)

[2025-09-30 06:07:17] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-09-30 06:07:17] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-30 06:07:17] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-09-30 06:07:17] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 06:07:17] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 0
    [order_id] => 87960
)

[2025-09-30 06:07:17] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-09-30 06:07:17] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-09-30 06:07:17] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-09-30 06:07:17] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 0
    [order_id] => 87960
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-09-30 06:07:17] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-09-30 06:07:17] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 0
    [order_id] => 87960
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-09-30 06:07:17
)

[2025-09-30 06:07:17] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-09-30 06:07:17] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-09-30 06:07:17] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-09-30 06:07:17] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-09-30 06:07:17] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-09-30 06:07:17] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-09-30 06:07:17] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-09-30 06:07:17] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 0
    [old_role] => customer
    [new_role] => ui_member
)

[2025-09-30 06:07:17] [debug] âŒ Helper: User not found for role change 0
[2025-09-30 06:07:17] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 0
[2025-09-30 06:07:17] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-09-30 06:07:17] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-09-30 06:07:17] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-09-30 06:07:17] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => 
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759226836
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87960
    [user_id] => 0
)

[2025-09-30 06:07:17] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-09-30 06:07:17] [debug] MembershipOrderHandler: User data updated 0
[2025-09-30 06:07:17] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-09-30 06:07:17] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 0
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87960
)

[2025-09-30 06:07:17] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-09-30 06:07:17] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-09-30 06:07:17] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => 
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759226836
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87960
    [user_id] => 0
)

[2025-09-30 06:07:17] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 0
    [success] => Registration call completed
)

[2025-09-30 06:07:17] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 0
    [lgl_api_called] => YES
)

[2025-09-30 06:07:17] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-09-30 06:07:17] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87960
    [user_id] => 0
    [final_membership_level] => Individual Membership
)

[2025-09-30 06:07:17] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-09-30 06:07:17] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-30 06:07:17] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87960
    [final_memory_usage] => 132MB
)

[2025-09-30 06:07:18] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:07:37] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:07:57] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:08:39] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:08:40] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:08:41] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:09:09] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:09:38] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:09:58] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:10:40] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:10:41] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:11:09] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:11:09] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87961
    [timestamp] => 2025-09-30 06:11:09
    [memory_usage] => 120MB
)

[2025-09-30 06:11:09] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87961
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 0
    [customer_email] => 
    [payment_method] => 
    [order_date] => 2025-09-30 06:11:09
    [item_count] => 0
)

[2025-09-30 06:11:09] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => 
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-09-30 06:11:09] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-30 06:11:09] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-09-30 06:11:09] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 06:11:09] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 0
    [order_id] => 87961
)

[2025-09-30 06:11:09] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-30 06:11:09] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87961
    [final_memory_usage] => 120MB
)

[2025-09-30 06:11:09] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 06:11:09] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87961
    [product_id] => 67487
)

[2025-09-30 06:11:09] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 06:11:09] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87961
    [timestamp] => 2025-09-30 06:11:09
    [memory_usage] => 124MB
)

[2025-09-30 06:11:09] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87961
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 0
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-09-30 06:11:09
    [item_count] => 1
)

[2025-09-30 06:11:09] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 0
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-09-30 06:11:09] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 0
    [payment_method] => 
    [stored_as] => 
)

[2025-09-30 06:11:09] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-09-30 06:11:09] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 06:11:09] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 0
    [order_id] => 87961
)

[2025-09-30 06:11:09] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-09-30 06:11:09] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-09-30 06:11:09] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-09-30 06:11:09] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 0
    [order_id] => 87961
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-09-30 06:11:09] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-09-30 06:11:09] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 0
    [order_id] => 87961
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-09-30 06:11:09
)

[2025-09-30 06:11:09] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-09-30 06:11:09] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-09-30 06:11:09] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-09-30 06:11:09] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-09-30 06:11:09] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-09-30 06:11:09] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-09-30 06:11:09] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-09-30 06:11:09] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 0
    [old_role] => customer
    [new_role] => ui_member
)

[2025-09-30 06:11:09] [debug] âŒ Helper: User not found for role change 0
[2025-09-30 06:11:09] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 0
[2025-09-30 06:11:09] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-09-30 06:11:09] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-09-30 06:11:09] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-09-30 06:11:09] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => 
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759227069
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87961
    [user_id] => 0
)

[2025-09-30 06:11:09] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-09-30 06:11:09] [debug] MembershipOrderHandler: User data updated 0
[2025-09-30 06:11:09] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-09-30 06:11:09] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 0
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87961
)

[2025-09-30 06:11:09] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-09-30 06:11:09] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-09-30 06:11:09] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => 
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759227069
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87961
    [user_id] => 0
)

[2025-09-30 06:11:09] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 0
    [success] => Registration call completed
)

[2025-09-30 06:11:09] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 0
    [lgl_api_called] => YES
)

[2025-09-30 06:11:09] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-09-30 06:11:09] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87961
    [user_id] => 0
    [final_membership_level] => Individual Membership
)

[2025-09-30 06:11:09] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-09-30 06:11:09] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-30 06:11:09] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87961
    [final_memory_usage] => 124MB
)

[2025-09-30 06:11:10] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:11:10] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:11:11] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:11:17] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:11:39] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:11:59] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:14:44] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:14:45] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87962
    [timestamp] => 2025-09-30 06:14:45
    [memory_usage] => 116MB
)

[2025-09-30 06:14:45] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87962
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-09-30 06:14:45
    [item_count] => 0
)

[2025-09-30 06:14:45] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-09-30 06:14:45] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-09-30 06:14:45] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-09-30 06:14:45] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 06:14:45] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1862
    [order_id] => 87962
)

[2025-09-30 06:14:45] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-30 06:14:45] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87962
    [final_memory_usage] => 116MB
)

[2025-09-30 06:14:45] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 06:14:45] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87962
    [product_id] => 67487
)

[2025-09-30 06:14:45] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 06:14:45] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87962
    [timestamp] => 2025-09-30 06:14:45
    [memory_usage] => 120MB
)

[2025-09-30 06:14:45] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87962
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-09-30 06:14:45
    [item_count] => 1
)

[2025-09-30 06:14:45] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-09-30 06:14:45] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-09-30 06:14:45] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-09-30 06:14:45] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 06:14:45] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1862
    [order_id] => 87962
)

[2025-09-30 06:14:45] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-09-30 06:14:45] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-09-30 06:14:45] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-09-30 06:14:45] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87962
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-09-30 06:14:45] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-09-30 06:14:45] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87962
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-09-30 06:14:45
)

[2025-09-30 06:14:45] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-09-30 06:14:45] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-09-30 06:14:45] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-09-30 06:14:45] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-09-30 06:14:45] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-09-30 06:14:45] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-09-30 06:14:45] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-09-30 06:14:45] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1862
    [old_role] => customer
    [new_role] => ui_member
)

[2025-09-30 06:14:45] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1862
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-09-30 06:14:45] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1862
[2025-09-30 06:14:45] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-09-30 06:14:45] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-09-30 06:14:45] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-09-30 06:14:45] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759227285
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87962
    [user_id] => 1862
)

[2025-09-30 06:14:45] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-09-30 06:14:46] [debug] MembershipOrderHandler: User data updated 1862
[2025-09-30 06:14:46] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-09-30 06:14:46] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87962
)

[2025-09-30 06:14:46] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-09-30 06:14:46] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-09-30 06:14:46] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759227285
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87962
    [user_id] => 1862
)

[2025-09-30 06:14:46] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-09-30 06:14:46
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-09-30 06:14:46] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87962
)

[2025-09-30 06:14:46] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1862
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-09-30 06:14:46] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-09-30 06:14:46] [debug] Payment method set:  online
[2025-09-30 06:14:46] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-09-30 06:14:46] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-09-30 06:14:46] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:18:01] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:18:01] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87963
    [timestamp] => 2025-09-30 06:18:01
    [memory_usage] => 116MB
)

[2025-09-30 06:18:01] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87963
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-09-30 06:18:01
    [item_count] => 0
)

[2025-09-30 06:18:01] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-09-30 06:18:01] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-09-30 06:18:01] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-09-30 06:18:01] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 06:18:01] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1862
    [order_id] => 87963
)

[2025-09-30 06:18:01] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-09-30 06:18:01] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87963
    [final_memory_usage] => 116MB
)

[2025-09-30 06:18:01] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 06:18:01] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87963
    [product_id] => 67487
)

[2025-09-30 06:18:01] [debug] OrderEmailCustomizer: Running email customizer
[2025-09-30 06:18:01] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87963
    [timestamp] => 2025-09-30 06:18:01
    [memory_usage] => 120MB
)

[2025-09-30 06:18:01] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87963
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-09-30 06:18:01
    [item_count] => 1
)

[2025-09-30 06:18:01] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-09-30 06:18:01] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-09-30 06:18:01] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-09-30 06:18:01] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-09-30 06:18:01] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1862
    [order_id] => 87963
)

[2025-09-30 06:18:01] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-09-30 06:18:01] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-09-30 06:18:01] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-09-30 06:18:01] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87963
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-09-30 06:18:01] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-09-30 06:18:01] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87963
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-09-30 06:18:01
)

[2025-09-30 06:18:01] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-09-30 06:18:01] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-09-30 06:18:01] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-09-30 06:18:01] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-09-30 06:18:01] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-09-30 06:18:01] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-09-30 06:18:01] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-09-30 06:18:01] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1862
    [old_role] => customer
    [new_role] => ui_member
)

[2025-09-30 06:18:01] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1862
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-09-30 06:18:01] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1862
[2025-09-30 06:18:01] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-09-30 06:18:01] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-09-30 06:18:01] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-09-30 06:18:01] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759227481
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87963
    [user_id] => 1862
)

[2025-09-30 06:18:01] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-09-30 06:18:01] [debug] MembershipOrderHandler: User data updated 1862
[2025-09-30 06:18:01] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-09-30 06:18:01] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87963
)

[2025-09-30 06:18:01] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-09-30 06:18:01] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-09-30 06:18:01] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759227481
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87963
    [user_id] => 1862
)

[2025-09-30 06:18:01] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-09-30 06:18:01
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-09-30 06:18:01] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87963
)

[2025-09-30 06:18:01] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1862
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-09-30 06:18:01] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-09-30 06:18:01] [debug] Payment method set:  online
[2025-09-30 06:18:01] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-09-30 06:18:01] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-09-30 06:18:02] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-09-30 06:18:02] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-09-30 06:18:02] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:18:04] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:18:04] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:18:12] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:18:12] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:19:13] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:20:17] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:21:17] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:22:17] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:23:17] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:30:09] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:30:11] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:30:18] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:30:23] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:30:24] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:30:24] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:30:32] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:30:32] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:30:32] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:31:01] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:31:02] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:31:02] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:31:05] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:31:20] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:31:21] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:31:21] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:31:31] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:31:31] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:31:31] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:32:32] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:33:32] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:35:07] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:35:09] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:35:09] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:35:09] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:35:18] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:35:18] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:35:18] [debug] Membership cron jobs scheduled successfully
[2025-09-30 06:36:19] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:37:19] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:38:31] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:38:44] [debug] SettingsManager: Initialized successfully
[2025-09-30 06:38:44] [debug] SettingsManager: Initialized successfully
[2025-09-30 07:02:01] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:02:01] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:02:03] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:02:03] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:02:29] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:02:29] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:02:31] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:02:31] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:04:20] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:04:20] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:04:24] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:04:24] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:05:15] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:05:15] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:05:28] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:05:28] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:05:31] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:05:31] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:21:55] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:21:55] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:24:00] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:24:00] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:24:02] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:24:02] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:26:17] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:26:17] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:26:20] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:26:20] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:31:19] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:31:19] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:33:27] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:33:27] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:33:32] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:33:32] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:39:00] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:39:00] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:39:20] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:39:20] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:41:10] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:41:13] [debug] Membership cron jobs scheduled successfully
[2025-09-30 07:41:13] [debug] Membership cron jobs scheduled successfully
[2025-10-05 21:18:46] [debug] Membership cron jobs scheduled successfully
[2025-10-05 21:18:48] [debug] Membership cron jobs scheduled successfully
[2025-10-05 21:18:50] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:15:28] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:15:29] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:15:29] [debug] Starting monthly membership cleanup tasks
[2025-10-06 07:15:29] [debug] Old membership transients cleaned up
[2025-10-06 07:15:29] [debug] Old membership logs cleaned up
[2025-10-06 07:15:29] [debug] User meta cleanup completed
[2025-10-06 07:15:29] [debug] Monthly cleanup tasks completed
[2025-10-06 07:15:29] [debug] Starting daily membership renewal check
[2025-10-06 07:15:29] [debug] Starting membership renewal processing
[2025-10-06 07:15:29] [debug] User 794: -402 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1118 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 795 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1853 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1119: -528 days until renewal
[2025-10-06 07:15:29] [debug] User 796: -255 days until renewal
[2025-10-06 07:15:29] [debug] User 1120: -476 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1559 - not in-person membership
[2025-10-06 07:15:29] [debug] User 797: -312 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1713 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1121: 355831 days until renewal
[2025-10-06 07:15:29] [debug] User 798: -394 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1787 - not in-person membership
[2025-10-06 07:15:29] [debug] User 799: -510 days until renewal
[2025-10-06 07:15:29] [debug] User 1122: -223 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1679 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1545 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1364 - not in-person membership
[2025-10-06 07:15:29] [debug] User 801: -310 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1335 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1642 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1432 - not in-person membership
[2025-10-06 07:15:29] [debug] User 802: -457 days until renewal
[2025-10-06 07:15:29] [debug] User 803: -263 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 804 - not in-person membership
[2025-10-06 07:15:29] [debug] User 805: -578 days until renewal
[2025-10-06 07:15:29] [debug] User 806: -440 days until renewal
[2025-10-06 07:15:29] [debug] User 807: -227 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1357 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1299 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1608 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1560 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1402 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1091: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1780 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1123 - not in-person membership
[2025-10-06 07:15:29] [debug] User 808: 355831 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1384 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1806 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1662 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1783 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1233: -171 days until renewal
[2025-10-06 07:15:29] [debug] User 809: 355831 days until renewal
[2025-10-06 07:15:29] [debug] User 810: -297 days until renewal
[2025-10-06 07:15:29] [debug] User 811: -417 days until renewal
[2025-10-06 07:15:29] [debug] User 812: -234 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1727 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1567 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1724 - not in-person membership
[2025-10-06 07:15:29] [debug] User 813: -269 days until renewal
[2025-10-06 07:15:29] [debug] User 814: 355831 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1599 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1729 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1230 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1309 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1248 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 815 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1268 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1124: -275 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1232 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1753 - not in-person membership
[2025-10-06 07:15:29] [debug] User 816: -339 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1362 - not in-person membership
[2025-10-06 07:15:29] [debug] User 817: -293 days until renewal
[2025-10-06 07:15:29] [debug] User 1092: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1804 - not in-person membership
[2025-10-06 07:15:29] [debug] User 818: -374 days until renewal
[2025-10-06 07:15:29] [debug] User 1125: -296 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 819 - not in-person membership
[2025-10-06 07:15:29] [debug] User 820: -439 days until renewal
[2025-10-06 07:15:29] [debug] User 821: -248 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1416 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1606 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1126: -381 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1412 - not in-person membership
[2025-10-06 07:15:29] [debug] User 822: 355831 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1658 - not in-person membership
[2025-10-06 07:15:29] [debug] User 823: -281 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 824 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1127: -534 days until renewal
[2025-10-06 07:15:29] [debug] User 825: -273 days until renewal
[2025-10-06 07:15:29] [debug] User 826: 91 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1631 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1128: -292 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1394 - not in-person membership
[2025-10-06 07:15:29] [debug] User 827: -227 days until renewal
[2025-10-06 07:15:29] [debug] User 1129: -570 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1615 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1613 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1290 - not in-person membership
[2025-10-06 07:15:29] [debug] User 828: -354 days until renewal
[2025-10-06 07:15:29] [debug] User 829: -454 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1820 - not in-person membership
[2025-10-06 07:15:29] [debug] User 830: -259 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1404 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1618 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1093: -257 days until renewal
[2025-10-06 07:15:29] [debug] User 831: -586 days until renewal
[2025-10-06 07:15:29] [debug] User 832: -321 days until renewal
[2025-10-06 07:15:29] [debug] User 1130: -494 days until renewal
[2025-10-06 07:15:29] [debug] User 833: -527 days until renewal
[2025-10-06 07:15:29] [debug] User 834: -408 days until renewal
[2025-10-06 07:15:29] [debug] User 835: -385 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1803 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1298 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 836 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1815 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1480 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 837 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1433 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1277 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1816 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1800 - not in-person membership
[2025-10-06 07:15:29] [debug] User 838: 141 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1851 - not in-person membership
[2025-10-06 07:15:29] [debug] User 839: -403 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1682 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1779 - not in-person membership
[2025-10-06 07:15:29] [debug] User 840: -295 days until renewal
[2025-10-06 07:15:29] [debug] User 1094: -502 days until renewal
[2025-10-06 07:15:29] [debug] User 1131: -415 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1546 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1329 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1132 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1095: 99 days until renewal
[2025-10-06 07:15:29] [debug] User 841: -279 days until renewal
[2025-10-06 07:15:29] [debug] User 1087: 355831 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1730 - not in-person membership
[2025-10-06 07:15:29] [debug] User 842: -410 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1312 - not in-person membership
[2025-10-06 07:15:29] [debug] User 843: -248 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1096 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1417 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1625 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1376 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1822 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1771 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1594 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1764 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1478 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1133 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1502 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1784 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1414 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1735 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1097: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 844 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1134: -562 days until renewal
[2025-10-06 07:15:29] [debug] User 845: -241 days until renewal
[2025-10-06 07:15:29] [debug] User 846: -227 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1266 - not in-person membership
[2025-10-06 07:15:29] [debug] User 847: -410 days until renewal
[2025-10-06 07:15:29] [debug] User 1135: -517 days until renewal
[2025-10-06 07:15:29] [debug] User 848: -286 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1652 - not in-person membership
[2025-10-06 07:15:29] [debug] User 849: -428 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1296 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1427 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1257 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1430 - not in-person membership
[2025-10-06 07:15:29] [debug] User 850: -266 days until renewal
[2025-10-06 07:15:29] [debug] User 851: -267 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1634 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1641 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1136: -496 days until renewal
[2025-10-06 07:15:29] [debug] User 1137: -571 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1138 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1368 - not in-person membership
[2025-10-06 07:15:29] [debug] User 852: -515 days until renewal
[2025-10-06 07:15:29] [debug] User 853: -525 days until renewal
[2025-10-06 07:15:29] [debug] User 854: -256 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1825 - not in-person membership
[2025-10-06 07:15:29] [debug] User 855: -410 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1540 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1508 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1805 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1428 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1782 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 856 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 857 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1273 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1616 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1760 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1140 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 858 - not in-person membership
[2025-10-06 07:15:29] [debug] User 859: -521 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1344 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1667 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1141: -295 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 860 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1858 - not in-person membership
[2025-10-06 07:15:29] [debug] User 861: -260 days until renewal
[2025-10-06 07:15:29] [debug] User 1142: -569 days until renewal
[2025-10-06 07:15:29] [debug] User 862: -526 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1854 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 863 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1143: -465 days until renewal
[2025-10-06 07:15:29] [debug] User 864: -241 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 865 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 866 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1144: -558 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1280 - not in-person membership
[2025-10-06 07:15:29] [debug] User 867: -520 days until renewal
[2025-10-06 07:15:29] [debug] User 1145: -420 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1601 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1398 - not in-person membership
[2025-10-06 07:15:29] [debug] User 868: -264 days until renewal
[2025-10-06 07:15:29] [debug] User 869: -414 days until renewal
[2025-10-06 07:15:29] [debug] User 870: -425 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1245 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1513 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1630 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1736 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1146 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1147: -269 days until renewal
[2025-10-06 07:15:29] [debug] User 871: -274 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1341 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1812 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1098: 107 days until renewal
[2025-10-06 07:15:29] [debug] User 1099: -257 days until renewal
[2025-10-06 07:15:29] [debug] User 872: -409 days until renewal
[2025-10-06 07:15:29] [debug] User 873: -262 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1744 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1702 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1088: -500 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1288 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1148 - not in-person membership
[2025-10-06 07:15:29] [debug] User 874: -273 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 875 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1715 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1824 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1714 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1149: -220 days until renewal
[2025-10-06 07:15:29] [debug] User 876: -404 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1443 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1525 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1655 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 877 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1150: -283 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1777 - not in-person membership
[2025-10-06 07:15:29] [debug] User 878: -395 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 879 - not in-person membership
[2025-10-06 07:15:29] [debug] User 880: -270 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1550 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1354 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1378 - not in-person membership
[2025-10-06 07:15:29] [debug] User 881: -457 days until renewal
[2025-10-06 07:15:29] [debug] User 882: -514 days until renewal
[2025-10-06 07:15:29] [debug] User 883: 155 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1632 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1221 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 884 - not in-person membership
[2025-10-06 07:15:29] [debug] User 885: -333 days until renewal
[2025-10-06 07:15:29] [debug] User 886: -516 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1619 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1786 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1291 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1152: -391 days until renewal
[2025-10-06 07:15:29] [debug] User 887: -279 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1775 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1790 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1620 - not in-person membership
[2025-10-06 07:15:29] [debug] User 888: -569 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1742 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1153 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 889 - not in-person membership
[2025-10-06 07:15:29] [debug] User 890: -403 days until renewal
[2025-10-06 07:15:29] [debug] User 1154: -418 days until renewal
[2025-10-06 07:15:29] [debug] User 891: -531 days until renewal
[2025-10-06 07:15:29] [debug] User 892: -304 days until renewal
[2025-10-06 07:15:29] [debug] User 1155: -520 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1156 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1157: -509 days until renewal
[2025-10-06 07:15:29] [debug] User 893: -494 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1287 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1338 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1158: -502 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1551 - not in-person membership
[2025-10-06 07:15:29] [debug] User 894: -582 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1509 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1664 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 895 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1811 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1251 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1718 - not in-person membership
[2025-10-06 07:15:29] [debug] User 896: -544 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1481 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1549 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1159: -220 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1571 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1748 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1304 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1317 - not in-person membership
[2025-10-06 07:15:29] [debug] User 897: 355831 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1603 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1564 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1302 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 898 - not in-person membership
[2025-10-06 07:15:29] [debug] User 899: -266 days until renewal
[2025-10-06 07:15:29] [debug] User 900: -570 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1554 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1386 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 901 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1465 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1855 - not in-person membership
[2025-10-06 07:15:29] [debug] User 902: -464 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1316 - not in-person membership
[2025-10-06 07:15:29] [debug] User 903: -508 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1666 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1431 - not in-person membership
[2025-10-06 07:15:29] [debug] User 904: -277 days until renewal
[2025-10-06 07:15:29] [debug] User 1160: -251 days until renewal
[2025-10-06 07:15:29] [debug] User 905: -256 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1355 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1605 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1810 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1289 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 906 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 907 - not in-person membership
[2025-10-06 07:15:29] [debug] User 908: -393 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1239 - not in-person membership
[2025-10-06 07:15:29] [debug] User 909: -522 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 910 - not in-person membership
[2025-10-06 07:15:29] [debug] User 911: -304 days until renewal
[2025-10-06 07:15:29] [debug] User 912: -568 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1425 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1759 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 913 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1161 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1100: 100 days until renewal
[2025-10-06 07:15:29] [debug] User 1101: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1381 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1089: 355831 days until renewal
[2025-10-06 07:15:29] [debug] User 1162: -274 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1469 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1860 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1552 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1315 - not in-person membership
[2025-10-06 07:15:29] [debug] User 914: -444 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1426 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1406 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1595 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1665 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1676 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1597 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1624 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1405 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1336 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1795 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 915 - not in-person membership
[2025-10-06 07:15:29] [debug] User 916: -249 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1773 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 917 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 918 - not in-person membership
[2025-10-06 07:15:29] [debug] User 919: -527 days until renewal
[2025-10-06 07:15:29] [debug] User 920: -411 days until renewal
[2025-10-06 07:15:29] [debug] User 921: -409 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1798 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1423 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1638 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1675 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1163: -468 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1848 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1563 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1409 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1250 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1339 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1797 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1267 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1796 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1670 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1382 - not in-person membership
[2025-10-06 07:15:29] [debug] User 922: -283 days until renewal
[2025-10-06 07:15:29] [debug] User 1103: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1447 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1235 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 923 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1264 - not in-person membership
[2025-10-06 07:15:29] [debug] User 924: -582 days until renewal
[2025-10-06 07:15:29] [debug] User 925: -287 days until renewal
[2025-10-06 07:15:29] [debug] User 1164: -471 days until renewal
[2025-10-06 07:15:29] [debug] User 926: -441 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1589 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1534 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1609 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1556 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1285 - not in-person membership
[2025-10-06 07:15:29] [debug] User 927: -282 days until renewal
[2025-10-06 07:15:29] [debug] User 928: -276 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1345 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1750 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1612 - not in-person membership
[2025-10-06 07:15:29] [debug] User 929: -273 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1165 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1817 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1770 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 930 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1166: -276 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1400 - not in-person membership
[2025-10-06 07:15:29] [debug] User 931: 99 days until renewal
[2025-10-06 07:15:29] [debug] User 932: 355831 days until renewal
[2025-10-06 07:15:29] [debug] User 1167: -401 days until renewal
[2025-10-06 07:15:29] [debug] User 933: -267 days until renewal
[2025-10-06 07:15:29] [debug] User 934: -503 days until renewal
[2025-10-06 07:15:29] [debug] User 935: -392 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1819 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1761 - not in-person membership
[2025-10-06 07:15:29] [debug] User 936: -328 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1265 - not in-person membership
[2025-10-06 07:15:29] [debug] User 937: -584 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 938 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1308 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1168: -416 days until renewal
[2025-10-06 07:15:29] [debug] User 939: -253 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1169 - not in-person membership
[2025-10-06 07:15:29] [debug] User 940: 355831 days until renewal
[2025-10-06 07:15:29] [debug] User 1170: -583 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 941 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1633 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1222 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1390 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1611 - not in-person membership
[2025-10-06 07:15:29] [debug] User 942: -448 days until renewal
[2025-10-06 07:15:29] [debug] User 943: -290 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 944 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1366 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1231 - not in-person membership
[2025-10-06 07:15:29] [debug] User 945: -413 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1387 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1411 - not in-person membership
[2025-10-06 07:15:29] [debug] User 946: -418 days until renewal
[2025-10-06 07:15:29] [debug] User 1104: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 947 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1766 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 948 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1557 - not in-person membership
[2025-10-06 07:15:29] [debug] User 949: -402 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1644 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1333 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1225 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1627 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1808 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1754 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1849 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1234 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 950 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1793 - not in-person membership
[2025-10-06 07:15:29] [debug] User 951: -396 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1172 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1450 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1562 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1622 - not in-person membership
[2025-10-06 07:15:29] [debug] User 952: -529 days until renewal
[2025-10-06 07:15:29] [debug] User 953: 355831 days until renewal
[2025-10-06 07:15:29] [debug] User 954: -408 days until renewal
[2025-10-06 07:15:29] [debug] User 955: -329 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1838 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1173 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1772 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1569 - not in-person membership
[2025-10-06 07:15:29] [debug] User 957: -499 days until renewal
[2025-10-06 07:15:29] [debug] User 958: -227 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1530 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1342 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 959 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1801 - not in-person membership
[2025-10-06 07:15:29] [debug] User 960: -403 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1399 - not in-person membership
[2025-10-06 07:15:29] [debug] User 961: -247 days until renewal
[2025-10-06 07:15:29] [debug] User 962: -267 days until renewal
[2025-10-06 07:15:29] [debug] User 963: -380 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1419 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1445 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1359 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1371 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1774 - not in-person membership
[2025-10-06 07:15:29] [debug] User 965: -249 days until renewal
[2025-10-06 07:15:29] [debug] User 966: -268 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1617 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1794 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1353 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1174: -420 days until renewal
[2025-10-06 07:15:29] [debug] User 967: 116 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1710 - not in-person membership
[2025-10-06 07:15:29] [debug] User 968: -393 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1756 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1175: -289 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1176 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1482 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1555 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 969 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1436 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1799 - not in-person membership
[2025-10-06 07:15:29] [debug] User 970: -426 days until renewal
[2025-10-06 07:15:29] [debug] User 971: -492 days until renewal
[2025-10-06 07:15:29] [debug] User 972: 355831 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1177 - not in-person membership
[2025-10-06 07:15:29] [debug] User 973: -502 days until renewal
[2025-10-06 07:15:29] [debug] User 1105: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1852 - not in-person membership
[2025-10-06 07:15:29] [debug] User 974: -471 days until renewal
[2025-10-06 07:15:29] [debug] User 975: -273 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1458 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1526 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1614 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1424 - not in-person membership
[2025-10-06 07:15:29] [debug] User 976: -259 days until renewal
[2025-10-06 07:15:29] [debug] User 977: -380 days until renewal
[2025-10-06 07:15:29] [debug] User 1178: -577 days until renewal
[2025-10-06 07:15:29] [debug] User 978: -384 days until renewal
[2025-10-06 07:15:29] [debug] User 979: -381 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 980 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1218: -208 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1327 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1659 - not in-person membership
[2025-10-06 07:15:29] [debug] User 981: -544 days until renewal
[2025-10-06 07:15:29] [debug] User 1106: -257 days until renewal
[2025-10-06 07:15:29] [debug] User 982: -416 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1769 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1732 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1179 - not in-person membership
[2025-10-06 07:15:29] [debug] User 983: -410 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1300 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 984 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1636 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1635 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1721 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1536 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1180: -425 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1228 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1181: -227 days until renewal
[2025-10-06 07:15:29] [debug] User 985: -250 days until renewal
[2025-10-06 07:15:29] [debug] User 1182: -523 days until renewal
[2025-10-06 07:15:29] [debug] User 986: -274 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1444 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 987 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1660 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1639 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1763 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 988 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1107: 86 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1183 - not in-person membership
[2025-10-06 07:15:29] [debug] User 989: -522 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1184 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1216: -213 days until renewal
[2025-10-06 07:15:29] [debug] User 990: -427 days until renewal
[2025-10-06 07:15:29] [debug] User 991: -269 days until renewal
[2025-10-06 07:15:29] [debug] User 992: -508 days until renewal
[2025-10-06 07:15:29] [debug] User 993: -515 days until renewal
[2025-10-06 07:15:29] [debug] User 994: -507 days until renewal
[2025-10-06 07:15:29] [debug] User 995: -518 days until renewal
[2025-10-06 07:15:29] [debug] User 996: -584 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1446 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1643 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 997 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1224 - not in-person membership
[2025-10-06 07:15:29] [debug] User 998: -500 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1607 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1584 - not in-person membership
[2025-10-06 07:15:29] [debug] User 999: -380 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1826 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1185: -535 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1186 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1649 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1000: -578 days until renewal
[2025-10-06 07:15:29] [debug] User 1187: -409 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1441 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1001: -241 days until renewal
[2025-10-06 07:15:29] [debug] User 1002: -471 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1188 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1003: -562 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1696 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1722 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1005: -291 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1752 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1006: -567 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1593 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1389 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1007: -430 days until renewal
[2025-10-06 07:15:29] [debug] User 1008: -503 days until renewal
[2025-10-06 07:15:29] [debug] User 1189: -507 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1190 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1009: -383 days until renewal
[2025-10-06 07:15:29] [debug] User 1010: -269 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1435 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1765 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1108: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1637 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1191 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1807 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1109: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1420 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1242 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1192: -435 days until renewal
[2025-10-06 07:15:29] [debug] User 1011: -444 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1012 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1193: -517 days until renewal
[2025-10-06 07:15:29] [debug] User 1013: -329 days until renewal
[2025-10-06 07:15:29] [debug] User 1194: -235 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1195 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1196 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1197: -516 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1198 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1629 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1454 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1014: 355831 days until renewal
[2025-10-06 07:15:29] [debug] User 1199: -411 days until renewal
[2025-10-06 07:15:29] [debug] User 1200: -293 days until renewal
[2025-10-06 07:15:29] [debug] User 1015: -570 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1016 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1747 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1401 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1017: -473 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1610 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1493 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1018 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1523 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1110 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1019: 28 days until renewal
[2025-10-06 07:15:29] [debug] User 1111: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1020 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1254 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1021: -248 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1022 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1262 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1023: -269 days until renewal
[2025-10-06 07:15:29] [debug] User 1201: -299 days until renewal
[2025-10-06 07:15:29] [debug] User 1202: -42 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1751 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1203: -423 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1024 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1025: -365 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1592 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1857 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1442 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1026 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1027: -587 days until renewal
[2025-10-06 07:15:29] [debug] User 1028: -359 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1029 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1030 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1717 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1581 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1031: -563 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1565 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1578 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1654 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1476 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1572 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1346 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1363 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1204: -315 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1223 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1032: -416 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1033 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1034: -377 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1577 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1035 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1205: -462 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1818 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1036: -274 days until renewal
[2025-10-06 07:15:29] [debug] User 1037: -521 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1292 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1038: -507 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1039 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1437 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1579 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1253 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1464 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1283 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1206: -573 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1040 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1112 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1259 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1042: -229 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1275 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1260 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1043: -512 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1241 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1044: -272 days until renewal
[2025-10-06 07:15:29] [debug] User 1045: -548 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1621 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1591 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1046 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1047: -502 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1048 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1657 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1788 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1537 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1049: -578 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1440 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1661 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1383 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1313 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1050: -347 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1548 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1542 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1410 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1361 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1749 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1237 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1051: -533 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1306 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1052: -411 days until renewal
[2025-10-06 07:15:29] [debug] User 1053: -411 days until renewal
[2025-10-06 07:15:29] [debug] User 1217: -209 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1623 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1582 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1054: -220 days until renewal
[2025-10-06 07:15:29] [debug] User 1055: -566 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1575 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1473 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1056: -401 days until renewal
[2025-10-06 07:15:29] [debug] User 1057: -240 days until renewal
[2025-10-06 07:15:29] [debug] User 1058: -424 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1789 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1365 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1059: -421 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1060 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1061: -402 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1429 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1653 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1439 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1278 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1678 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1561 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1062: 355831 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1755 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1063: -563 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1113 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1064: -503 days until renewal
[2025-10-06 07:15:29] [debug] User 1065: -274 days until renewal
[2025-10-06 07:15:29] [debug] User 1219: -207 days until renewal
[2025-10-06 07:15:29] [debug] User 1066: -577 days until renewal
[2025-10-06 07:15:29] [debug] User 1114: -257 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 359 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1535 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1574 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1802 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1115 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1207 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1293 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1067: -561 days until renewal
[2025-10-06 07:15:29] [debug] User 1068: -401 days until renewal
[2025-10-06 07:15:29] [debug] User 1208: -400 days until renewal
[2025-10-06 07:15:29] [debug] User 1069: 108 days until renewal
[2025-10-06 07:15:29] [debug] User 1116: 107 days until renewal
[2025-10-06 07:15:29] [debug] User 1070: -343 days until renewal
[2025-10-06 07:15:29] [debug] User 1071: -297 days until renewal
[2025-10-06 07:15:29] [debug] User 1072: -528 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1073 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1781 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1553 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1074: -406 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1408 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1418 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1768 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1210: -248 days until renewal
[2025-10-06 07:15:29] [debug] User 1075: -577 days until renewal
[2025-10-06 07:15:29] [debug] User 1076: 355831 days until renewal
[2025-10-06 07:15:29] [debug] User 1077: -414 days until renewal
[2025-10-06 07:15:29] [debug] User 1211: -321 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1090 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1078: -282 days until renewal
[2025-10-06 07:15:29] [debug] User 1079: -402 days until renewal
[2025-10-06 07:15:29] [debug] User 1212: -276 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1726 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1809 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1080 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1081 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1082: -269 days until renewal
[2025-10-06 07:15:29] [debug] User 1213: -575 days until renewal
[2025-10-06 07:15:29] [debug] User 1083: -563 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1856 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1085: -532 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1261 - not in-person membership
[2025-10-06 07:15:29] [debug] Skipping user 1741 - not in-person membership
[2025-10-06 07:15:29] [debug] User 1086: -507 days until renewal
[2025-10-06 07:15:29] [debug] Skipping user 1276 - not in-person membership
[2025-10-06 07:15:29] [debug] Membership renewal processing completed Array
(
    [processed] => 778
    [notified] => 0
    [deactivated] => 0
    [skipped] => 778
    [errors] => Array
        (
        )

)

[2025-10-06 07:15:29] [debug] Daily membership check completed Array
(
    [execution_time_ms] => 206.99
    [results] => Array
        (
            [processed] => 778
            [notified] => 0
            [deactivated] => 0
            [skipped] => 778
            [errors] => Array
                (
                )

        )

)

[2025-10-06 07:15:31] [debug] Starting weekly membership statistics update
[2025-10-06 07:15:31] [debug] Weekly statistics updated Array
(
    [total_members] => 778
    [due_soon] => 20
    [overdue] => 15
    [expired] => 396
    [current] => 347
)

[2025-10-06 07:16:41] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:16:41] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:16:43] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:16:49] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:16:49] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:16:50] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:20:33] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:20:33] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:20:34] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:20:44] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:20:45] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:20:53] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:21:04] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:21:06] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:22:27] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:22:27] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:22:27] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:26:29] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:26:39] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:49:39] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:49:49] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:50:06] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:50:11] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:51:12] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:51:13] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:51:16] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:51:18] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:52:41] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:52:43] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:53:23] [debug] This is a test debug message from the admin interface
[2025-10-06 07:53:56] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:53:57] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:54:08] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:54:13] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:54:23] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:54:24] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:54:24] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:54:24] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:54:25] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:54:25] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:54:25] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:56:20] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:56:20] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 07:56:20] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87972
    [timestamp] => 2025-10-06 07:56:20
    [memory_usage] => 118MB
)

[2025-10-06 07:56:20] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87972
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 07:56:20
    [item_count] => 0
)

[2025-10-06 07:56:20] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 07:56:20] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 07:56:20] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 07:56:20] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 07:56:20] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1862
    [order_id] => 87972
)

[2025-10-06 07:56:20] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 07:56:20] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87972
    [final_memory_usage] => 118MB
)

[2025-10-06 07:56:20] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 07:56:20] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87972
    [product_id] => 67487
)

[2025-10-06 07:56:20] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 07:56:20] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87972
    [timestamp] => 2025-10-06 07:56:20
    [memory_usage] => 122MB
)

[2025-10-06 07:56:20] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87972
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 07:56:20
    [item_count] => 1
)

[2025-10-06 07:56:20] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 07:56:20] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 07:56:20] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 07:56:20] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 07:56:20] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1862
    [order_id] => 87972
)

[2025-10-06 07:56:20] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 07:56:20] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 07:56:20] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 07:56:20] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87972
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 07:56:20] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 07:56:20] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87972
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 07:56:20
)

[2025-10-06 07:56:20] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 07:56:20] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 07:56:20] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 07:56:20] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 07:56:20] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 07:56:20] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 07:56:20] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 07:56:20] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1862
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 07:56:20] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1862
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 07:56:20] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1862
[2025-10-06 07:56:20] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 07:56:20] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 07:56:20] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 07:56:20] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759751780
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87972
    [user_id] => 1862
)

[2025-10-06 07:56:20] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 07:56:20] [debug] MembershipOrderHandler: User data updated 1862
[2025-10-06 07:56:20] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 07:56:20] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87972
)

[2025-10-06 07:56:20] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 07:56:20] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 07:56:20] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759751780
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87972
    [user_id] => 1862
)

[2025-10-06 07:56:20] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 07:56:20
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 07:56:20] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87972
)

[2025-10-06 07:56:20] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1862
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 07:56:20] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 07:56:20] [debug] Payment method set:  online
[2025-10-06 07:56:20] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 07:56:20] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 07:56:21] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 07:56:21] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 07:56:45] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:56:45] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 07:58:18] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:58:19] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 07:58:41] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:58:41] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 07:58:57] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 07:58:57] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:58:58] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 07:58:59] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:59:09] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 07:59:11] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 07:59:14] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:59:14] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:59:14] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:59:19] [debug] Membership cron jobs scheduled successfully
[2025-10-06 07:59:19] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:13:39] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:13:39] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:17:37] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:17:38] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:17:38] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:17:41] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:17:50] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:17:50] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:17:50] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:17:54] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:17:54] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:18:09] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:18:10] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:21:36] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:21:44] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:21:44] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:21:45] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:21:46] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:21:46] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:22:06] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:24:32] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:24:43] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:24:43] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:24:44] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:24:44] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:24:44] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:24:45] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:24:55] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:24:55] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:24:55] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:40:14] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:40:14] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:40:15] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:40:40] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:40:40] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:40:40] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:43:14] [debug] Membership cron jobs scheduled successfully
[2025-10-06 08:43:14] [debug] Test debug message from settings system test Array
(
    [test_data] => hello world
)

[2025-10-06 08:43:14] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:00:10] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:00:11] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87985
    [timestamp] => 2025-10-06 09:00:11
    [memory_usage] => 118MB
)

[2025-10-06 09:00:11] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87985
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:00:11
    [item_count] => 0
)

[2025-10-06 09:00:11] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:00:11] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:00:11] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:00:11] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:00:11] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1862
    [order_id] => 87985
)

[2025-10-06 09:00:11] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:00:11] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87985
    [final_memory_usage] => 118MB
)

[2025-10-06 09:00:11] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:00:11] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87985
    [product_id] => 67487
)

[2025-10-06 09:00:11] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:00:11] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87985
    [timestamp] => 2025-10-06 09:00:11
    [memory_usage] => 122MB
)

[2025-10-06 09:00:11] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87985
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:00:11
    [item_count] => 1
)

[2025-10-06 09:00:11] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:00:11] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:00:11] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:00:11] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:00:11] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1862
    [order_id] => 87985
)

[2025-10-06 09:00:11] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:00:11] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:00:11] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:00:11] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87985
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:00:11] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:00:11] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87985
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:00:11
)

[2025-10-06 09:00:11] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:00:11] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:00:11] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:00:11] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:00:11] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:00:11] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:00:11] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:00:11] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1862
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:00:11] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1862
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:00:11] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1862
[2025-10-06 09:00:11] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:00:11] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:00:11] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:00:11] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759755611
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87985
    [user_id] => 1862
)

[2025-10-06 09:00:11] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:00:11] [debug] MembershipOrderHandler: User data updated 1862
[2025-10-06 09:00:11] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:00:11] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87985
)

[2025-10-06 09:00:11] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:00:11] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:00:11] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759755611
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87985
    [user_id] => 1862
)

[2025-10-06 09:00:11] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:00:11
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:00:11] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87985
)

[2025-10-06 09:00:11] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1862
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:00:11] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:00:11] [debug] Payment method set:  online
[2025-10-06 09:00:11] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:00:11] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:00:12] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:00:12] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:00:34] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:01:32] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:01:32] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:01:32] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:02:42] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:02:49] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:03:07] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:03:14] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:03:15] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87989
    [timestamp] => 2025-10-06 09:03:15
    [memory_usage] => 118MB
)

[2025-10-06 09:03:15] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87989
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:03:15
    [item_count] => 0
)

[2025-10-06 09:03:15] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:03:15] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:03:15] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:03:15] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:03:15] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1862
    [order_id] => 87989
)

[2025-10-06 09:03:15] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:03:15] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87989
    [final_memory_usage] => 118MB
)

[2025-10-06 09:03:15] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:03:15] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87989
    [product_id] => 67487
)

[2025-10-06 09:03:15] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:03:15] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87989
    [timestamp] => 2025-10-06 09:03:15
    [memory_usage] => 122MB
)

[2025-10-06 09:03:15] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87989
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:03:15
    [item_count] => 1
)

[2025-10-06 09:03:15] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:03:15] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:03:15] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:03:15] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:03:15] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1862
    [order_id] => 87989
)

[2025-10-06 09:03:15] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:03:15] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:03:15] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:03:15] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87989
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:03:15] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:03:15] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87989
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:03:15
)

[2025-10-06 09:03:15] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:03:15] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:03:15] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:03:15] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:03:15] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:03:15] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:03:15] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:03:15] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1862
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:03:15] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1862
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:03:15] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1862
[2025-10-06 09:03:15] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:03:15] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:03:15] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:03:15] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759755795
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87989
    [user_id] => 1862
)

[2025-10-06 09:03:15] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:03:15] [debug] MembershipOrderHandler: User data updated 1862
[2025-10-06 09:03:15] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:03:15] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87989
)

[2025-10-06 09:03:15] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:03:15] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:03:15] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759755795
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87989
    [user_id] => 1862
)

[2025-10-06 09:03:15] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:03:15
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:03:15] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87989
)

[2025-10-06 09:03:15] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1862
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:03:15] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:03:15] [debug] Payment method set:  online
[2025-10-06 09:03:15] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:03:15] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:03:15] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:03:15] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:11:33] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:11:33] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87990
    [timestamp] => 2025-10-06 09:11:33
    [memory_usage] => 118MB
)

[2025-10-06 09:11:33] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87990
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:11:33
    [item_count] => 0
)

[2025-10-06 09:11:33] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:11:33] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:11:33] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:11:33] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:11:33] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1862
    [order_id] => 87990
)

[2025-10-06 09:11:33] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:11:33] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87990
    [final_memory_usage] => 118MB
)

[2025-10-06 09:11:33] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:11:33] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87990
    [product_id] => 67487
)

[2025-10-06 09:11:33] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:11:33] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87990
    [timestamp] => 2025-10-06 09:11:33
    [memory_usage] => 122MB
)

[2025-10-06 09:11:33] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87990
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:11:33
    [item_count] => 1
)

[2025-10-06 09:11:33] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:11:33] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:11:33] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:11:33] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:11:33] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1862
    [order_id] => 87990
)

[2025-10-06 09:11:33] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:11:33] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:11:33] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:11:33] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87990
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:11:33] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:11:33] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87990
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:11:33
)

[2025-10-06 09:11:33] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:11:33] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:11:33] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:11:33] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:11:33] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:11:33] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:11:33] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:11:33] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1862
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:11:33] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1862
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:11:33] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1862
[2025-10-06 09:11:33] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:11:33] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:11:33] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:11:33] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756293
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87990
    [user_id] => 1862
)

[2025-10-06 09:11:33] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:11:34] [debug] MembershipOrderHandler: User data updated 1862
[2025-10-06 09:11:34] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:11:34] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87990
)

[2025-10-06 09:11:34] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:11:34] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:11:34] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756293
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87990
    [user_id] => 1862
)

[2025-10-06 09:11:34] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:11:34
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:11:34] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87990
)

[2025-10-06 09:11:34] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1862
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:11:34] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:11:34] [debug] Payment method set:  online
[2025-10-06 09:11:34] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:11:34] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:11:34] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:11:34] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:11:34] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1862
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:11:34] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:11:34] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1862
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:11:34] [debug] âŒ UserRegistrationAction: Failed to create constituent Array
(
    [response] => Array
        (
            [success] => 
            [error] => HTTP 404: {"status":404,"error":"Not Found"}
            [http_code] => 404
            [data] => 
        )

)

[2025-10-06 09:11:34] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1862
    [lgl_id] => 
)

[2025-10-06 09:11:34] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1862
    [success] => Registration call completed
)

[2025-10-06 09:11:34] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1862
    [lgl_api_called] => YES
)

[2025-10-06 09:11:34] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:11:34] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87990
    [user_id] => 1862
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:11:34] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:11:34] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:11:34] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87990
    [final_memory_usage] => 122MB
)

[2025-10-06 09:11:55] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87991
    [timestamp] => 2025-10-06 09:11:55
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:11:55] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87991
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:11:54
    [item_count] => 0
)

[2025-10-06 09:11:55] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:11:55] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:11:55] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:11:55] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:11:55] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1862
    [order_id] => 87991
)

[2025-10-06 09:11:55] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:11:55] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87991
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:11:55] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:11:55] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87991
    [product_id] => 67487
)

[2025-10-06 09:11:55] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:11:55] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87991
    [timestamp] => 2025-10-06 09:11:55
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:11:55] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87991
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1862
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:11:54
    [item_count] => 1
)

[2025-10-06 09:11:55] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1862
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:11:55] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1862
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:11:55] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:11:55] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:11:55] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1862
    [order_id] => 87991
)

[2025-10-06 09:11:55] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:11:55] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:11:55] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:11:55] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87991
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:11:55] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:11:55] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1862
    [order_id] => 87991
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:11:55
)

[2025-10-06 09:11:55] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:11:55] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:11:55] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:11:55] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:11:55] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:11:55] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:11:55] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:11:55] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1862
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:11:55] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1862
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:11:55] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1862
[2025-10-06 09:11:55] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:11:55] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:11:55] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:11:55] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756314
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87991
    [user_id] => 1862
)

[2025-10-06 09:11:55] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:11:55] [debug] MembershipOrderHandler: User data updated 1862
[2025-10-06 09:11:55] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:11:55] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87991
)

[2025-10-06 09:11:55] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:11:55] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:11:55] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756314
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87991
    [user_id] => 1862
)

[2025-10-06 09:11:55] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:11:55
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:11:55] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1862
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87991
)

[2025-10-06 09:11:55] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1862
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:11:55] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:11:55] [debug] Payment method set:  online
[2025-10-06 09:11:55] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:11:55] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:11:56] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:11:56] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:11:56] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1862
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:11:56] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:11:56] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1862
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:11:56] [debug] âŒ UserRegistrationAction: Failed to create constituent Array
(
    [response] => Array
        (
            [success] => 
            [error] => HTTP 404: {"status":404,"error":"Not Found"}
            [http_code] => 404
            [data] => 
        )

)

[2025-10-06 09:11:56] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1862
    [lgl_id] => 
)

[2025-10-06 09:11:56] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1862
    [success] => Registration call completed
)

[2025-10-06 09:11:56] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1862
    [lgl_api_called] => YES
)

[2025-10-06 09:11:56] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:11:56] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87991
    [user_id] => 1862
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:11:56] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:11:56] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:11:56] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87991
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:13:22] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:13:23] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87992
    [timestamp] => 2025-10-06 09:13:23
    [memory_usage] => 118MB
)

[2025-10-06 09:13:23] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87992
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1863
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:13:23
    [item_count] => 0
)

[2025-10-06 09:13:23] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1863
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:13:23] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1863
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:13:23] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:13:23] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:13:23] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1863
    [order_id] => 87992
)

[2025-10-06 09:13:23] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:13:23] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87992
    [final_memory_usage] => 118MB
)

[2025-10-06 09:13:23] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:13:23] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87992
    [product_id] => 67487
)

[2025-10-06 09:13:23] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:13:23] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87992
    [timestamp] => 2025-10-06 09:13:23
    [memory_usage] => 122MB
)

[2025-10-06 09:13:23] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87992
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1863
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:13:23
    [item_count] => 1
)

[2025-10-06 09:13:23] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1863
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:13:23] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1863
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:13:23] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:13:23] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:13:23] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1863
    [order_id] => 87992
)

[2025-10-06 09:13:23] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:13:23] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:13:23] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:13:23] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1863
    [order_id] => 87992
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:13:23] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:13:23] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1863
    [order_id] => 87992
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:13:23
)

[2025-10-06 09:13:23] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:13:23] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:13:23] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:13:23] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:13:23] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:13:23] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:13:23] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:13:23] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1863
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:13:23] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1863
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:13:23] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1863
[2025-10-06 09:13:23] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:13:23] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:13:23] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:13:23] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756403
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87992
    [user_id] => 1863
)

[2025-10-06 09:13:23] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:13:23] [debug] MembershipOrderHandler: User data updated 1863
[2025-10-06 09:13:23] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:13:23] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1863
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87992
)

[2025-10-06 09:13:23] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:13:23] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:13:23] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756403
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87992
    [user_id] => 1863
)

[2025-10-06 09:13:23] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:13:23
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:13:23] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1863
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87992
)

[2025-10-06 09:13:23] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1863
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:13:23] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:13:23] [debug] Payment method set:  online
[2025-10-06 09:13:23] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:13:23] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:13:24] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:13:24] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:13:24] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1863
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:13:24] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:13:24] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1863
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:13:24] [debug] âŒ UserRegistrationAction: Failed to create constituent Array
(
    [response] => Array
        (
            [success] => 
            [error] => HTTP 404: {"status":404,"error":"Not Found"}
            [http_code] => 404
            [data] => 
        )

)

[2025-10-06 09:13:24] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1863
    [lgl_id] => 
)

[2025-10-06 09:13:24] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1863
    [success] => Registration call completed
)

[2025-10-06 09:13:24] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1863
    [lgl_api_called] => YES
)

[2025-10-06 09:13:24] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:13:24] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87992
    [user_id] => 1863
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:13:24] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:13:24] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:13:24] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87992
    [final_memory_usage] => 122MB
)

[2025-10-06 09:17:03] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87993
    [timestamp] => 2025-10-06 09:17:03
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:17:03] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87993
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1863
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:17:03
    [item_count] => 0
)

[2025-10-06 09:17:03] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1863
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:17:03] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1863
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:17:03] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:17:03] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:17:03] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1863
    [order_id] => 87993
)

[2025-10-06 09:17:03] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:17:03] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87993
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:17:03] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:17:03] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87993
    [product_id] => 67487
)

[2025-10-06 09:17:03] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:17:03] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87993
    [timestamp] => 2025-10-06 09:17:03
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:17:03] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87993
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1863
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:17:03
    [item_count] => 1
)

[2025-10-06 09:17:03] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1863
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:17:03] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1863
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:17:03] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:17:03] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:17:03] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1863
    [order_id] => 87993
)

[2025-10-06 09:17:03] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:17:03] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:17:03] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:17:03] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1863
    [order_id] => 87993
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:17:03] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:17:03] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1863
    [order_id] => 87993
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:17:03
)

[2025-10-06 09:17:03] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:17:03] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:17:03] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:17:03] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:17:03] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:17:03] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:17:03] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:17:03] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1863
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:17:03] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1863
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:17:03] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1863
[2025-10-06 09:17:03] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:17:03] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:17:03] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:17:03] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756623
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87993
    [user_id] => 1863
)

[2025-10-06 09:17:03] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:17:03] [debug] MembershipOrderHandler: User data updated 1863
[2025-10-06 09:17:03] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:17:03] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1863
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87993
)

[2025-10-06 09:17:03] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:17:03] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:17:03] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756623
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87993
    [user_id] => 1863
)

[2025-10-06 09:17:03] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:17:03
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:17:03] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1863
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87993
)

[2025-10-06 09:17:03] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1863
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:17:03] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:17:03] [debug] Payment method set:  online
[2025-10-06 09:17:03] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:17:03] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:17:04] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:17:04] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:17:04] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1863
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:17:04] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:17:04] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1863
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:17:04] [debug] âŒ UserRegistrationAction: Failed to create constituent Array
(
    [response] => Array
        (
            [success] => 
            [error] => HTTP 404: {"status":404,"error":"Not Found"}
            [http_code] => 404
            [data] => 
        )

)

[2025-10-06 09:17:04] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1863
    [lgl_id] => 
)

[2025-10-06 09:17:04] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1863
    [success] => Registration call completed
)

[2025-10-06 09:17:04] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1863
    [lgl_api_called] => YES
)

[2025-10-06 09:17:04] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:17:04] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87993
    [user_id] => 1863
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:17:04] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:17:04] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:17:04] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87993
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:17:12] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:17:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87994
    [timestamp] => 2025-10-06 09:17:13
    [memory_usage] => 118MB
)

[2025-10-06 09:17:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87994
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1864
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:17:13
    [item_count] => 0
)

[2025-10-06 09:17:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1864
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:17:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1864
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:17:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:17:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:17:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1864
    [order_id] => 87994
)

[2025-10-06 09:17:13] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:17:13] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87994
    [final_memory_usage] => 118MB
)

[2025-10-06 09:17:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:17:13] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87994
    [product_id] => 67487
)

[2025-10-06 09:17:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:17:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87994
    [timestamp] => 2025-10-06 09:17:13
    [memory_usage] => 122MB
)

[2025-10-06 09:17:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87994
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1864
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:17:13
    [item_count] => 1
)

[2025-10-06 09:17:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1864
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:17:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1864
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:17:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:17:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:17:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1864
    [order_id] => 87994
)

[2025-10-06 09:17:13] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:17:13] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:17:13] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:17:13] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1864
    [order_id] => 87994
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:17:13] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:17:13] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1864
    [order_id] => 87994
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:17:13
)

[2025-10-06 09:17:13] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:17:13] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:17:13] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:17:13] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:17:13] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:17:13] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:17:13] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:17:13] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1864
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:17:13] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1864
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:17:13] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1864
[2025-10-06 09:17:13] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:17:13] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:17:13] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:17:13] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756633
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87994
    [user_id] => 1864
)

[2025-10-06 09:17:13] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:17:13] [debug] MembershipOrderHandler: User data updated 1864
[2025-10-06 09:17:13] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:17:13] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1864
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87994
)

[2025-10-06 09:17:13] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:17:13] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:17:13] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756633
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87994
    [user_id] => 1864
)

[2025-10-06 09:17:13] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:17:13
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:17:13] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1864
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87994
)

[2025-10-06 09:17:13] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1864
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:17:13] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:17:13] [debug] Payment method set:  online
[2025-10-06 09:17:13] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:17:13] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:17:13] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:17:13] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:17:13] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1864
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:17:13] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:17:13] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1864
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:17:14] [debug] âŒ UserRegistrationAction: Failed to create constituent Array
(
    [response] => Array
        (
            [success] => 
            [error] => HTTP 404: {"status":404,"error":"Not Found"}
            [http_code] => 404
            [data] => 
        )

)

[2025-10-06 09:17:14] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1864
    [lgl_id] => 
)

[2025-10-06 09:17:14] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1864
    [success] => Registration call completed
)

[2025-10-06 09:17:14] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1864
    [lgl_api_called] => YES
)

[2025-10-06 09:17:14] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:17:14] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87994
    [user_id] => 1864
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:17:14] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:17:14] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:17:14] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87994
    [final_memory_usage] => 122MB
)

[2025-10-06 09:22:34] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87996
    [timestamp] => 2025-10-06 09:22:34
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:22:34] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87996
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1865
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:22:34
    [item_count] => 0
)

[2025-10-06 09:22:34] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1865
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:22:34] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1865
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:22:34] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:22:34] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:22:34] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1865
    [order_id] => 87996
)

[2025-10-06 09:22:34] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:22:34] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87996
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:22:34] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:22:34] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87996
    [product_id] => 67487
)

[2025-10-06 09:22:34] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:22:34] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87996
    [timestamp] => 2025-10-06 09:22:34
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:22:34] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87996
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1865
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:22:34
    [item_count] => 1
)

[2025-10-06 09:22:34] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1865
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:22:34] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1865
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:22:34] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:22:34] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:22:34] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1865
    [order_id] => 87996
)

[2025-10-06 09:22:34] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:22:34] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:22:34] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:22:34] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1865
    [order_id] => 87996
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:22:34] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:22:34] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1865
    [order_id] => 87996
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:22:34
)

[2025-10-06 09:22:34] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:22:34] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:22:34] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:22:34] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:22:34] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:22:34] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:22:34] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:22:34] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1865
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:22:34] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1865
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:22:34] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1865
[2025-10-06 09:22:34] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:22:34] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:22:34] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:22:34] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756954
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87996
    [user_id] => 1865
)

[2025-10-06 09:22:34] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:22:35] [debug] MembershipOrderHandler: User data updated 1865
[2025-10-06 09:22:35] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:22:35] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1865
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87996
)

[2025-10-06 09:22:35] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:22:35] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:22:35] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759756954
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87996
    [user_id] => 1865
)

[2025-10-06 09:22:35] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:22:35
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:22:35] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1865
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87996
)

[2025-10-06 09:22:35] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1865
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:22:35] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:22:35] [debug] Payment method set:  online
[2025-10-06 09:22:35] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:22:35] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:22:35] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:22:35] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:22:35] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1865
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:22:35] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:22:35] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1865
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:22:36] [debug] âŒ UserRegistrationAction: Failed to create constituent Array
(
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 946487
                    [external_constituent_id] => 1865
                    [is_org] => 
                    [constituent_contact_type_id] => 1247
                    [constituent_contact_type_name] => Primary
                    [prefix] => 
                    [first_name] => Debug
                    [middle_name] => 
                    [last_name] => Test
                    [suffix] => 
                    [spouse_name] => 
                    [org_name] => 
                    [job_title] => 
                    [addressee] => Debug Test
                    [salutation] => Debug
                    [sort_name] => Test, Debug
                    [constituent_interest_level_id] => 
                    [constituent_interest_level_name] => 
                    [constituent_rating_id] => 
                    [constituent_rating_name] => 
                    [is_deceased] => 
                    [deceased_date] => 
                    [annual_report_name] => Debug Test
                    [birthday] => 
                    [gender] => 
                    [maiden_name] => 
                    [nick_name] => 
                    [spouse_nick_name] => 
                    [date_added] => 2025-10-06
                    [alt_salutation] => Debug
                    [alt_addressee] => Debug Test
                    [honorary_name] => Debug Test
                    [assistant_name] => 
                    [marital_status_id] => 
                    [marital_status_name] => 
                    [is_anon] => 
                    [created_at] => 2025-10-06T13:22:36Z
                    [updated_at] => 2025-10-06T13:22:36Z
                    [class_affiliations] => Array
                        (
                        )

                    [relationships] => Array
                        (
                        )

                    [street_addresses] => Array
                        (
                        )

                    [phone_numbers] => Array
                        (
                        )

                    [email_addresses] => Array
                        (
                        )

                    [web_addresses] => Array
                        (
                        )

                    [categories] => Array
                        (
                        )

                    [groups] => Array
                        (
                        )

                    [memberships] => Array
                        (
                        )

                    [custom_attrs] => Array
                        (
                        )

                )

            [raw_response] => {"api_version":"1.0","id":946487,"external_constituent_id":"1865","is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"","job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":null,"maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-06","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-06T13:22:36Z","updated_at":"2025-10-06T13:22:36Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
        )

)

[2025-10-06 09:22:36] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1865
    [lgl_id] => 
)

[2025-10-06 09:22:36] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1865
    [success] => Registration call completed
)

[2025-10-06 09:22:36] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1865
    [lgl_api_called] => YES
)

[2025-10-06 09:22:36] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:22:36] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87996
    [user_id] => 1865
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:22:36] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:22:36] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:22:36] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87996
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:23:34] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:23:35] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87997
    [timestamp] => 2025-10-06 09:23:35
    [memory_usage] => 118MB
)

[2025-10-06 09:23:35] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87997
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1866
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:23:35
    [item_count] => 0
)

[2025-10-06 09:23:35] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1866
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:23:35] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1866
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:23:35] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:23:35] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:23:35] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1866
    [order_id] => 87997
)

[2025-10-06 09:23:35] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:23:35] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87997
    [final_memory_usage] => 118MB
)

[2025-10-06 09:23:35] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:23:35] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87997
    [product_id] => 67487
)

[2025-10-06 09:23:35] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:23:35] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87997
    [timestamp] => 2025-10-06 09:23:35
    [memory_usage] => 122MB
)

[2025-10-06 09:23:35] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87997
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1866
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:23:35
    [item_count] => 1
)

[2025-10-06 09:23:35] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1866
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:23:35] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1866
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:23:35] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:23:35] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:23:35] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1866
    [order_id] => 87997
)

[2025-10-06 09:23:35] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:23:35] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:23:35] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:23:35] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1866
    [order_id] => 87997
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:23:35] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:23:35] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1866
    [order_id] => 87997
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:23:35
)

[2025-10-06 09:23:35] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:23:35] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:23:35] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:23:35] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:23:35] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:23:35] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:23:35] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:23:35] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1866
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:23:35] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1866
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:23:35] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1866
[2025-10-06 09:23:35] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:23:35] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:23:35] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:23:35] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757015
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87997
    [user_id] => 1866
)

[2025-10-06 09:23:35] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:23:35] [debug] MembershipOrderHandler: User data updated 1866
[2025-10-06 09:23:35] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:23:35] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1866
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87997
)

[2025-10-06 09:23:35] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:23:35] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:23:35] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757015
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87997
    [user_id] => 1866
)

[2025-10-06 09:23:35] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:23:35
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:23:35] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1866
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87997
)

[2025-10-06 09:23:35] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1866
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:23:35] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:23:35] [debug] Payment method set:  online
[2025-10-06 09:23:35] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:23:35] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:23:36] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:23:36] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:23:36] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1866
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:23:36] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:23:36] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1866
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:23:36] [debug] âŒ UserRegistrationAction: Failed to create constituent Array
(
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 946497
                    [external_constituent_id] => 1866
                    [is_org] => 
                    [constituent_contact_type_id] => 1247
                    [constituent_contact_type_name] => Primary
                    [prefix] => 
                    [first_name] => Debug
                    [middle_name] => 
                    [last_name] => Test
                    [suffix] => 
                    [spouse_name] => 
                    [org_name] => 
                    [job_title] => 
                    [addressee] => Debug Test
                    [salutation] => Debug
                    [sort_name] => Test, Debug
                    [constituent_interest_level_id] => 
                    [constituent_interest_level_name] => 
                    [constituent_rating_id] => 
                    [constituent_rating_name] => 
                    [is_deceased] => 
                    [deceased_date] => 
                    [annual_report_name] => Debug Test
                    [birthday] => 
                    [gender] => 
                    [maiden_name] => 
                    [nick_name] => 
                    [spouse_nick_name] => 
                    [date_added] => 2025-10-06
                    [alt_salutation] => Debug
                    [alt_addressee] => Debug Test
                    [honorary_name] => Debug Test
                    [assistant_name] => 
                    [marital_status_id] => 
                    [marital_status_name] => 
                    [is_anon] => 
                    [created_at] => 2025-10-06T13:23:36Z
                    [updated_at] => 2025-10-06T13:23:36Z
                    [class_affiliations] => Array
                        (
                        )

                    [relationships] => Array
                        (
                        )

                    [street_addresses] => Array
                        (
                        )

                    [phone_numbers] => Array
                        (
                        )

                    [email_addresses] => Array
                        (
                        )

                    [web_addresses] => Array
                        (
                        )

                    [categories] => Array
                        (
                        )

                    [groups] => Array
                        (
                        )

                    [memberships] => Array
                        (
                        )

                    [custom_attrs] => Array
                        (
                        )

                )

            [raw_response] => {"api_version":"1.0","id":946497,"external_constituent_id":"1866","is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"","job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":null,"maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-06","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-06T13:23:36Z","updated_at":"2025-10-06T13:23:36Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
        )

)

[2025-10-06 09:23:36] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1866
    [lgl_id] => 
)

[2025-10-06 09:23:36] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1866
    [success] => Registration call completed
)

[2025-10-06 09:23:36] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1866
    [lgl_api_called] => YES
)

[2025-10-06 09:23:36] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:23:36] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87997
    [user_id] => 1866
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:23:36] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:23:36] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:23:36] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87997
    [final_memory_usage] => 122MB
)

[2025-10-06 09:26:49] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87998
    [timestamp] => 2025-10-06 09:26:49
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:26:49] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87998
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1867
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:26:49
    [item_count] => 0
)

[2025-10-06 09:26:49] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1867
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:26:49] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1867
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:26:49] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:26:49] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:26:49] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1867
    [order_id] => 87998
)

[2025-10-06 09:26:49] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:26:49] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87998
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:26:49] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:26:49] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87998
    [product_id] => 67487
)

[2025-10-06 09:26:49] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:26:50] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87998
    [timestamp] => 2025-10-06 09:26:50
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:26:50] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87998
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1867
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:26:49
    [item_count] => 1
)

[2025-10-06 09:26:50] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1867
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:26:50] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1867
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:26:50] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:26:50] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:26:50] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1867
    [order_id] => 87998
)

[2025-10-06 09:26:50] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:26:50] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:26:50] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:26:50] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1867
    [order_id] => 87998
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:26:50] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:26:50] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1867
    [order_id] => 87998
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:26:50
)

[2025-10-06 09:26:50] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:26:50] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:26:50] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:26:50] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:26:50] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:26:50] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:26:50] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:26:50] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1867
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:26:50] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1867
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:26:50] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1867
[2025-10-06 09:26:50] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:26:50] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:26:50] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:26:50] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757209
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87998
    [user_id] => 1867
)

[2025-10-06 09:26:50] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:26:50] [debug] MembershipOrderHandler: User data updated 1867
[2025-10-06 09:26:50] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:26:50] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1867
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87998
)

[2025-10-06 09:26:50] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:26:50] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:26:50] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757209
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87998
    [user_id] => 1867
)

[2025-10-06 09:26:50] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:26:50
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:26:50] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1867
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87998
)

[2025-10-06 09:26:50] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1867
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:26:50] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:26:50] [debug] Payment method set:  online
[2025-10-06 09:26:50] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:26:50] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:26:51] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:26:51] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:26:51] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1867
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:26:51] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:26:51] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1867
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:26:51] [debug] âœ… UserRegistrationAction: Created new constituent Array
(
    [lgl_id] => 946507
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 946507
                    [external_constituent_id] => 1867
                    [is_org] => 
                    [constituent_contact_type_id] => 1247
                    [constituent_contact_type_name] => Primary
                    [prefix] => 
                    [first_name] => Debug
                    [middle_name] => 
                    [last_name] => Test
                    [suffix] => 
                    [spouse_name] => 
                    [org_name] => 
                    [job_title] => 
                    [addressee] => Debug Test
                    [salutation] => Debug
                    [sort_name] => Test, Debug
                    [constituent_interest_level_id] => 
                    [constituent_interest_level_name] => 
                    [constituent_rating_id] => 
                    [constituent_rating_name] => 
                    [is_deceased] => 
                    [deceased_date] => 
                    [annual_report_name] => Debug Test
                    [birthday] => 
                    [gender] => 
                    [maiden_name] => 
                    [nick_name] => 
                    [spouse_nick_name] => 
                    [date_added] => 2025-10-06
                    [alt_salutation] => Debug
                    [alt_addressee] => Debug Test
                    [honorary_name] => Debug Test
                    [assistant_name] => 
                    [marital_status_id] => 
                    [marital_status_name] => 
                    [is_anon] => 
                    [created_at] => 2025-10-06T13:26:51Z
                    [updated_at] => 2025-10-06T13:26:51Z
                    [class_affiliations] => Array
                        (
                        )

                    [relationships] => Array
                        (
                        )

                    [street_addresses] => Array
                        (
                        )

                    [phone_numbers] => Array
                        (
                        )

                    [email_addresses] => Array
                        (
                        )

                    [web_addresses] => Array
                        (
                        )

                    [categories] => Array
                        (
                        )

                    [groups] => Array
                        (
                        )

                    [memberships] => Array
                        (
                        )

                    [custom_attrs] => Array
                        (
                        )

                )

            [raw_response] => {"api_version":"1.0","id":946507,"external_constituent_id":"1867","is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"","job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":null,"maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-06","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-06T13:26:51Z","updated_at":"2025-10-06T13:26:51Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
        )

)

[2025-10-06 09:26:51] [debug] ðŸ“ UserRegistrationAction::addConstituentExtras() STARTED Array
(
    [lgl_id] => 946507
    [user_id] => 1867
    [is_family_member] => NO
)

[2025-10-06 09:26:52] [debug] âœ… UserRegistrationAction: Added email address Array
(
    [email] => debug.test@example.com
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 278717
                    [item_id] => 946507
                    [item_type] => Constituent
                    [address] => debug.test@example.com
                    [email_address_type_id] => 1
                    [email_type_name] => Home
                    [is_preferred] => 1
                    [not_current] => 
                    [parent_id] => 
                    [created_at] => 2025-10-06T13:26:52Z
                    [updated_at] => 2025-10-06T13:26:52Z
                )

            [raw_response] => {"api_version":"1.0","id":278717,"item_id":946507,"item_type":"Constituent","address":"debug.test@example.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2025-10-06T13:26:52Z","updated_at":"2025-10-06T13:26:52Z"}
        )

)

[2025-10-06 09:26:52] [debug] âœ… UserRegistrationAction: Added phone number Array
(
    [phone] => 555-DEBUG
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 481802
                    [item_id] => 946507
                    [item_type] => Constituent
                    [number] => 555-DEBUG
                    [phone_number_type_id] => 1
                    [phone_type_name] => Home
                    [is_preferred] => 1
                    [not_current] => 
                    [parent_id] => 
                    [normalized_number] => 555
                    [created_at] => 2025-10-06T13:26:52Z
                    [updated_at] => 2025-10-06T13:26:52Z
                )

            [raw_response] => {"api_version":"1.0","id":481802,"item_id":946507,"item_type":"Constituent","number":"555-DEBUG","phone_number_type_id":1,"phone_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"555","created_at":"2025-10-06T13:26:52Z","updated_at":"2025-10-06T13:26:52Z"}
        )

)

[2025-10-06 09:26:52] [debug] âœ… UserRegistrationAction: Added membership Array
(
    [membership_type] => Individual Membership
    [response] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank; Start date must be present and valid (YYYY-MM-DD)"}
            [http_code] => 422
            [data] => 
        )

)

[2025-10-06 09:26:52] [debug] ðŸ’³ Connection::addMembershipPayment() STARTED Array
(
    [lgl_id] => 946507
    [payment_type] => online
)

[2025-10-06 09:26:52] [debug] ðŸ’³ Connection::addMembershipPayment() - Payment data Array
(
    [constituent_id] => 946507
    [amount] => 0
    [date] => 2025-10-06
    [payment_method] => Credit Card
    [notes] => Membership payment via WordPress LGL Integration
    [fund_name] => Membership Dues
)

[2025-10-06 09:26:53] [debug] âŒ Connection::addMembershipPayment() - Failed to create payment Array
(
    [response] => Array
        (
            [success] => 
            [error] => HTTP 404: {"status":404,"error":"Not Found"}
            [http_code] => 404
            [data] => 
        )

)

[2025-10-06 09:26:53] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1867
    [lgl_id] => 
)

[2025-10-06 09:26:53] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1867
    [success] => Registration call completed
)

[2025-10-06 09:26:53] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1867
    [lgl_api_called] => YES
)

[2025-10-06 09:26:53] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:26:53] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87998
    [user_id] => 1867
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:26:53] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:26:53] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:26:53] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87998
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:27:28] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:27:30] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87999
    [timestamp] => 2025-10-06 09:27:30
    [memory_usage] => 118MB
)

[2025-10-06 09:27:30] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87999
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1868
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:27:30
    [item_count] => 0
)

[2025-10-06 09:27:30] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1868
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:27:30] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1868
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:27:30] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:27:30] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:27:30] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1868
    [order_id] => 87999
)

[2025-10-06 09:27:30] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:27:30] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87999
    [final_memory_usage] => 118MB
)

[2025-10-06 09:27:30] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:27:30] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 87999
    [product_id] => 67487
)

[2025-10-06 09:27:30] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:27:30] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 87999
    [timestamp] => 2025-10-06 09:27:30
    [memory_usage] => 122MB
)

[2025-10-06 09:27:30] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 87999
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1868
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:27:30
    [item_count] => 1
)

[2025-10-06 09:27:30] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1868
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:27:30] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1868
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:27:30] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:27:30] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:27:30] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1868
    [order_id] => 87999
)

[2025-10-06 09:27:30] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:27:30] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:27:30] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:27:30] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1868
    [order_id] => 87999
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:27:30] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:27:30] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1868
    [order_id] => 87999
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:27:30
)

[2025-10-06 09:27:30] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:27:30] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:27:30] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:27:30] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:27:30] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:27:30] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:27:30] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:27:30] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1868
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:27:30] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1868
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:27:30] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1868
[2025-10-06 09:27:30] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:27:30] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:27:30] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:27:30] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757250
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87999
    [user_id] => 1868
)

[2025-10-06 09:27:30] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:27:30] [debug] MembershipOrderHandler: User data updated 1868
[2025-10-06 09:27:30] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:27:30] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1868
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87999
)

[2025-10-06 09:27:30] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:27:30] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:27:30] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757250
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 87999
    [user_id] => 1868
)

[2025-10-06 09:27:30] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:27:30
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:27:30] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1868
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 87999
)

[2025-10-06 09:27:30] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1868
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:27:30] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:27:30] [debug] Payment method set:  online
[2025-10-06 09:27:30] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:27:30] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:27:31] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:27:31] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:27:31] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1868
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:27:31] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:27:31] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1868
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:27:31] [debug] âœ… UserRegistrationAction: Created new constituent Array
(
    [lgl_id] => 946517
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 946517
                    [external_constituent_id] => 1868
                    [is_org] => 
                    [constituent_contact_type_id] => 1247
                    [constituent_contact_type_name] => Primary
                    [prefix] => 
                    [first_name] => Debug
                    [middle_name] => 
                    [last_name] => Test
                    [suffix] => 
                    [spouse_name] => 
                    [org_name] => 
                    [job_title] => 
                    [addressee] => Debug Test
                    [salutation] => Debug
                    [sort_name] => Test, Debug
                    [constituent_interest_level_id] => 
                    [constituent_interest_level_name] => 
                    [constituent_rating_id] => 
                    [constituent_rating_name] => 
                    [is_deceased] => 
                    [deceased_date] => 
                    [annual_report_name] => Debug Test
                    [birthday] => 
                    [gender] => 
                    [maiden_name] => 
                    [nick_name] => 
                    [spouse_nick_name] => 
                    [date_added] => 2025-10-06
                    [alt_salutation] => Debug
                    [alt_addressee] => Debug Test
                    [honorary_name] => Debug Test
                    [assistant_name] => 
                    [marital_status_id] => 
                    [marital_status_name] => 
                    [is_anon] => 
                    [created_at] => 2025-10-06T13:27:31Z
                    [updated_at] => 2025-10-06T13:27:31Z
                    [class_affiliations] => Array
                        (
                        )

                    [relationships] => Array
                        (
                        )

                    [street_addresses] => Array
                        (
                        )

                    [phone_numbers] => Array
                        (
                        )

                    [email_addresses] => Array
                        (
                        )

                    [web_addresses] => Array
                        (
                        )

                    [categories] => Array
                        (
                        )

                    [groups] => Array
                        (
                        )

                    [memberships] => Array
                        (
                        )

                    [custom_attrs] => Array
                        (
                        )

                )

            [raw_response] => {"api_version":"1.0","id":946517,"external_constituent_id":"1868","is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"","job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":null,"maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-06","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-06T13:27:31Z","updated_at":"2025-10-06T13:27:31Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
        )

)

[2025-10-06 09:27:31] [debug] ðŸ“ UserRegistrationAction::addConstituentExtras() STARTED Array
(
    [lgl_id] => 946517
    [user_id] => 1868
    [is_family_member] => NO
)

[2025-10-06 09:27:32] [debug] âœ… UserRegistrationAction: Added email address Array
(
    [email] => debug.test@example.com
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 278722
                    [item_id] => 946517
                    [item_type] => Constituent
                    [address] => debug.test@example.com
                    [email_address_type_id] => 1
                    [email_type_name] => Home
                    [is_preferred] => 1
                    [not_current] => 
                    [parent_id] => 
                    [created_at] => 2025-10-06T13:27:32Z
                    [updated_at] => 2025-10-06T13:27:32Z
                )

            [raw_response] => {"api_version":"1.0","id":278722,"item_id":946517,"item_type":"Constituent","address":"debug.test@example.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2025-10-06T13:27:32Z","updated_at":"2025-10-06T13:27:32Z"}
        )

)

[2025-10-06 09:27:32] [debug] âœ… UserRegistrationAction: Added phone number Array
(
    [phone] => 555-DEBUG
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 481807
                    [item_id] => 946517
                    [item_type] => Constituent
                    [number] => 555-DEBUG
                    [phone_number_type_id] => 1
                    [phone_type_name] => Home
                    [is_preferred] => 1
                    [not_current] => 
                    [parent_id] => 
                    [normalized_number] => 555
                    [created_at] => 2025-10-06T13:27:32Z
                    [updated_at] => 2025-10-06T13:27:32Z
                )

            [raw_response] => {"api_version":"1.0","id":481807,"item_id":946517,"item_type":"Constituent","number":"555-DEBUG","phone_number_type_id":1,"phone_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"555","created_at":"2025-10-06T13:27:32Z","updated_at":"2025-10-06T13:27:32Z"}
        )

)

[2025-10-06 09:27:32] [debug] âœ… UserRegistrationAction: Added membership Array
(
    [membership_type] => Individual Membership
    [response] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank; Start date must be present and valid (YYYY-MM-DD)"}
            [http_code] => 422
            [data] => 
        )

)

[2025-10-06 09:27:32] [debug] ðŸ’³ Connection::addMembershipPayment() STARTED Array
(
    [lgl_id] => 946517
    [payment_type] => online
)

[2025-10-06 09:27:32] [debug] ðŸ’³ Connection::addMembershipPayment() - Payment data Array
(
    [constituent_id] => 946517
    [amount] => 0
    [date] => 2025-10-06
    [payment_method] => Credit Card
    [notes] => Membership payment via WordPress LGL Integration
    [fund_name] => Membership Dues
)

[2025-10-06 09:27:33] [debug] âŒ Connection::addMembershipPayment() - Failed to create payment Array
(
    [response] => Array
        (
            [success] => 
            [error] => HTTP 404: {"status":404,"error":"Not Found"}
            [http_code] => 404
            [data] => 
        )

)

[2025-10-06 09:27:33] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1868
    [lgl_id] => 
)

[2025-10-06 09:27:33] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1868
    [success] => Registration call completed
)

[2025-10-06 09:27:33] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1868
    [lgl_api_called] => YES
)

[2025-10-06 09:27:33] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:27:33] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 87999
    [user_id] => 1868
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:27:33] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:27:33] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:27:33] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 87999
    [final_memory_usage] => 122MB
)

[2025-10-06 09:31:24] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88000
    [timestamp] => 2025-10-06 09:31:24
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:31:24] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88000
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1869
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:31:24
    [item_count] => 0
)

[2025-10-06 09:31:24] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1869
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:31:24] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1869
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:31:24] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:31:24] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:31:24] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1869
    [order_id] => 88000
)

[2025-10-06 09:31:24] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:31:24] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88000
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:31:24] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:31:24] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88000
    [product_id] => 67487
)

[2025-10-06 09:31:24] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:31:24] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88000
    [timestamp] => 2025-10-06 09:31:24
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:31:24] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88000
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1869
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:31:24
    [item_count] => 1
)

[2025-10-06 09:31:24] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1869
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:31:24] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1869
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:31:24] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:31:24] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:31:24] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1869
    [order_id] => 88000
)

[2025-10-06 09:31:24] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:31:24] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:31:24] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:31:24] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1869
    [order_id] => 88000
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:31:24] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:31:24] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1869
    [order_id] => 88000
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:31:24
)

[2025-10-06 09:31:24] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:31:24] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:31:24] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:31:24] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:31:24] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:31:24] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:31:24] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:31:24] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1869
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:31:24] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1869
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:31:24] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1869
[2025-10-06 09:31:24] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:31:24] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:31:24] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:31:24] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757484
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88000
    [user_id] => 1869
)

[2025-10-06 09:31:24] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:31:25] [debug] MembershipOrderHandler: User data updated 1869
[2025-10-06 09:31:25] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:31:25] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1869
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88000
)

[2025-10-06 09:31:25] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:31:25] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:31:25] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757484
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88000
    [user_id] => 1869
)

[2025-10-06 09:31:25] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:31:25
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:31:25] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1869
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88000
)

[2025-10-06 09:31:25] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1869
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:31:25] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:31:25] [debug] Payment method set:  online
[2025-10-06 09:31:25] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:31:25] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:31:25] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:31:25] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:31:25] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:31:25] [debug] âœ… Found 9 constituents with method 1
[2025-10-06 09:31:25] [debug] âœ… Email search match found Array
(
    [lgl_id] => 
)

[2025-10-06 09:31:25] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:31:25] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:31:25] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1869
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:31:25] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:31:25] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1869
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:31:26] [debug] âœ… UserRegistrationAction: Created new constituent Array
(
    [lgl_id] => 946527
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 946527
                    [external_constituent_id] => 1869
                    [is_org] => 
                    [constituent_contact_type_id] => 1247
                    [constituent_contact_type_name] => Primary
                    [prefix] => 
                    [first_name] => Debug
                    [middle_name] => 
                    [last_name] => Test
                    [suffix] => 
                    [spouse_name] => 
                    [org_name] => 
                    [job_title] => 
                    [addressee] => Debug Test
                    [salutation] => Debug
                    [sort_name] => Test, Debug
                    [constituent_interest_level_id] => 
                    [constituent_interest_level_name] => 
                    [constituent_rating_id] => 
                    [constituent_rating_name] => 
                    [is_deceased] => 
                    [deceased_date] => 
                    [annual_report_name] => Debug Test
                    [birthday] => 
                    [gender] => 
                    [maiden_name] => 
                    [nick_name] => 
                    [spouse_nick_name] => 
                    [date_added] => 2025-10-06
                    [alt_salutation] => Debug
                    [alt_addressee] => Debug Test
                    [honorary_name] => Debug Test
                    [assistant_name] => 
                    [marital_status_id] => 
                    [marital_status_name] => 
                    [is_anon] => 
                    [created_at] => 2025-10-06T13:31:26Z
                    [updated_at] => 2025-10-06T13:31:26Z
                    [class_affiliations] => Array
                        (
                        )

                    [relationships] => Array
                        (
                        )

                    [street_addresses] => Array
                        (
                        )

                    [phone_numbers] => Array
                        (
                        )

                    [email_addresses] => Array
                        (
                        )

                    [web_addresses] => Array
                        (
                        )

                    [categories] => Array
                        (
                        )

                    [groups] => Array
                        (
                        )

                    [memberships] => Array
                        (
                        )

                    [custom_attrs] => Array
                        (
                        )

                )

            [raw_response] => {"api_version":"1.0","id":946527,"external_constituent_id":"1869","is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"","job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":null,"maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-06","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-06T13:31:26Z","updated_at":"2025-10-06T13:31:26Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
        )

)

[2025-10-06 09:31:26] [debug] ðŸ“ UserRegistrationAction::addConstituentExtras() STARTED Array
(
    [lgl_id] => 946527
    [user_id] => 1869
    [is_family_member] => NO
)

[2025-10-06 09:31:27] [debug] âœ… UserRegistrationAction: Added email address Array
(
    [email] => debug.test@example.com
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 278727
                    [item_id] => 946527
                    [item_type] => Constituent
                    [address] => debug.test@example.com
                    [email_address_type_id] => 1
                    [email_type_name] => Home
                    [is_preferred] => 1
                    [not_current] => 
                    [parent_id] => 
                    [created_at] => 2025-10-06T13:31:27Z
                    [updated_at] => 2025-10-06T13:31:27Z
                )

            [raw_response] => {"api_version":"1.0","id":278727,"item_id":946527,"item_type":"Constituent","address":"debug.test@example.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2025-10-06T13:31:27Z","updated_at":"2025-10-06T13:31:27Z"}
        )

)

[2025-10-06 09:31:27] [debug] âœ… UserRegistrationAction: Added phone number Array
(
    [phone] => 555-DEBUG
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 481812
                    [item_id] => 946527
                    [item_type] => Constituent
                    [number] => 555-DEBUG
                    [phone_number_type_id] => 1
                    [phone_type_name] => Home
                    [is_preferred] => 1
                    [not_current] => 
                    [parent_id] => 
                    [normalized_number] => 555
                    [created_at] => 2025-10-06T13:31:27Z
                    [updated_at] => 2025-10-06T13:31:27Z
                )

            [raw_response] => {"api_version":"1.0","id":481812,"item_id":946527,"item_type":"Constituent","number":"555-DEBUG","phone_number_type_id":1,"phone_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"555","created_at":"2025-10-06T13:31:27Z","updated_at":"2025-10-06T13:31:27Z"}
        )

)

[2025-10-06 09:31:27] [debug] âœ… UserRegistrationAction: Added membership Array
(
    [membership_type] => Individual Membership
    [response] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank; Start date must be present and valid (YYYY-MM-DD)"}
            [http_code] => 422
            [data] => 
        )

)

[2025-10-06 09:31:27] [debug] ðŸ’³ Connection::addMembershipPayment() STARTED Array
(
    [lgl_id] => 946527
    [payment_type] => online
)

[2025-10-06 09:31:27] [debug] ðŸ’³ Connection::addMembershipPayment() - Payment data Array
(
    [constituent_id] => 946527
    [amount] => 0
    [date] => 2025-10-06
    [payment_method] => Credit Card
    [notes] => Membership payment via WordPress LGL Integration
    [fund_name] => Membership Dues
)

[2025-10-06 09:31:28] [debug] âŒ Connection::addMembershipPayment() - Failed to create payment Array
(
    [response] => Array
        (
            [success] => 
            [error] => HTTP 404: {"status":404,"error":"Not Found"}
            [http_code] => 404
            [data] => 
        )

)

[2025-10-06 09:31:28] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1869
    [lgl_id] => 
)

[2025-10-06 09:31:28] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1869
    [success] => Registration call completed
)

[2025-10-06 09:31:28] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1869
    [lgl_api_called] => YES
)

[2025-10-06 09:31:28] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:31:28] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88000
    [user_id] => 1869
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:31:28] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:31:28] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:31:28] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88000
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:31:55] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88001
    [timestamp] => 2025-10-06 09:31:55
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:31:55] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88001
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1870
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:31:55
    [item_count] => 0
)

[2025-10-06 09:31:55] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1870
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:31:55] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1870
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:31:55] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:31:55] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:31:55] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1870
    [order_id] => 88001
)

[2025-10-06 09:31:55] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:31:55] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88001
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:31:55] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:31:55] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88001
    [product_id] => 67487
)

[2025-10-06 09:31:55] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:31:56] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88001
    [timestamp] => 2025-10-06 09:31:56
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:31:56] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88001
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1870
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:31:55
    [item_count] => 1
)

[2025-10-06 09:31:56] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1870
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:31:56] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1870
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:31:56] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:31:56] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:31:56] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1870
    [order_id] => 88001
)

[2025-10-06 09:31:56] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:31:56] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:31:56] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:31:56] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1870
    [order_id] => 88001
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:31:56] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:31:56] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1870
    [order_id] => 88001
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:31:56
)

[2025-10-06 09:31:56] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:31:56] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:31:56] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:31:56] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:31:56] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:31:56] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:31:56] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:31:56] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1870
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:31:56] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1870
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:31:56] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1870
[2025-10-06 09:31:56] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:31:56] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:31:56] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:31:56] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757515
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88001
    [user_id] => 1870
)

[2025-10-06 09:31:56] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:31:56] [debug] MembershipOrderHandler: User data updated 1870
[2025-10-06 09:31:56] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:31:56] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1870
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88001
)

[2025-10-06 09:31:56] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:31:56] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:31:56] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757515
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88001
    [user_id] => 1870
)

[2025-10-06 09:31:56] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:31:56
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:31:56] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1870
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88001
)

[2025-10-06 09:31:56] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1870
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:31:56] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:31:56] [debug] Payment method set:  online
[2025-10-06 09:31:56] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:31:56] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:31:56] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:31:56] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:31:57] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:31:57] [debug] âœ… Found 9 constituents with method 1
[2025-10-06 09:31:57] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => NULL
    [constituent_keys] => not array/object
    [has_id_property] => 
    [id_value] => not set
)

[2025-10-06 09:31:57] [debug] âŒ Email search found constituent but no ID Array
(
    [constituent_data] => 
)

[2025-10-06 09:32:25] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88002
    [timestamp] => 2025-10-06 09:32:25
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:32:25] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88002
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1870
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:32:25
    [item_count] => 0
)

[2025-10-06 09:32:25] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1870
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:32:25] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1870
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:32:25] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:32:25] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:32:25] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1870
    [order_id] => 88002
)

[2025-10-06 09:32:25] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:32:25] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88002
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:32:25] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:32:25] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88002
    [product_id] => 67487
)

[2025-10-06 09:32:25] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:32:26] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88002
    [timestamp] => 2025-10-06 09:32:26
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:32:26] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88002
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1870
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:32:25
    [item_count] => 1
)

[2025-10-06 09:32:26] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1870
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:32:26] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1870
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:32:26] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:32:26] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:32:26] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1870
    [order_id] => 88002
)

[2025-10-06 09:32:26] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:32:26] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:32:26] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:32:26] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1870
    [order_id] => 88002
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:32:26] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:32:26] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1870
    [order_id] => 88002
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:32:26
)

[2025-10-06 09:32:26] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:32:26] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:32:26] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:32:26] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:32:26] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:32:26] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:32:26] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:32:26] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1870
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:32:26] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1870
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:32:26] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1870
[2025-10-06 09:32:26] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:32:26] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:32:26] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:32:26] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757545
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88002
    [user_id] => 1870
)

[2025-10-06 09:32:26] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:32:26] [debug] MembershipOrderHandler: User data updated 1870
[2025-10-06 09:32:26] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:32:26] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1870
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88002
)

[2025-10-06 09:32:26] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:32:26] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:32:26] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757545
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88002
    [user_id] => 1870
)

[2025-10-06 09:32:26] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:32:26
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:32:26] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1870
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88002
)

[2025-10-06 09:32:26] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1870
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:32:26] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:32:26] [debug] Payment method set:  online
[2025-10-06 09:32:26] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:32:26] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:32:26] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:32:26] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:32:27] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:32:27] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:32:27] [debug] âš ï¸ Unknown response format in extractConstituentsFromResponse Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [full_data] => Array
        (
            [api_version] => 1.0
            [items_count] => 25
            [total_items] => 117
            [limit] => 25
            [offset] => 0
            [next_item] => 25
            [next_link] => https://api.littlegreenlight.com/api/v1/constituents?offset=25
            [item_type] => constituent
            [items] => Array
                (
                    [0] => Array
                        (
                            [id] => 944857
                            [external_constituent_id] => t00012
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Susan
                            [middle_name] => 
                            [last_name] => Alexander
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Citizen Kane
                            [job_title] => 
                            [addressee] => Mrs. Susan Alexander
                            [salutation] => Susan
                            [sort_name] => Alexander, Susan
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Mrs. Susan Alexander
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Susan
                            [alt_addressee] => Mrs. Susan Alexander
                            [honorary_name] => Mrs. Susan Alexander
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:44Z
                            [updated_at] => 2023-02-27T13:27:45Z
                        )

                    [1] => Array
                        (
                            [id] => 946387
                            [external_constituent_id] => 285
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Dave
                            [middle_name] => 
                            [last_name] => Anderson
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Dave Anderson
                            [salutation] => Dave
                            [sort_name] => Anderson, Dave
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Dave Anderson
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 
                            [alt_salutation] => Dave
                            [alt_addressee] => Dave Anderson
                            [honorary_name] => Dave Anderson
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-20T20:21:49Z
                            [updated_at] => 2023-11-20T20:27:48Z
                        )

                    [2] => Array
                        (
                            [id] => 946377
                            [external_constituent_id] => 283
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Luke
                            [middle_name] => 
                            [last_name] => Anderson
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Luke Anderson
                            [salutation] => Luke
                            [sort_name] => Anderson, Luke
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Luke Anderson
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-11-20
                            [alt_salutation] => Luke
                            [alt_addressee] => Luke Anderson
                            [honorary_name] => Luke Anderson
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-20T20:00:27Z
                            [updated_at] => 2023-11-20T20:00:28Z
                        )

                    [3] => Array
                        (
                            [id] => 946382
                            [external_constituent_id] => 284
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Luke
                            [middle_name] => 
                            [last_name] => Anderson
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Luke Anderson
                            [salutation] => Luke
                            [sort_name] => Anderson, Luke
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Luke Anderson
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-11-20
                            [alt_salutation] => Luke
                            [alt_addressee] => Luke Anderson
                            [honorary_name] => Luke Anderson
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-20T20:04:08Z
                            [updated_at] => 2023-11-20T20:04:09Z
                        )

                    [4] => Array
                        (
                            [id] => 946392
                            [external_constituent_id] => 285
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Luke
                            [middle_name] => 
                            [last_name] => Anderson
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Luke Anderson
                            [salutation] => Luke
                            [sort_name] => Anderson, Luke
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Luke Anderson
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 
                            [alt_salutation] => Luke
                            [alt_addressee] => Luke Anderson
                            [honorary_name] => Luke Anderson
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-20T20:32:09Z
                            [updated_at] => 2023-11-20T20:53:16Z
                        )

                    [5] => Array
                        (
                            [id] => 945017
                            [external_constituent_id] => t00044
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Larry
                            [middle_name] => 
                            [last_name] => Appleton
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Perfect Strangers
                            [job_title] => 
                            [addressee] => Larry Appleton and his cousin Balki Bartokomous
                            [salutation] => Larry
                            [sort_name] => Appleton, Larry
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Larry Appleton and his cousin Balki Bartokomous
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Larry
                            [alt_addressee] => Larry Appleton and his cousin Balki Bartokomous
                            [honorary_name] => Larry Appleton and his cousin Balki Bartokomous
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:28:29Z
                            [updated_at] => 2023-08-10T10:17:49Z
                        )

                    [6] => Array
                        (
                            [id] => 945047
                            [external_constituent_id] => t00050
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => 
                            [middle_name] => 
                            [last_name] => Archer's
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => series of novels
                            [job_title] => 
                            [addressee] => Lew Archer's office
                            [salutation] => Archer's
                            [sort_name] => Archer's
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Lew Archer's office
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Archer's
                            [alt_addressee] => Lew Archer's office
                            [honorary_name] => Lew Archer's office
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:20Z
                            [updated_at] => 2023-02-27T13:29:21Z
                        )

                    [7] => Array
                        (
                            [id] => 944817
                            [external_constituent_id] => t00004
                            [is_org] => 1
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => 
                            [middle_name] => 
                            [last_name] => Mansion
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Avengers Mansion Headquarters of the Avengers
                            [job_title] => 
                            [addressee] => Headquarters of the Avengers
                            [salutation] => 
                            [sort_name] => Avengers Mansion Headquarters of the Avengers
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => 
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => 
                            [alt_addressee] => Headquarters of the Avengers
                            [honorary_name] => 
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:33Z
                        )

                    [8] => Array
                        (
                            [id] => 944882
                            [external_constituent_id] => t00017
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Ray
                            [middle_name] => 
                            [last_name] => Barone
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Everybody Loves Raymond
                            [job_title] => 
                            [addressee] => Barone family
                            [salutation] => Ray
                            [sort_name] => Barone, Ray
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Barone family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Ray
                            [alt_addressee] => Barone family
                            [honorary_name] => Barone family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:49Z
                            [updated_at] => 2023-02-27T13:27:51Z
                        )

                    [9] => Array
                        (
                            [id] => 944942
                            [external_constituent_id] => t00029
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Joseph
                            [middle_name] => 
                            [last_name] => Baxter
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Hazel
                            [job_title] => 
                            [addressee] => Baxter family
                            [salutation] => Joe
                            [sort_name] => Baxter, Joseph
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Baxter family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Joe
                            [alt_addressee] => Baxter family
                            [honorary_name] => Baxter family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:28:06Z
                            [updated_at] => 2023-02-27T13:28:08Z
                        )

                    [10] => Array
                        (
                            [id] => 946412
                            [external_constituent_id] => 306
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Kaylen
                            [middle_name] => 
                            [last_name] => Beemer
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Kaylen Beemer
                            [salutation] => Kaylen
                            [sort_name] => Beemer, Kaylen
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Kaylen Beemer
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 
                            [alt_salutation] => Kaylen
                            [alt_addressee] => Kaylen Beemer
                            [honorary_name] => Kaylen Beemer
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-30T17:11:47Z
                            [updated_at] => 2023-11-30T17:12:47Z
                        )

                    [11] => Array
                        (
                            [id] => 944987
                            [external_constituent_id] => t00038
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Frank
                            [middle_name] => 
                            [last_name] => Black
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Millennium
                            [job_title] => 
                            [addressee] => Mr. Frank Black and Family
                            [salutation] => Frank
                            [sort_name] => Black, Frank
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Mr. Frank Black and Family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Frank
                            [alt_addressee] => Mr. Frank Black and Family
                            [honorary_name] => Mr. Frank Black and Family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:28:19Z
                            [updated_at] => 2023-02-27T13:28:21Z
                        )

                    [12] => Array
                        (
                            [id] => 945057
                            [external_constituent_id] => t00052
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Elwood
                            [middle_name] => 
                            [last_name] => Blues
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => The Blues Brothers
                            [job_title] => 
                            [addressee] => Elwood Blues
                            [salutation] => Elwood
                            [sort_name] => Blues, Elwood
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Elwood Blues
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Elwood
                            [alt_addressee] => Elwood Blues
                            [honorary_name] => Elwood Blues
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:23Z
                            [updated_at] => 2023-02-27T13:29:24Z
                        )

                    [13] => Array
                        (
                            [id] => 945142
                            [external_constituent_id] => t00069
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => John
                            [middle_name] => 
                            [last_name] => Bower
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Who's the Boss?
                            [job_title] => 
                            [addressee] => Bower family
                            [salutation] => Jack
                            [sort_name] => Bower, John
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Bower family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Jack
                            [alt_addressee] => Bower family
                            [honorary_name] => Bower family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:49Z
                            [updated_at] => 2023-02-27T13:29:50Z
                        )

                    [14] => Array
                        (
                            [id] => 945157
                            [external_constituent_id] => t00072
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Mike
                            [middle_name] => 
                            [last_name] => Brady
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Mr. and Mrs. Mike Brady
                            [salutation] => Mike and Carol
                            [sort_name] => Brady, Mike
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Mr. and Mrs. Mike Brady
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Mike and Carol
                            [alt_addressee] => Mr. and Mrs. Mike Brady
                            [honorary_name] => Mr. and Mrs. Mike Brady
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:53Z
                            [updated_at] => 2023-02-27T13:29:54Z
                        )

                    [15] => Array
                        (
                            [id] => 944822
                            [external_constituent_id] => t00005
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Emmett
                            [middle_name] => 
                            [last_name] => Brown
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Back to the Future
                            [job_title] => 
                            [addressee] => Emmett Brown
                            [salutation] => Emmett
                            [sort_name] => Brown, Emmett
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Emmett Brown
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Emmett
                            [alt_addressee] => Emmett Brown
                            [honorary_name] => Emmett Brown
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:33Z
                            [updated_at] => 2023-02-27T13:27:35Z
                        )

                    [16] => Array
                        (
                            [id] => 944897
                            [external_constituent_id] => t00020
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Ferris
                            [middle_name] => 
                            [last_name] => Bueller
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Ferris Bueller's Day Off
                            [job_title] => 
                            [addressee] => Bueller family
                            [salutation] => Ferris
                            [sort_name] => Bueller, Ferris
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Bueller family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Ferris
                            [alt_addressee] => Bueller family
                            [honorary_name] => Bueller family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:54Z
                            [updated_at] => 2023-02-27T13:27:55Z
                        )

                    [17] => Array
                        (
                            [id] => 946432
                            [external_constituent_id] => 311
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Chloe
                            [middle_name] => 
                            [last_name] => Buffalino
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Chloe Buffalino
                            [salutation] => Chloe
                            [sort_name] => Buffalino, Chloe
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Chloe Buffalino
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 
                            [alt_salutation] => Chloe
                            [alt_addressee] => Chloe Buffalino
                            [honorary_name] => Chloe Buffalino
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-12-02T17:42:42Z
                            [updated_at] => 2023-12-02T17:44:13Z
                        )

                    [18] => Array
                        (
                            [id] => 944912
                            [external_constituent_id] => t00023
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Phoebe
                            [middle_name] => 
                            [last_name] => Buffay
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Friends
                            [job_title] => 
                            [addressee] => Phoebe Buffay
                            [salutation] => Phoebe
                            [sort_name] => Buffay, Phoebe
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Phoebe Buffay
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Phoebe
                            [alt_addressee] => Phoebe Buffay
                            [honorary_name] => Phoebe Buffay
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:58Z
                            [updated_at] => 2023-02-27T13:27:59Z
                        )

                    [19] => Array
                        (
                            [id] => 944982
                            [external_constituent_id] => t00037
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Al
                            [middle_name] => 
                            [last_name] => Bundy
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Married... with Children
                            [job_title] => 
                            [addressee] => Bundy family
                            [salutation] => Al
                            [sort_name] => Bundy, Al
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Bundy family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Al
                            [alt_addressee] => Bundy family
                            [honorary_name] => Bundy family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:28:18Z
                            [updated_at] => 2023-02-27T13:28:19Z
                        )

                    [20] => Array
                        (
                            [id] => 944812
                            [external_constituent_id] => t00003
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Archie
                            [middle_name] => 
                            [last_name] => Bunker
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => All in the Family
                            [job_title] => 
                            [addressee] => Bunker family
                            [salutation] => Archie
                            [sort_name] => Bunker, Archie
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Bunker family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Archie
                            [alt_addressee] => Bunker family
                            [honorary_name] => Bunker family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:31Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                    [21] => Array
                        (
                            [id] => 945067
                            [external_constituent_id] => t00054
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Drew
                            [middle_name] => 
                            [last_name] => Carey
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => The Drew Carey Show
                            [job_title] => 
                            [addressee] => Carey, Drew
                            [salutation] => Drew
                            [sort_name] => Carey, Drew
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Carey, Drew
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Drew
                            [alt_addressee] => Carey, Drew
                            [honorary_name] => Carey, Drew
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:26Z
                            [updated_at] => 2023-02-27T13:29:28Z
                        )

                    [22] => Array
                        (
                            [id] => 944877
                            [external_constituent_id] => t00016
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Blake
                            [middle_name] => 
                            [last_name] => Carrington
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Dynasty
                            [job_title] => 
                            [addressee] => Blake Carrington
                            [salutation] => Blake
                            [sort_name] => Carrington, Blake
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Blake Carrington
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Blake
                            [alt_addressee] => Blake Carrington
                            [honorary_name] => Blake Carrington
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:49Z
                            [updated_at] => 2023-02-27T13:27:49Z
                        )

                    [23] => Array
                        (
                            [id] => 945182
                            [external_constituent_id] => t00077
                            [is_org] => 1
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => 
                            [middle_name] => 
                            [last_name] => Cheers
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Cheers
                            [job_title] => 
                            [addressee] => Cheers
                            [salutation] => Cheers
                            [sort_name] => Cheers
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Cheers
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Cheers
                            [alt_addressee] => Cheers
                            [honorary_name] => Cheers
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:30:00Z
                            [updated_at] => 2023-02-27T13:30:02Z
                        )

                    [24] => Array
                        (
                            [id] => 944832
                            [external_constituent_id] => t00007
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Jed
                            [middle_name] => 
                            [last_name] => Clampett
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Beverly Hillbillies
                            [job_title] => 
                            [addressee] => Clampett family
                            [salutation] => Jed
                            [sort_name] => Clampett, Jed
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Clampett family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Jed
                            [alt_addressee] => Clampett family
                            [honorary_name] => Clampett family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:37Z
                            [updated_at] => 2023-02-27T13:27:38Z
                        )

                )

        )

)

[2025-10-06 09:32:27] [debug] ðŸ” Trying search method 2 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [search] => Debug Test
        )

)

[2025-10-06 09:32:27] [debug] ðŸ” Search method 2 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:32:27] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:32:27] [debug] âš ï¸ Unknown response format in extractConstituentsFromResponse Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [full_data] => Array
        (
            [api_version] => 1.0
            [items_count] => 25
            [total_items] => 117
            [limit] => 25
            [offset] => 0
            [next_item] => 25
            [next_link] => https://api.littlegreenlight.com/api/v1/constituents?offset=25
            [item_type] => constituent
            [items] => Array
                (
                    [0] => Array
                        (
                            [id] => 944857
                            [external_constituent_id] => t00012
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Susan
                            [middle_name] => 
                            [last_name] => Alexander
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Citizen Kane
                            [job_title] => 
                            [addressee] => Mrs. Susan Alexander
                            [salutation] => Susan
                            [sort_name] => Alexander, Susan
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Mrs. Susan Alexander
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Susan
                            [alt_addressee] => Mrs. Susan Alexander
                            [honorary_name] => Mrs. Susan Alexander
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:44Z
                            [updated_at] => 2023-02-27T13:27:45Z
                        )

                    [1] => Array
                        (
                            [id] => 946387
                            [external_constituent_id] => 285
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Dave
                            [middle_name] => 
                            [last_name] => Anderson
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Dave Anderson
                            [salutation] => Dave
                            [sort_name] => Anderson, Dave
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Dave Anderson
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 
                            [alt_salutation] => Dave
                            [alt_addressee] => Dave Anderson
                            [honorary_name] => Dave Anderson
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-20T20:21:49Z
                            [updated_at] => 2023-11-20T20:27:48Z
                        )

                    [2] => Array
                        (
                            [id] => 946377
                            [external_constituent_id] => 283
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Luke
                            [middle_name] => 
                            [last_name] => Anderson
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Luke Anderson
                            [salutation] => Luke
                            [sort_name] => Anderson, Luke
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Luke Anderson
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-11-20
                            [alt_salutation] => Luke
                            [alt_addressee] => Luke Anderson
                            [honorary_name] => Luke Anderson
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-20T20:00:27Z
                            [updated_at] => 2023-11-20T20:00:28Z
                        )

                    [3] => Array
                        (
                            [id] => 946382
                            [external_constituent_id] => 284
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Luke
                            [middle_name] => 
                            [last_name] => Anderson
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Luke Anderson
                            [salutation] => Luke
                            [sort_name] => Anderson, Luke
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Luke Anderson
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-11-20
                            [alt_salutation] => Luke
                            [alt_addressee] => Luke Anderson
                            [honorary_name] => Luke Anderson
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-20T20:04:08Z
                            [updated_at] => 2023-11-20T20:04:09Z
                        )

                    [4] => Array
                        (
                            [id] => 946392
                            [external_constituent_id] => 285
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Luke
                            [middle_name] => 
                            [last_name] => Anderson
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Luke Anderson
                            [salutation] => Luke
                            [sort_name] => Anderson, Luke
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Luke Anderson
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 
                            [alt_salutation] => Luke
                            [alt_addressee] => Luke Anderson
                            [honorary_name] => Luke Anderson
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-20T20:32:09Z
                            [updated_at] => 2023-11-20T20:53:16Z
                        )

                    [5] => Array
                        (
                            [id] => 945017
                            [external_constituent_id] => t00044
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Larry
                            [middle_name] => 
                            [last_name] => Appleton
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Perfect Strangers
                            [job_title] => 
                            [addressee] => Larry Appleton and his cousin Balki Bartokomous
                            [salutation] => Larry
                            [sort_name] => Appleton, Larry
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Larry Appleton and his cousin Balki Bartokomous
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Larry
                            [alt_addressee] => Larry Appleton and his cousin Balki Bartokomous
                            [honorary_name] => Larry Appleton and his cousin Balki Bartokomous
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:28:29Z
                            [updated_at] => 2023-08-10T10:17:49Z
                        )

                    [6] => Array
                        (
                            [id] => 945047
                            [external_constituent_id] => t00050
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => 
                            [middle_name] => 
                            [last_name] => Archer's
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => series of novels
                            [job_title] => 
                            [addressee] => Lew Archer's office
                            [salutation] => Archer's
                            [sort_name] => Archer's
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Lew Archer's office
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Archer's
                            [alt_addressee] => Lew Archer's office
                            [honorary_name] => Lew Archer's office
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:20Z
                            [updated_at] => 2023-02-27T13:29:21Z
                        )

                    [7] => Array
                        (
                            [id] => 944817
                            [external_constituent_id] => t00004
                            [is_org] => 1
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => 
                            [middle_name] => 
                            [last_name] => Mansion
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Avengers Mansion Headquarters of the Avengers
                            [job_title] => 
                            [addressee] => Headquarters of the Avengers
                            [salutation] => 
                            [sort_name] => Avengers Mansion Headquarters of the Avengers
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => 
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => 
                            [alt_addressee] => Headquarters of the Avengers
                            [honorary_name] => 
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:33Z
                        )

                    [8] => Array
                        (
                            [id] => 944882
                            [external_constituent_id] => t00017
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Ray
                            [middle_name] => 
                            [last_name] => Barone
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Everybody Loves Raymond
                            [job_title] => 
                            [addressee] => Barone family
                            [salutation] => Ray
                            [sort_name] => Barone, Ray
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Barone family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Ray
                            [alt_addressee] => Barone family
                            [honorary_name] => Barone family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:49Z
                            [updated_at] => 2023-02-27T13:27:51Z
                        )

                    [9] => Array
                        (
                            [id] => 944942
                            [external_constituent_id] => t00029
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Joseph
                            [middle_name] => 
                            [last_name] => Baxter
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Hazel
                            [job_title] => 
                            [addressee] => Baxter family
                            [salutation] => Joe
                            [sort_name] => Baxter, Joseph
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Baxter family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Joe
                            [alt_addressee] => Baxter family
                            [honorary_name] => Baxter family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:28:06Z
                            [updated_at] => 2023-02-27T13:28:08Z
                        )

                    [10] => Array
                        (
                            [id] => 946412
                            [external_constituent_id] => 306
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Kaylen
                            [middle_name] => 
                            [last_name] => Beemer
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Kaylen Beemer
                            [salutation] => Kaylen
                            [sort_name] => Beemer, Kaylen
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Kaylen Beemer
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 
                            [alt_salutation] => Kaylen
                            [alt_addressee] => Kaylen Beemer
                            [honorary_name] => Kaylen Beemer
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-11-30T17:11:47Z
                            [updated_at] => 2023-11-30T17:12:47Z
                        )

                    [11] => Array
                        (
                            [id] => 944987
                            [external_constituent_id] => t00038
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Frank
                            [middle_name] => 
                            [last_name] => Black
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Millennium
                            [job_title] => 
                            [addressee] => Mr. Frank Black and Family
                            [salutation] => Frank
                            [sort_name] => Black, Frank
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Mr. Frank Black and Family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Frank
                            [alt_addressee] => Mr. Frank Black and Family
                            [honorary_name] => Mr. Frank Black and Family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:28:19Z
                            [updated_at] => 2023-02-27T13:28:21Z
                        )

                    [12] => Array
                        (
                            [id] => 945057
                            [external_constituent_id] => t00052
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Elwood
                            [middle_name] => 
                            [last_name] => Blues
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => The Blues Brothers
                            [job_title] => 
                            [addressee] => Elwood Blues
                            [salutation] => Elwood
                            [sort_name] => Blues, Elwood
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Elwood Blues
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Elwood
                            [alt_addressee] => Elwood Blues
                            [honorary_name] => Elwood Blues
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:23Z
                            [updated_at] => 2023-02-27T13:29:24Z
                        )

                    [13] => Array
                        (
                            [id] => 945142
                            [external_constituent_id] => t00069
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => John
                            [middle_name] => 
                            [last_name] => Bower
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Who's the Boss?
                            [job_title] => 
                            [addressee] => Bower family
                            [salutation] => Jack
                            [sort_name] => Bower, John
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Bower family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Jack
                            [alt_addressee] => Bower family
                            [honorary_name] => Bower family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:49Z
                            [updated_at] => 2023-02-27T13:29:50Z
                        )

                    [14] => Array
                        (
                            [id] => 945157
                            [external_constituent_id] => t00072
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Mike
                            [middle_name] => 
                            [last_name] => Brady
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Mr. and Mrs. Mike Brady
                            [salutation] => Mike and Carol
                            [sort_name] => Brady, Mike
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Mr. and Mrs. Mike Brady
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Mike and Carol
                            [alt_addressee] => Mr. and Mrs. Mike Brady
                            [honorary_name] => Mr. and Mrs. Mike Brady
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:53Z
                            [updated_at] => 2023-02-27T13:29:54Z
                        )

                    [15] => Array
                        (
                            [id] => 944822
                            [external_constituent_id] => t00005
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Emmett
                            [middle_name] => 
                            [last_name] => Brown
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Back to the Future
                            [job_title] => 
                            [addressee] => Emmett Brown
                            [salutation] => Emmett
                            [sort_name] => Brown, Emmett
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Emmett Brown
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Emmett
                            [alt_addressee] => Emmett Brown
                            [honorary_name] => Emmett Brown
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:33Z
                            [updated_at] => 2023-02-27T13:27:35Z
                        )

                    [16] => Array
                        (
                            [id] => 944897
                            [external_constituent_id] => t00020
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Ferris
                            [middle_name] => 
                            [last_name] => Bueller
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Ferris Bueller's Day Off
                            [job_title] => 
                            [addressee] => Bueller family
                            [salutation] => Ferris
                            [sort_name] => Bueller, Ferris
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Bueller family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Ferris
                            [alt_addressee] => Bueller family
                            [honorary_name] => Bueller family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:54Z
                            [updated_at] => 2023-02-27T13:27:55Z
                        )

                    [17] => Array
                        (
                            [id] => 946432
                            [external_constituent_id] => 311
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Chloe
                            [middle_name] => 
                            [last_name] => Buffalino
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => 
                            [job_title] => 
                            [addressee] => Chloe Buffalino
                            [salutation] => Chloe
                            [sort_name] => Buffalino, Chloe
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Chloe Buffalino
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 
                            [alt_salutation] => Chloe
                            [alt_addressee] => Chloe Buffalino
                            [honorary_name] => Chloe Buffalino
                            [assistant_name] => 
                            [marital_status_id] => 0
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-12-02T17:42:42Z
                            [updated_at] => 2023-12-02T17:44:13Z
                        )

                    [18] => Array
                        (
                            [id] => 944912
                            [external_constituent_id] => t00023
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Phoebe
                            [middle_name] => 
                            [last_name] => Buffay
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Friends
                            [job_title] => 
                            [addressee] => Phoebe Buffay
                            [salutation] => Phoebe
                            [sort_name] => Buffay, Phoebe
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Phoebe Buffay
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Phoebe
                            [alt_addressee] => Phoebe Buffay
                            [honorary_name] => Phoebe Buffay
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:58Z
                            [updated_at] => 2023-02-27T13:27:59Z
                        )

                    [19] => Array
                        (
                            [id] => 944982
                            [external_constituent_id] => t00037
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Al
                            [middle_name] => 
                            [last_name] => Bundy
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Married... with Children
                            [job_title] => 
                            [addressee] => Bundy family
                            [salutation] => Al
                            [sort_name] => Bundy, Al
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Bundy family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Al
                            [alt_addressee] => Bundy family
                            [honorary_name] => Bundy family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:28:18Z
                            [updated_at] => 2023-02-27T13:28:19Z
                        )

                    [20] => Array
                        (
                            [id] => 944812
                            [external_constituent_id] => t00003
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Archie
                            [middle_name] => 
                            [last_name] => Bunker
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => All in the Family
                            [job_title] => 
                            [addressee] => Bunker family
                            [salutation] => Archie
                            [sort_name] => Bunker, Archie
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Bunker family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Archie
                            [alt_addressee] => Bunker family
                            [honorary_name] => Bunker family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:31Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                    [21] => Array
                        (
                            [id] => 945067
                            [external_constituent_id] => t00054
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Drew
                            [middle_name] => 
                            [last_name] => Carey
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => The Drew Carey Show
                            [job_title] => 
                            [addressee] => Carey, Drew
                            [salutation] => Drew
                            [sort_name] => Carey, Drew
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Carey, Drew
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Drew
                            [alt_addressee] => Carey, Drew
                            [honorary_name] => Carey, Drew
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:29:26Z
                            [updated_at] => 2023-02-27T13:29:28Z
                        )

                    [22] => Array
                        (
                            [id] => 944877
                            [external_constituent_id] => t00016
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Blake
                            [middle_name] => 
                            [last_name] => Carrington
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Dynasty
                            [job_title] => 
                            [addressee] => Blake Carrington
                            [salutation] => Blake
                            [sort_name] => Carrington, Blake
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Blake Carrington
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Blake
                            [alt_addressee] => Blake Carrington
                            [honorary_name] => Blake Carrington
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:49Z
                            [updated_at] => 2023-02-27T13:27:49Z
                        )

                    [23] => Array
                        (
                            [id] => 945182
                            [external_constituent_id] => t00077
                            [is_org] => 1
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => 
                            [middle_name] => 
                            [last_name] => Cheers
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Cheers
                            [job_title] => 
                            [addressee] => Cheers
                            [salutation] => Cheers
                            [sort_name] => Cheers
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Cheers
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Cheers
                            [alt_addressee] => Cheers
                            [honorary_name] => Cheers
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:30:00Z
                            [updated_at] => 2023-02-27T13:30:02Z
                        )

                    [24] => Array
                        (
                            [id] => 944832
                            [external_constituent_id] => t00007
                            [is_org] => 
                            [constituent_contact_type_id] => 1247
                            [constituent_contact_type_name] => Primary
                            [prefix] => 
                            [first_name] => Jed
                            [middle_name] => 
                            [last_name] => Clampett
                            [suffix] => 
                            [spouse_name] => 
                            [org_name] => Beverly Hillbillies
                            [job_title] => 
                            [addressee] => Clampett family
                            [salutation] => Jed
                            [sort_name] => Clampett, Jed
                            [constituent_interest_level_id] => 
                            [constituent_interest_level_name] => 
                            [constituent_rating_id] => 
                            [constituent_rating_name] => 
                            [is_deceased] => 
                            [deceased_date] => 
                            [annual_report_name] => Clampett family
                            [birthday] => 
                            [gender] => 
                            [maiden_name] => 
                            [nick_name] => 
                            [spouse_nick_name] => 
                            [date_added] => 2023-02-27
                            [alt_salutation] => Jed
                            [alt_addressee] => Clampett family
                            [honorary_name] => Clampett family
                            [assistant_name] => 
                            [marital_status_id] => 
                            [marital_status_name] => 
                            [is_anon] => 
                            [created_at] => 2023-02-27T13:27:37Z
                            [updated_at] => 2023-02-27T13:27:38Z
                        )

                )

        )

)

[2025-10-06 09:32:27] [debug] ðŸ” Trying search method 3 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [q] => Debug Test
        )

)

[2025-10-06 09:32:27] [debug] ðŸ” Search method 3 response Array
(
    [success] => 
    [http_code] => 400
    [has_data] => 
    [data_type] => none
)

[2025-10-06 09:32:27] [debug] âŒ No matching constituent found with any search method
[2025-10-06 09:32:27] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 
    [found_existing] => NO
)

[2025-10-06 09:32:27] [debug] âž• UserRegistrationAction: Creating new LGL constituent...
[2025-10-06 09:32:27] [debug] âž• UserRegistrationAction::createNewConstituent() STARTED Array
(
    [user_id] => 1870
    [membership_level] => Individual Membership
    [is_family_member] => NO
)

[2025-10-06 09:32:27] [debug] ðŸ‘¤ UserRegistrationAction: Extracted user data Array
(
    [first_name] => Debug
    [last_name] => Test
    [email] => debug.test@example.com
)

[2025-10-06 09:32:27] [debug] ðŸ“‹ UserRegistrationAction: Built constituent data Array
(
    [external_constituent_id] => 1870
    [first_name] => Debug
    [last_name] => Test
    [constituent_contact_type_id] => 1247
    [constituent_contact_type_name] => Primary
    [addressee] => Debug Test
    [salutation] => Debug
    [annual_report_name] => Debug Test
    [org_name] => 
    [date_added] => 2025-10-06
)

[2025-10-06 09:32:28] [debug] âœ… UserRegistrationAction: Created new constituent Array
(
    [lgl_id] => 946537
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 946537
                    [external_constituent_id] => 1870
                    [is_org] => 
                    [constituent_contact_type_id] => 1247
                    [constituent_contact_type_name] => Primary
                    [prefix] => 
                    [first_name] => Debug
                    [middle_name] => 
                    [last_name] => Test
                    [suffix] => 
                    [spouse_name] => 
                    [org_name] => 
                    [job_title] => 
                    [addressee] => Debug Test
                    [salutation] => Debug
                    [sort_name] => Test, Debug
                    [constituent_interest_level_id] => 
                    [constituent_interest_level_name] => 
                    [constituent_rating_id] => 
                    [constituent_rating_name] => 
                    [is_deceased] => 
                    [deceased_date] => 
                    [annual_report_name] => Debug Test
                    [birthday] => 
                    [gender] => 
                    [maiden_name] => 
                    [nick_name] => 
                    [spouse_nick_name] => 
                    [date_added] => 2025-10-06
                    [alt_salutation] => Debug
                    [alt_addressee] => Debug Test
                    [honorary_name] => Debug Test
                    [assistant_name] => 
                    [marital_status_id] => 
                    [marital_status_name] => 
                    [is_anon] => 
                    [created_at] => 2025-10-06T13:32:28Z
                    [updated_at] => 2025-10-06T13:32:28Z
                    [class_affiliations] => Array
                        (
                        )

                    [relationships] => Array
                        (
                        )

                    [street_addresses] => Array
                        (
                        )

                    [phone_numbers] => Array
                        (
                        )

                    [email_addresses] => Array
                        (
                        )

                    [web_addresses] => Array
                        (
                        )

                    [categories] => Array
                        (
                        )

                    [groups] => Array
                        (
                        )

                    [memberships] => Array
                        (
                        )

                    [custom_attrs] => Array
                        (
                        )

                )

            [raw_response] => {"api_version":"1.0","id":946537,"external_constituent_id":"1870","is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"","job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":null,"maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-06","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-06T13:32:28Z","updated_at":"2025-10-06T13:32:28Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
        )

)

[2025-10-06 09:32:28] [debug] ðŸ“ UserRegistrationAction::addConstituentExtras() STARTED Array
(
    [lgl_id] => 946537
    [user_id] => 1870
    [is_family_member] => NO
)

[2025-10-06 09:32:28] [debug] âœ… UserRegistrationAction: Added email address Array
(
    [email] => debug.test@example.com
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 278732
                    [item_id] => 946537
                    [item_type] => Constituent
                    [address] => debug.test@example.com
                    [email_address_type_id] => 1
                    [email_type_name] => Home
                    [is_preferred] => 1
                    [not_current] => 
                    [parent_id] => 
                    [created_at] => 2025-10-06T13:32:28Z
                    [updated_at] => 2025-10-06T13:32:28Z
                )

            [raw_response] => {"api_version":"1.0","id":278732,"item_id":946537,"item_type":"Constituent","address":"debug.test@example.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2025-10-06T13:32:28Z","updated_at":"2025-10-06T13:32:28Z"}
        )

)

[2025-10-06 09:32:29] [debug] âœ… UserRegistrationAction: Added phone number Array
(
    [phone] => 555-DEBUG
    [response] => Array
        (
            [success] => 1
            [http_code] => 200
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 481817
                    [item_id] => 946537
                    [item_type] => Constituent
                    [number] => 555-DEBUG
                    [phone_number_type_id] => 1
                    [phone_type_name] => Home
                    [is_preferred] => 1
                    [not_current] => 
                    [parent_id] => 
                    [normalized_number] => 555
                    [created_at] => 2025-10-06T13:32:29Z
                    [updated_at] => 2025-10-06T13:32:29Z
                )

            [raw_response] => {"api_version":"1.0","id":481817,"item_id":946537,"item_type":"Constituent","number":"555-DEBUG","phone_number_type_id":1,"phone_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"555","created_at":"2025-10-06T13:32:29Z","updated_at":"2025-10-06T13:32:29Z"}
        )

)

[2025-10-06 09:32:29] [debug] âœ… UserRegistrationAction: Added membership Array
(
    [membership_type] => Individual Membership
    [response] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank; Start date must be present and valid (YYYY-MM-DD)"}
            [http_code] => 422
            [data] => 
        )

)

[2025-10-06 09:32:29] [debug] ðŸ’³ Connection::addMembershipPayment() STARTED Array
(
    [lgl_id] => 946537
    [payment_type] => online
)

[2025-10-06 09:32:29] [debug] ðŸ’³ Connection::addMembershipPayment() - Payment data Array
(
    [constituent_id] => 946537
    [amount] => 0
    [date] => 2025-10-06
    [payment_method] => Credit Card
    [notes] => Membership payment via WordPress LGL Integration
    [fund_name] => Membership Dues
)

[2025-10-06 09:32:30] [debug] âŒ Connection::addMembershipPayment() - Failed to create payment Array
(
    [response] => Array
        (
            [success] => 
            [error] => HTTP 404: {"status":404,"error":"Not Found"}
            [http_code] => 404
            [data] => 
        )

)

[2025-10-06 09:32:30] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1870
    [lgl_id] => 
)

[2025-10-06 09:32:30] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1870
    [success] => Registration call completed
)

[2025-10-06 09:32:30] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1870
    [lgl_api_called] => YES
)

[2025-10-06 09:32:30] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:32:30] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88002
    [user_id] => 1870
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:32:30] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:32:30] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:32:30] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88002
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:33:25] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88003
    [timestamp] => 2025-10-06 09:33:25
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:33:25] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88003
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1871
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:33:25
    [item_count] => 0
)

[2025-10-06 09:33:25] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1871
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:33:25] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1871
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:33:25] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:33:25] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:33:25] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1871
    [order_id] => 88003
)

[2025-10-06 09:33:25] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:33:25] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88003
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:33:25] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:33:25] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88003
    [product_id] => 67487
)

[2025-10-06 09:33:25] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:33:25] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88003
    [timestamp] => 2025-10-06 09:33:25
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:33:25] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88003
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1871
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:33:25
    [item_count] => 1
)

[2025-10-06 09:33:25] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1871
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:33:25] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1871
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:33:25] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:33:25] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:33:25] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1871
    [order_id] => 88003
)

[2025-10-06 09:33:25] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:33:25] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:33:25] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:33:25] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1871
    [order_id] => 88003
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:33:25] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:33:25] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1871
    [order_id] => 88003
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:33:25
)

[2025-10-06 09:33:25] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:33:25] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:33:25] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:33:25] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:33:25] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:33:25] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:33:25] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:33:25] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1871
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:33:25] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1871
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:33:25] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1871
[2025-10-06 09:33:25] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:33:25] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:33:25] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:33:25] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757605
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88003
    [user_id] => 1871
)

[2025-10-06 09:33:25] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:33:26] [debug] MembershipOrderHandler: User data updated 1871
[2025-10-06 09:33:26] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:33:26] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1871
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88003
)

[2025-10-06 09:33:26] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:33:26] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:33:26] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757605
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88003
    [user_id] => 1871
)

[2025-10-06 09:33:26] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:33:26
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:33:26] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1871
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88003
)

[2025-10-06 09:33:26] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1871
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:33:26] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:33:26] [debug] Payment method set:  online
[2025-10-06 09:33:26] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:33:26] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:33:26] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:33:26] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:33:27] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:33:27] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:33:27] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:33:27] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:33:27] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:33:27] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:33:27] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:33:27] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:33:27] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:33:27] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1871
    [lgl_id] => 944857
)

[2025-10-06 09:33:27] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1871
    [success] => Registration call completed
)

[2025-10-06 09:33:27] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1871
    [lgl_api_called] => YES
)

[2025-10-06 09:33:27] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:33:27] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88003
    [user_id] => 1871
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:33:27] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:33:27] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:33:27] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88003
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:34:00] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:34:01] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-06 09:34:01] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-06 09:34:01] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:34:01] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:34:01] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:34:01] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:34:01] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:34:01] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:34:01] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88004
    [timestamp] => 2025-10-06 09:34:01
    [memory_usage] => 118MB
)

[2025-10-06 09:34:01] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88004
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1872
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:34:01
    [item_count] => 0
)

[2025-10-06 09:34:01] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1872
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:34:01] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1872
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:34:01] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:34:01] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:34:01] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1872
    [order_id] => 88004
)

[2025-10-06 09:34:01] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:34:01] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88004
    [final_memory_usage] => 118MB
)

[2025-10-06 09:34:02] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:34:02] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88004
    [product_id] => 67487
)

[2025-10-06 09:34:02] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:34:02] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88004
    [timestamp] => 2025-10-06 09:34:02
    [memory_usage] => 122MB
)

[2025-10-06 09:34:02] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88004
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1872
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:34:01
    [item_count] => 1
)

[2025-10-06 09:34:02] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1872
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:34:02] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1872
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:34:02] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:34:02] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:34:02] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1872
    [order_id] => 88004
)

[2025-10-06 09:34:02] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:34:02] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:34:02] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:34:02] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1872
    [order_id] => 88004
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:34:02] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:34:02] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1872
    [order_id] => 88004
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:34:02
)

[2025-10-06 09:34:02] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:34:02] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:34:02] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:34:02] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:34:02] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:34:02] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:34:02] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:34:02] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1872
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:34:02] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1872
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:34:02] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1872
[2025-10-06 09:34:02] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:34:02] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:34:02] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:34:02] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757641
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88004
    [user_id] => 1872
)

[2025-10-06 09:34:02] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:34:02] [debug] MembershipOrderHandler: User data updated 1872
[2025-10-06 09:34:02] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:34:02] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1872
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88004
)

[2025-10-06 09:34:02] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:34:02] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:34:02] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757641
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88004
    [user_id] => 1872
)

[2025-10-06 09:34:02] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:34:02
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:34:02] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1872
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88004
)

[2025-10-06 09:34:02] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1872
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:34:02] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:34:02] [debug] Payment method set:  online
[2025-10-06 09:34:02] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:34:02] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:34:02] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:34:02] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:34:03] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:34:03] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:34:03] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:34:03] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:34:03] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:34:03] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:34:03] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:34:03] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:34:03] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:34:03] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1872
    [lgl_id] => 944857
)

[2025-10-06 09:34:03] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1872
    [success] => Registration call completed
)

[2025-10-06 09:34:03] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1872
    [lgl_api_called] => YES
)

[2025-10-06 09:34:03] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:34:03] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88004
    [user_id] => 1872
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:34:03] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:34:03] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:34:03] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88004
    [final_memory_usage] => 122MB
)

[2025-10-06 09:35:03] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:35:04] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-06 09:35:04] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-06 09:35:04] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:35:04] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:35:04] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:35:04] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:35:04] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:35:04] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:35:04] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88005
    [timestamp] => 2025-10-06 09:35:04
    [memory_usage] => 118MB
)

[2025-10-06 09:35:04] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88005
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1873
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:35:04
    [item_count] => 0
)

[2025-10-06 09:35:04] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1873
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:35:04] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1873
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:35:04] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:35:04] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:35:04] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1873
    [order_id] => 88005
)

[2025-10-06 09:35:04] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:35:04] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88005
    [final_memory_usage] => 118MB
)

[2025-10-06 09:35:04] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:35:04] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88005
    [product_id] => 67487
)

[2025-10-06 09:35:05] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:35:05] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88005
    [timestamp] => 2025-10-06 09:35:05
    [memory_usage] => 122MB
)

[2025-10-06 09:35:05] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88005
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1873
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:35:04
    [item_count] => 1
)

[2025-10-06 09:35:05] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1873
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:35:05] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1873
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:35:05] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:35:05] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:35:05] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1873
    [order_id] => 88005
)

[2025-10-06 09:35:05] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:35:05] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:35:05] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:35:05] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1873
    [order_id] => 88005
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:35:05] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:35:05] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1873
    [order_id] => 88005
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:35:05
)

[2025-10-06 09:35:05] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:35:05] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:35:05] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:35:05] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:35:05] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:35:05] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:35:05] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:35:05] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1873
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:35:05] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1873
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:35:05] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1873
[2025-10-06 09:35:05] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:35:05] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:35:05] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:35:05] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757704
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88005
    [user_id] => 1873
)

[2025-10-06 09:35:05] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:35:05] [debug] MembershipOrderHandler: User data updated 1873
[2025-10-06 09:35:05] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:35:05] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1873
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88005
)

[2025-10-06 09:35:05] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:35:05] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:35:05] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759757704
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88005
    [user_id] => 1873
)

[2025-10-06 09:35:05] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:35:05
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:35:05] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1873
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88005
)

[2025-10-06 09:35:05] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1873
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:35:05] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:35:05] [debug] Payment method set:  online
[2025-10-06 09:35:05] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:35:05] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:35:05] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:35:05] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:35:06] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:35:06] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:35:06] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:35:06] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:35:06] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:35:06] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:35:06] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:35:06] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:35:06] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:35:06] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1873
    [lgl_id] => 944857
)

[2025-10-06 09:35:06] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1873
    [success] => Registration call completed
)

[2025-10-06 09:35:06] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1873
    [lgl_api_called] => YES
)

[2025-10-06 09:35:06] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:35:06] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88005
    [user_id] => 1873
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:35:06] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:35:06] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:35:06] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88005
    [final_memory_usage] => 122MB
)

[2025-10-06 09:41:25] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88006
    [timestamp] => 2025-10-06 09:41:25
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:41:25] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88006
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1874
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:41:25
    [item_count] => 0
)

[2025-10-06 09:41:25] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1874
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:41:25] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1874
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:41:25] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:41:25] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:41:25] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1874
    [order_id] => 88006
)

[2025-10-06 09:41:25] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:41:25] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88006
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:41:25] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:41:25] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88006
    [product_id] => 67487
)

[2025-10-06 09:41:25] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:41:26] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88006
    [timestamp] => 2025-10-06 09:41:26
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:41:26] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88006
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1874
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:41:25
    [item_count] => 1
)

[2025-10-06 09:41:26] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1874
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:41:26] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1874
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:41:26] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:41:26] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:41:26] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1874
    [order_id] => 88006
)

[2025-10-06 09:41:26] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:41:26] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:41:26] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:41:26] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1874
    [order_id] => 88006
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:41:26] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:41:26] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1874
    [order_id] => 88006
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:41:26
)

[2025-10-06 09:41:26] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:41:26] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:41:26] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:41:26] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:41:26] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:41:26] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:41:26] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:41:26] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1874
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:41:26] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1874
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:41:26] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1874
[2025-10-06 09:41:26] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:41:26] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:41:26] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:41:26] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758085
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88006
    [user_id] => 1874
)

[2025-10-06 09:41:26] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:41:26] [debug] MembershipOrderHandler: User data updated 1874
[2025-10-06 09:41:26] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:41:26] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1874
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88006
)

[2025-10-06 09:41:26] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:41:26] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:41:26] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758085
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88006
    [user_id] => 1874
)

[2025-10-06 09:41:26] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:41:26
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:41:26] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1874
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88006
)

[2025-10-06 09:41:26] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1874
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:41:26] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:41:26] [debug] Payment method set:  online
[2025-10-06 09:41:26] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:41:26] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:41:26] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:41:26] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:41:27] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:41:27] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:41:27] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:41:27] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:41:27] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:41:27] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:41:27] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:41:27] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:41:27] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:41:27] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1874
    [lgl_id] => 944857
)

[2025-10-06 09:41:27] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1874
    [success] => Registration call completed
)

[2025-10-06 09:41:27] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1874
    [lgl_api_called] => YES
)

[2025-10-06 09:41:27] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:41:27] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88006
    [user_id] => 1874
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:41:27] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:41:27] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:41:27] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88006
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:42:40] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88007
    [timestamp] => 2025-10-06 09:42:40
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:42:40] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88007
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1875
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:42:40
    [item_count] => 0
)

[2025-10-06 09:42:40] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1875
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:42:40] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1875
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:42:40] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:42:40] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:42:40] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1875
    [order_id] => 88007
)

[2025-10-06 09:42:40] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:42:40] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88007
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:42:40] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:42:40] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88007
    [product_id] => 67487
)

[2025-10-06 09:42:40] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:42:40] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88007
    [timestamp] => 2025-10-06 09:42:40
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:42:40] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88007
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1875
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:42:40
    [item_count] => 1
)

[2025-10-06 09:42:40] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1875
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:42:40] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1875
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:42:40] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:42:40] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:42:40] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1875
    [order_id] => 88007
)

[2025-10-06 09:42:40] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:42:40] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:42:40] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:42:40] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1875
    [order_id] => 88007
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:42:40] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:42:40] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1875
    [order_id] => 88007
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:42:40
)

[2025-10-06 09:42:40] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:42:40] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:42:40] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:42:40] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:42:40] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:42:40] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:42:40] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:42:40] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1875
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:42:40] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1875
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:42:40] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1875
[2025-10-06 09:42:40] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:42:40] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:42:40] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:42:40] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758160
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88007
    [user_id] => 1875
)

[2025-10-06 09:42:40] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:42:40] [debug] MembershipOrderHandler: User data updated 1875
[2025-10-06 09:42:40] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:42:40] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1875
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88007
)

[2025-10-06 09:42:40] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:42:40] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:42:40] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758160
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88007
    [user_id] => 1875
)

[2025-10-06 09:42:40] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:42:40
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:42:40] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1875
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88007
)

[2025-10-06 09:42:40] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1875
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:42:40] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:42:40] [debug] Payment method set:  online
[2025-10-06 09:42:40] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:42:40] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:42:40] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:42:40] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:42:41] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:42:41] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:42:41] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:42:41] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:42:41] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:42:41] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:42:41] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:42:41] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:42:41] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:42:41] [debug] ðŸ”„ UserRegistrationAction::updateMembership() - Request data Array
(
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [request_data] => Array
        (
            [user_firstname] => Debug
            [user_lastname] => Test
            [user_company] => 
            [username] => debug_test_user
            [user_email] => debug.test@example.com
            [user_phone] => 555-DEBUG
            [user-address-1] => 
            [user-address-2] => 
            [user-city] => 
            [user-state] => 
            [user-postal-code] => 
            [user-country-of-origin] => United States
            [current_date] => 1759758160
            [price] => 77.63
            [ui-membership-type] => Individual Membership
            [inserted_post_id] => 88007
            [user_id] => 1875
        )

)

[2025-10-06 09:42:41] [debug] ðŸ”„ UserRegistrationAction::updateMembership() - Legacy format Array
(
    [legacy_keys] => Array
        (
            [0] => user_id
            [1] => username
            [2] => ui-membership-type
            [3] => inserted_post_id
            [4] => price
            [5] => payment_type
            [6] => user_firstname
            [7] => user_lastname
            [8] => user_company
            [9] => user_email
            [10] => user_phone
            [11] => user-address-1
            [12] => user-address-2
            [13] => user-city
            [14] => user-state
            [15] => user-postal-code
            [16] => user-country-of-origin
            [17] => current_date
        )

    [legacy_data] => Array
        (
            [user_id] => 1875
            [username] => Debug Test
            [ui-membership-type] => Individual Membership
            [inserted_post_id] => 88007
            [price] => 77.63
            [payment_type] => online
            [user_firstname] => Debug
            [user_lastname] => Test
            [user_company] => 
            [user_email] => debug.test@example.com
            [user_phone] => 555-DEBUG
            [user-address-1] => 
            [user-address-2] => 
            [user-city] => 
            [user-state] => 
            [user-postal-code] => 
            [user-country-of-origin] => United States
            [current_date] => 1759758160
        )

)

[2025-10-06 09:42:41] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1875
    [lgl_id] => 944857
)

[2025-10-06 09:42:41] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1875
    [success] => Registration call completed
)

[2025-10-06 09:42:41] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1875
    [lgl_api_called] => YES
)

[2025-10-06 09:42:41] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:42:41] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88007
    [user_id] => 1875
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:42:41] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:42:41] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:42:41] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88007
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:42:52] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88008
    [timestamp] => 2025-10-06 09:42:52
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:42:52] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88008
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1876
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:42:52
    [item_count] => 0
)

[2025-10-06 09:42:52] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1876
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:42:52] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1876
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:42:52] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:42:52] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:42:52] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1876
    [order_id] => 88008
)

[2025-10-06 09:42:52] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:42:52] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88008
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:42:52] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:42:52] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88008
    [product_id] => 67487
)

[2025-10-06 09:42:52] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:42:53] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88008
    [timestamp] => 2025-10-06 09:42:53
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:42:53] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88008
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1876
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:42:52
    [item_count] => 1
)

[2025-10-06 09:42:53] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1876
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:42:53] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1876
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:42:53] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:42:53] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:42:53] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1876
    [order_id] => 88008
)

[2025-10-06 09:42:53] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:42:53] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:42:53] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:42:53] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1876
    [order_id] => 88008
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:42:53] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:42:53] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1876
    [order_id] => 88008
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:42:53
)

[2025-10-06 09:42:53] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:42:53] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:42:53] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:42:53] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:42:53] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:42:53] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:42:53] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:42:53] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1876
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:42:53] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1876
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:42:53] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1876
[2025-10-06 09:42:53] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:42:53] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:42:53] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:42:53] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758172
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88008
    [user_id] => 1876
)

[2025-10-06 09:42:53] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:42:53] [debug] MembershipOrderHandler: User data updated 1876
[2025-10-06 09:42:53] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:42:53] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1876
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88008
)

[2025-10-06 09:42:53] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:42:53] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:42:53] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758172
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88008
    [user_id] => 1876
)

[2025-10-06 09:42:53] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:42:53
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:42:53] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1876
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88008
)

[2025-10-06 09:42:53] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1876
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:42:53] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:42:53] [debug] Payment method set:  online
[2025-10-06 09:42:53] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:42:53] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:42:53] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:42:53] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:42:54] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:42:54] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:42:54] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:42:54] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:42:54] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:42:54] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:42:54] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:42:54] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:42:54] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:42:54] [debug] ðŸ”„ UserRegistrationAction::updateMembership() - Request data Array
(
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [request_data] => Array
        (
            [user_firstname] => Debug
            [user_lastname] => Test
            [user_company] => 
            [username] => debug_test_user
            [user_email] => debug.test@example.com
            [user_phone] => 555-DEBUG
            [user-address-1] => 
            [user-address-2] => 
            [user-city] => 
            [user-state] => 
            [user-postal-code] => 
            [user-country-of-origin] => United States
            [current_date] => 1759758172
            [price] => 77.63
            [ui-membership-type] => Individual Membership
            [inserted_post_id] => 88008
            [user_id] => 1876
        )

)

[2025-10-06 09:42:54] [debug] ðŸ”„ UserRegistrationAction::updateMembership() - Legacy format Array
(
    [legacy_keys] => Array
        (
            [0] => user_id
            [1] => username
            [2] => ui-membership-type
            [3] => inserted_post_id
            [4] => price
            [5] => payment_type
            [6] => user_firstname
            [7] => user_lastname
            [8] => user_company
            [9] => user_email
            [10] => user_phone
            [11] => user-address-1
            [12] => user-address-2
            [13] => user-city
            [14] => user-state
            [15] => user-postal-code
            [16] => user-country-of-origin
            [17] => current_date
        )

    [legacy_data] => Array
        (
            [user_id] => 1876
            [username] => Debug Test
            [ui-membership-type] => Individual Membership
            [inserted_post_id] => 88008
            [price] => 77.63
            [payment_type] => online
            [user_firstname] => Debug
            [user_lastname] => Test
            [user_company] => 
            [user_email] => debug.test@example.com
            [user_phone] => 555-DEBUG
            [user-address-1] => 
            [user-address-2] => 
            [user-city] => 
            [user-state] => 
            [user-postal-code] => 
            [user-country-of-origin] => United States
            [current_date] => 1759758172
        )

)

[2025-10-06 09:42:54] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1876
    [lgl_id] => 944857
)

[2025-10-06 09:42:54] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1876
    [success] => Registration call completed
)

[2025-10-06 09:42:54] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1876
    [lgl_api_called] => YES
)

[2025-10-06 09:42:54] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:42:54] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88008
    [user_id] => 1876
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:42:54] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:42:54] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:42:54] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88008
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:43:02] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88009
    [timestamp] => 2025-10-06 09:43:02
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:43:02] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88009
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1877
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:43:02
    [item_count] => 0
)

[2025-10-06 09:43:02] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1877
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:43:02] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1877
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:43:02] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:43:02] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:43:02] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1877
    [order_id] => 88009
)

[2025-10-06 09:43:02] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:43:02] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88009
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:43:02] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:43:02] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88009
    [product_id] => 67487
)

[2025-10-06 09:43:02] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:43:02] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88009
    [timestamp] => 2025-10-06 09:43:02
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:43:02] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88009
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1877
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:43:02
    [item_count] => 1
)

[2025-10-06 09:43:02] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1877
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:43:02] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1877
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:43:02] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:43:02] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:43:02] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1877
    [order_id] => 88009
)

[2025-10-06 09:43:02] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:43:02] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:43:02] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:43:02] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1877
    [order_id] => 88009
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:43:02] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:43:02] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1877
    [order_id] => 88009
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:43:02
)

[2025-10-06 09:43:02] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:43:02] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:43:02] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:43:02] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:43:02] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:43:02] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:43:02] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:43:02] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1877
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:43:02] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1877
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:43:02] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1877
[2025-10-06 09:43:02] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:43:02] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:43:02] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:43:02] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758182
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88009
    [user_id] => 1877
)

[2025-10-06 09:43:02] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:43:02] [debug] MembershipOrderHandler: User data updated 1877
[2025-10-06 09:43:02] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:43:02] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1877
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88009
)

[2025-10-06 09:43:02] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:43:02] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:43:02] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758182
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88009
    [user_id] => 1877
)

[2025-10-06 09:43:02] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:43:02
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:43:02] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1877
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88009
)

[2025-10-06 09:43:02] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1877
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:43:02] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:43:02] [debug] Payment method set:  online
[2025-10-06 09:43:02] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:43:02] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:43:02] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:43:02] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:43:03] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:43:03] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:43:03] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:43:03] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:43:03] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:43:03] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:43:03] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:43:03] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:43:03] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:43:03] [debug] ðŸ”„ UserRegistrationAction::updateMembership() - Request data Array
(
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [request_data] => Array
        (
            [user_firstname] => Debug
            [user_lastname] => Test
            [user_company] => 
            [username] => debug_test_user
            [user_email] => debug.test@example.com
            [user_phone] => 555-DEBUG
            [user-address-1] => 
            [user-address-2] => 
            [user-city] => 
            [user-state] => 
            [user-postal-code] => 
            [user-country-of-origin] => United States
            [current_date] => 1759758182
            [price] => 77.63
            [ui-membership-type] => Individual Membership
            [inserted_post_id] => 88009
            [user_id] => 1877
        )

)

[2025-10-06 09:43:03] [debug] ðŸ”„ UserRegistrationAction::updateMembership() - Legacy format Array
(
    [legacy_keys] => Array
        (
            [0] => user_id
            [1] => username
            [2] => ui-membership-type
            [3] => inserted_post_id
            [4] => price
            [5] => payment_type
            [6] => user_firstname
            [7] => user_lastname
            [8] => user_company
            [9] => user_email
            [10] => user_phone
            [11] => user-address-1
            [12] => user-address-2
            [13] => user-city
            [14] => user-state
            [15] => user-postal-code
            [16] => user-country-of-origin
            [17] => current_date
        )

    [legacy_data] => Array
        (
            [user_id] => 1877
            [username] => Debug Test
            [ui-membership-type] => Individual Membership
            [inserted_post_id] => 88009
            [price] => 77.63
            [payment_type] => online
            [user_firstname] => Debug
            [user_lastname] => Test
            [user_company] => 
            [user_email] => debug.test@example.com
            [user_phone] => 555-DEBUG
            [user-address-1] => 
            [user-address-2] => 
            [user-city] => 
            [user-state] => 
            [user-postal-code] => 
            [user-country-of-origin] => United States
            [current_date] => 1759758182
        )

)

[2025-10-06 09:43:03] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1877
    [lgl_id] => 944857
)

[2025-10-06 09:43:03] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1877
    [success] => Registration call completed
)

[2025-10-06 09:43:03] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1877
    [lgl_api_called] => YES
)

[2025-10-06 09:43:03] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:43:03] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88009
    [user_id] => 1877
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:43:03] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:43:03] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:43:03] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88009
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:46:49] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88010
    [timestamp] => 2025-10-06 09:46:49
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:46:49] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88010
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1878
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:46:49
    [item_count] => 0
)

[2025-10-06 09:46:49] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1878
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:46:49] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1878
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:46:49] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:46:49] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:46:49] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1878
    [order_id] => 88010
)

[2025-10-06 09:46:49] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:46:49] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88010
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:46:49] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:46:49] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88010
    [product_id] => 67487
)

[2025-10-06 09:46:49] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:46:50] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88010
    [timestamp] => 2025-10-06 09:46:50
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:46:50] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88010
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1878
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:46:49
    [item_count] => 1
)

[2025-10-06 09:46:50] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1878
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:46:50] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1878
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:46:50] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:46:50] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:46:50] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1878
    [order_id] => 88010
)

[2025-10-06 09:46:50] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:46:50] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:46:50] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:46:50] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1878
    [order_id] => 88010
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:46:50] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:46:50] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1878
    [order_id] => 88010
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:46:50
)

[2025-10-06 09:46:50] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:46:50] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:46:50] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:46:50] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:46:50] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:46:50] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:46:50] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:46:50] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1878
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:46:50] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1878
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:46:50] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1878
[2025-10-06 09:46:50] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:46:50] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:46:50] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:46:50] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758409
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88010
    [user_id] => 1878
)

[2025-10-06 09:46:50] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:46:51] [debug] MembershipOrderHandler: User data updated 1878
[2025-10-06 09:46:51] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:46:51] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1878
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88010
)

[2025-10-06 09:46:51] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:46:51] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:46:51] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758409
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88010
    [user_id] => 1878
)

[2025-10-06 09:46:51] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:46:51
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:46:51] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1878
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88010
)

[2025-10-06 09:46:51] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1878
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:46:51] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:46:51] [debug] Payment method set:  online
[2025-10-06 09:46:51] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:46:51] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:46:51] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:46:51] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:46:52] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:46:52] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:46:52] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:46:52] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:46:52] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:46:52] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:46:52] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:46:52] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:46:52] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:46:52] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1878
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:46:52] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:46:52] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:46:52] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:46:52] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:46:52] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1878
    [lgl_id] => 944857
)

[2025-10-06 09:46:52] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual
    [membership_level] => individual
    [membership_status] => active
    [start_date] => 
    [renewal_date] => 
    [payment_method] => 
    [notes] => 
    [parent_user_id] => 
)

[2025-10-06 09:46:52] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual
            [membership_level] => individual
            [membership_status] => active
            [start_date] => 
            [renewal_date] => 
            [payment_method] => 
            [notes] => 
            [parent_user_id] => 
        )

)

[2025-10-06 09:46:53] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank; Start date must be present and valid (YYYY-MM-DD)"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:46:53] [debug] âŒ Error creating membership object Array
(
    [uid] => 1878
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:46:53] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:46:53] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1878
    [success] => Registration call completed
)

[2025-10-06 09:46:53] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1878
    [lgl_api_called] => YES
)

[2025-10-06 09:46:53] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:46:53] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88010
    [user_id] => 1878
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:46:53] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:46:53] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:46:53] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88010
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:47:05] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88011
    [timestamp] => 2025-10-06 09:47:05
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:47:05] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88011
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1879
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:47:05
    [item_count] => 0
)

[2025-10-06 09:47:05] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1879
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:47:05] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1879
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:47:05] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:47:05] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:47:05] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1879
    [order_id] => 88011
)

[2025-10-06 09:47:05] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:47:05] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88011
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:47:05] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:47:05] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88011
    [product_id] => 67487
)

[2025-10-06 09:47:05] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:47:05] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88011
    [timestamp] => 2025-10-06 09:47:05
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:47:05] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88011
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1879
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:47:05
    [item_count] => 1
)

[2025-10-06 09:47:05] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1879
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:47:05] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1879
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:47:05] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:47:05] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:47:05] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1879
    [order_id] => 88011
)

[2025-10-06 09:47:05] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:47:05] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:47:05] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:47:05] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1879
    [order_id] => 88011
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:47:05] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:47:05] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1879
    [order_id] => 88011
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:47:05
)

[2025-10-06 09:47:05] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:47:05] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:47:05] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:47:05] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:47:05] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:47:05] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:47:05] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:47:05] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1879
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:47:05] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1879
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:47:05] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1879
[2025-10-06 09:47:05] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:47:05] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:47:05] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:47:05] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758425
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88011
    [user_id] => 1879
)

[2025-10-06 09:47:05] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:47:06] [debug] MembershipOrderHandler: User data updated 1879
[2025-10-06 09:47:06] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:47:06] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1879
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88011
)

[2025-10-06 09:47:06] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:47:06] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:47:06] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758425
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88011
    [user_id] => 1879
)

[2025-10-06 09:47:06] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:47:06
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:47:06] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1879
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88011
)

[2025-10-06 09:47:06] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1879
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:47:06] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:47:06] [debug] Payment method set:  online
[2025-10-06 09:47:06] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:47:06] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:47:06] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:47:06] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:47:06] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:47:06] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:47:06] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:47:06] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:47:06] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:47:06] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:47:06] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:47:06] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:47:06] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:47:06] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1879
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:47:06] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:47:06] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:47:07] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:47:07] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:47:07] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1879
    [lgl_id] => 944857
)

[2025-10-06 09:47:07] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual
    [membership_level] => individual
    [membership_status] => active
    [start_date] => 
    [renewal_date] => 
    [payment_method] => 
    [notes] => 
    [parent_user_id] => 
)

[2025-10-06 09:47:07] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual
            [membership_level] => individual
            [membership_status] => active
            [start_date] => 
            [renewal_date] => 
            [payment_method] => 
            [notes] => 
            [parent_user_id] => 
        )

)

[2025-10-06 09:47:07] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank; Start date must be present and valid (YYYY-MM-DD)"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:47:07] [debug] âŒ Error creating membership object Array
(
    [uid] => 1879
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:47:07] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:47:07] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1879
    [success] => Registration call completed
)

[2025-10-06 09:47:07] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1879
    [lgl_api_called] => YES
)

[2025-10-06 09:47:07] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:47:07] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88011
    [user_id] => 1879
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:47:07] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:47:07] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:47:07] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88011
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:47:20] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88012
    [timestamp] => 2025-10-06 09:47:20
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:47:20] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88012
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1880
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:47:20
    [item_count] => 0
)

[2025-10-06 09:47:20] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1880
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:47:20] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1880
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:47:20] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:47:20] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:47:20] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1880
    [order_id] => 88012
)

[2025-10-06 09:47:20] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:47:20] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88012
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:47:20] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:47:20] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88012
    [product_id] => 67487
)

[2025-10-06 09:47:20] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:47:21] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88012
    [timestamp] => 2025-10-06 09:47:21
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:47:21] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88012
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1880
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:47:20
    [item_count] => 1
)

[2025-10-06 09:47:21] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1880
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:47:21] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1880
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:47:21] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:47:21] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:47:21] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1880
    [order_id] => 88012
)

[2025-10-06 09:47:21] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:47:21] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:47:21] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:47:21] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1880
    [order_id] => 88012
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:47:21] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:47:21] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1880
    [order_id] => 88012
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:47:21
)

[2025-10-06 09:47:21] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:47:21] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:47:21] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:47:21] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:47:21] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:47:21] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:47:21] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:47:21] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1880
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:47:21] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1880
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:47:21] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1880
[2025-10-06 09:47:21] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:47:21] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:47:21] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:47:21] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758440
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88012
    [user_id] => 1880
)

[2025-10-06 09:47:21] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:47:21] [debug] MembershipOrderHandler: User data updated 1880
[2025-10-06 09:47:21] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:47:21] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1880
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88012
)

[2025-10-06 09:47:21] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:47:21] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:47:21] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758440
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88012
    [user_id] => 1880
)

[2025-10-06 09:47:21] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:47:21
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:47:21] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1880
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88012
)

[2025-10-06 09:47:21] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1880
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:47:21] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:47:21] [debug] Payment method set:  online
[2025-10-06 09:47:21] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:47:21] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:47:21] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:47:21] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:47:21] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:47:21] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:47:21] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:47:21] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:47:21] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:47:21] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:47:21] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:47:21] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:47:21] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:47:21] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1880
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:47:21] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:47:21] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:47:22] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:47:22] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:47:22] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1880
    [lgl_id] => 944857
)

[2025-10-06 09:47:22] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual
    [membership_level] => individual
    [membership_status] => active
    [start_date] => 
    [renewal_date] => 
    [payment_method] => 
    [notes] => 
    [parent_user_id] => 
)

[2025-10-06 09:47:22] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual
            [membership_level] => individual
            [membership_status] => active
            [start_date] => 
            [renewal_date] => 
            [payment_method] => 
            [notes] => 
            [parent_user_id] => 
        )

)

[2025-10-06 09:47:22] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank; Start date must be present and valid (YYYY-MM-DD)"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:47:22] [debug] âŒ Error creating membership object Array
(
    [uid] => 1880
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:47:22] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:47:22] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1880
    [success] => Registration call completed
)

[2025-10-06 09:47:22] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1880
    [lgl_api_called] => YES
)

[2025-10-06 09:47:22] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:47:22] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88012
    [user_id] => 1880
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:47:22] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:47:22] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:47:22] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88012
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:48:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88013
    [timestamp] => 2025-10-06 09:48:13
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:48:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88013
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1881
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:48:13
    [item_count] => 0
)

[2025-10-06 09:48:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1881
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:48:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1881
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:48:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:48:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:48:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1881
    [order_id] => 88013
)

[2025-10-06 09:48:13] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:48:13] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88013
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:48:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:48:13] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88013
    [product_id] => 67487
)

[2025-10-06 09:48:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:48:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88013
    [timestamp] => 2025-10-06 09:48:13
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:48:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88013
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1881
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:48:13
    [item_count] => 1
)

[2025-10-06 09:48:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1881
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:48:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1881
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:48:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:48:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:48:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1881
    [order_id] => 88013
)

[2025-10-06 09:48:13] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:48:13] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:48:13] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:48:13] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1881
    [order_id] => 88013
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:48:13] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:48:13] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1881
    [order_id] => 88013
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:48:13
)

[2025-10-06 09:48:13] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:48:13] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:48:13] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:48:13] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:48:13] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:48:13] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:48:13] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:48:13] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1881
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:48:13] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1881
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:48:13] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1881
[2025-10-06 09:48:13] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:48:13] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:48:13] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:48:13] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758493
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88013
    [user_id] => 1881
)

[2025-10-06 09:48:13] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:48:14] [debug] MembershipOrderHandler: User data updated 1881
[2025-10-06 09:48:14] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:48:14] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1881
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88013
)

[2025-10-06 09:48:14] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:48:14] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:48:14] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758493
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88013
    [user_id] => 1881
)

[2025-10-06 09:48:14] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:48:14
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:48:14] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1881
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88013
)

[2025-10-06 09:48:14] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1881
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:48:14] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:48:14] [debug] Payment method set:  online
[2025-10-06 09:48:14] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:48:14] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:48:14] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:48:14] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:48:14] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:48:14] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:48:14] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:48:14] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:48:14] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:48:14] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:48:14] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:48:14] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:48:14] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:48:14] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1881
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:48:14] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:48:14] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:48:15] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:48:15] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:48:15] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1881
    [lgl_id] => 944857
)

[2025-10-06 09:48:15] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:48:15] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:48:15] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:48:15] [debug] âŒ Error creating membership object Array
(
    [uid] => 1881
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:48:15] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:48:15] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1881
    [success] => Registration call completed
)

[2025-10-06 09:48:15] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1881
    [lgl_api_called] => YES
)

[2025-10-06 09:48:15] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:48:15] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88013
    [user_id] => 1881
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:48:15] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:48:15] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:48:15] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88013
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:48:28] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88014
    [timestamp] => 2025-10-06 09:48:28
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:48:28] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88014
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1882
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:48:28
    [item_count] => 0
)

[2025-10-06 09:48:28] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1882
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:48:28] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1882
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:48:28] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:48:28] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:48:28] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1882
    [order_id] => 88014
)

[2025-10-06 09:48:28] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:48:28] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88014
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:48:28] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:48:28] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88014
    [product_id] => 67487
)

[2025-10-06 09:48:28] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:48:28] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88014
    [timestamp] => 2025-10-06 09:48:28
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:48:28] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88014
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1882
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:48:28
    [item_count] => 1
)

[2025-10-06 09:48:28] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1882
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:48:28] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1882
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:48:28] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:48:28] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:48:28] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1882
    [order_id] => 88014
)

[2025-10-06 09:48:28] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:48:28] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:48:28] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:48:28] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1882
    [order_id] => 88014
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:48:28] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:48:28] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1882
    [order_id] => 88014
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:48:28
)

[2025-10-06 09:48:28] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:48:28] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:48:28] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:48:28] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:48:28] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:48:28] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:48:28] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:48:28] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1882
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:48:28] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1882
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:48:28] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1882
[2025-10-06 09:48:28] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:48:28] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:48:28] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:48:28] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758508
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88014
    [user_id] => 1882
)

[2025-10-06 09:48:28] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:48:29] [debug] MembershipOrderHandler: User data updated 1882
[2025-10-06 09:48:29] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:48:29] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1882
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88014
)

[2025-10-06 09:48:29] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:48:29] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:48:29] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758508
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88014
    [user_id] => 1882
)

[2025-10-06 09:48:29] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:48:29
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:48:29] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1882
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88014
)

[2025-10-06 09:48:29] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1882
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:48:29] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:48:29] [debug] Payment method set:  online
[2025-10-06 09:48:29] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:48:29] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:48:29] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:48:29] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:48:29] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:48:29] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:48:29] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:48:29] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:48:29] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:48:29] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:48:29] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:48:29] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:48:29] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:48:29] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1882
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:48:29] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:48:29] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:48:30] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:48:30] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:48:30] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1882
    [lgl_id] => 944857
)

[2025-10-06 09:48:30] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:48:30] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:48:30] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:48:30] [debug] âŒ Error creating membership object Array
(
    [uid] => 1882
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:48:30] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:48:30] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1882
    [success] => Registration call completed
)

[2025-10-06 09:48:30] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1882
    [lgl_api_called] => YES
)

[2025-10-06 09:48:30] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:48:30] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88014
    [user_id] => 1882
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:48:30] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:48:30] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:48:30] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88014
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:48:39] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:48:40] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-06 09:48:40] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-06 09:48:40] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:48:40] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:48:40] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:48:40] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:48:40] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:48:40] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:48:40] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88015
    [timestamp] => 2025-10-06 09:48:40
    [memory_usage] => 118MB
)

[2025-10-06 09:48:40] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88015
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1883
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:48:40
    [item_count] => 0
)

[2025-10-06 09:48:40] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1883
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:48:40] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1883
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:48:40] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:48:40] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:48:40] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1883
    [order_id] => 88015
)

[2025-10-06 09:48:40] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:48:40] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88015
    [final_memory_usage] => 118MB
)

[2025-10-06 09:48:40] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:48:40] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88015
    [product_id] => 67487
)

[2025-10-06 09:48:41] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:48:41] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88015
    [timestamp] => 2025-10-06 09:48:41
    [memory_usage] => 122MB
)

[2025-10-06 09:48:41] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88015
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1883
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:48:40
    [item_count] => 1
)

[2025-10-06 09:48:41] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1883
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:48:41] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1883
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:48:41] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:48:41] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:48:41] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1883
    [order_id] => 88015
)

[2025-10-06 09:48:41] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:48:41] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:48:41] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:48:41] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1883
    [order_id] => 88015
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:48:41] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:48:41] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1883
    [order_id] => 88015
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:48:41
)

[2025-10-06 09:48:41] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:48:41] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:48:41] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:48:41] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:48:41] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:48:41] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:48:41] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:48:41] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1883
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:48:41] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1883
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:48:41] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1883
[2025-10-06 09:48:41] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:48:41] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:48:41] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:48:41] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758520
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88015
    [user_id] => 1883
)

[2025-10-06 09:48:41] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:48:41] [debug] MembershipOrderHandler: User data updated 1883
[2025-10-06 09:48:41] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:48:41] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1883
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88015
)

[2025-10-06 09:48:41] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:48:41] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:48:41] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758520
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88015
    [user_id] => 1883
)

[2025-10-06 09:48:41] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:48:41
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:48:41] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1883
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88015
)

[2025-10-06 09:48:41] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1883
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:48:41] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:48:41] [debug] Payment method set:  online
[2025-10-06 09:48:41] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:48:41] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:48:41] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:48:41] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:48:42] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:48:42] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:48:42] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:48:42] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:48:42] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:48:42] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:48:42] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:48:42] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:48:42] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:48:42] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1883
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:48:42] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:48:42] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:48:42] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:48:42] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:48:42] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1883
    [lgl_id] => 944857
)

[2025-10-06 09:48:42] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:48:42] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:48:43] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:48:43] [debug] âŒ Error creating membership object Array
(
    [uid] => 1883
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:48:43] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:48:43] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1883
    [success] => Registration call completed
)

[2025-10-06 09:48:43] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1883
    [lgl_api_called] => YES
)

[2025-10-06 09:48:43] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:48:43] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88015
    [user_id] => 1883
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:48:43] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:48:43] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:48:43] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88015
    [final_memory_usage] => 122MB
)

[2025-10-06 09:51:02] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88016
    [timestamp] => 2025-10-06 09:51:02
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:51:02] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88016
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1884
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:51:02
    [item_count] => 0
)

[2025-10-06 09:51:02] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1884
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:51:02] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1884
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:51:02] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:51:02] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:51:02] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1884
    [order_id] => 88016
)

[2025-10-06 09:51:02] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:51:02] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88016
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:51:02] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:51:02] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88016
    [product_id] => 67487
)

[2025-10-06 09:51:02] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:51:03] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88016
    [timestamp] => 2025-10-06 09:51:03
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:51:03] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88016
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1884
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:51:02
    [item_count] => 1
)

[2025-10-06 09:51:03] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1884
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:51:03] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1884
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:51:03] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:51:03] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:51:03] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1884
    [order_id] => 88016
)

[2025-10-06 09:51:03] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:51:03] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:51:03] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:51:03] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1884
    [order_id] => 88016
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:51:03] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:51:03] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1884
    [order_id] => 88016
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:51:03
)

[2025-10-06 09:51:03] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:51:03] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:51:03] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:51:03] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:51:03] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:51:03] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:51:03] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:51:03] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1884
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:51:03] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1884
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:51:03] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1884
[2025-10-06 09:51:03] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:51:03] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:51:03] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:51:03] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758662
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88016
    [user_id] => 1884
)

[2025-10-06 09:51:03] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:51:03] [debug] MembershipOrderHandler: User data updated 1884
[2025-10-06 09:51:03] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:51:03] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1884
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88016
)

[2025-10-06 09:51:03] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:51:03] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:51:03] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758662
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88016
    [user_id] => 1884
)

[2025-10-06 09:51:03] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:51:03
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:51:03] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1884
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88016
)

[2025-10-06 09:51:03] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1884
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:51:03] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:51:03] [debug] Payment method set:  online
[2025-10-06 09:51:03] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:51:03] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:51:03] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:51:03] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:51:04] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:51:04] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:51:04] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:51:04] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:51:04] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:51:04] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:51:04] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:51:04] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:51:04] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:51:04] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1884
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:51:04] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:51:04] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:51:04] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:51:04] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:51:04] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1884
    [lgl_id] => 944857
)

[2025-10-06 09:51:04] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:51:04] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:51:04] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:51:04] [debug] âŒ Error creating membership object Array
(
    [uid] => 1884
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:51:04] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:51:04] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1884
    [success] => Registration call completed
)

[2025-10-06 09:51:04] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1884
    [lgl_api_called] => YES
)

[2025-10-06 09:51:04] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:51:04] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88016
    [user_id] => 1884
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:51:04] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:51:04] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:51:04] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88016
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:51:11] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:51:12] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-06 09:51:12] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-06 09:51:12] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:51:12] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:51:12] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:51:12] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:51:12] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:51:12] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:51:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88017
    [timestamp] => 2025-10-06 09:51:13
    [memory_usage] => 118MB
)

[2025-10-06 09:51:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88017
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1885
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:51:13
    [item_count] => 0
)

[2025-10-06 09:51:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1885
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:51:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1885
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:51:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:51:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:51:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1885
    [order_id] => 88017
)

[2025-10-06 09:51:13] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:51:13] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88017
    [final_memory_usage] => 118MB
)

[2025-10-06 09:51:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:51:13] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88017
    [product_id] => 67487
)

[2025-10-06 09:51:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:51:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88017
    [timestamp] => 2025-10-06 09:51:13
    [memory_usage] => 122MB
)

[2025-10-06 09:51:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88017
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1885
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:51:13
    [item_count] => 1
)

[2025-10-06 09:51:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1885
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:51:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1885
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:51:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:51:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:51:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1885
    [order_id] => 88017
)

[2025-10-06 09:51:13] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:51:13] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:51:13] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:51:13] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1885
    [order_id] => 88017
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:51:13] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:51:13] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1885
    [order_id] => 88017
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:51:13
)

[2025-10-06 09:51:13] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:51:13] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:51:13] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:51:13] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:51:13] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:51:13] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:51:13] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:51:13] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1885
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:51:13] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1885
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:51:13] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1885
[2025-10-06 09:51:13] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:51:13] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:51:13] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:51:13] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758673
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88017
    [user_id] => 1885
)

[2025-10-06 09:51:13] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:51:13] [debug] MembershipOrderHandler: User data updated 1885
[2025-10-06 09:51:13] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:51:13] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1885
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88017
)

[2025-10-06 09:51:13] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:51:13] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:51:13] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758673
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88017
    [user_id] => 1885
)

[2025-10-06 09:51:13] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:51:13
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:51:13] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1885
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88017
)

[2025-10-06 09:51:13] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1885
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:51:13] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:51:13] [debug] Payment method set:  online
[2025-10-06 09:51:13] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:51:13] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:51:13] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:51:13] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:51:14] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:51:14] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:51:14] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:51:14] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:51:14] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:51:14] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:51:14] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:51:14] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:51:14] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:51:14] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1885
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:51:14] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:51:14] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:51:14] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:51:14] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:51:14] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1885
    [lgl_id] => 944857
)

[2025-10-06 09:51:14] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:51:14] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:51:15] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:51:15] [debug] âŒ Error creating membership object Array
(
    [uid] => 1885
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:51:15] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:51:15] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1885
    [success] => Registration call completed
)

[2025-10-06 09:51:15] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1885
    [lgl_api_called] => YES
)

[2025-10-06 09:51:15] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:51:15] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88017
    [user_id] => 1885
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:51:15] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:51:15] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:51:15] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88017
    [final_memory_usage] => 122MB
)

[2025-10-06 09:51:53] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88018
    [timestamp] => 2025-10-06 09:51:53
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:51:53] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88018
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1886
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:51:53
    [item_count] => 0
)

[2025-10-06 09:51:53] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1886
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:51:53] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1886
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:51:53] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:51:53] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:51:53] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1886
    [order_id] => 88018
)

[2025-10-06 09:51:53] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:51:53] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88018
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:51:53] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:51:53] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88018
    [product_id] => 67487
)

[2025-10-06 09:51:53] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:51:53] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88018
    [timestamp] => 2025-10-06 09:51:53
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:51:53] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88018
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1886
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:51:53
    [item_count] => 1
)

[2025-10-06 09:51:53] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1886
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:51:53] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1886
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:51:53] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:51:53] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:51:53] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1886
    [order_id] => 88018
)

[2025-10-06 09:51:53] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:51:53] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:51:53] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:51:53] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1886
    [order_id] => 88018
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:51:53] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:51:53] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1886
    [order_id] => 88018
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:51:53
)

[2025-10-06 09:51:53] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:51:53] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:51:53] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:51:53] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:51:53] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:51:53] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:51:53] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:51:53] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1886
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:51:53] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1886
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:51:53] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1886
[2025-10-06 09:51:53] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:51:53] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:51:53] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:51:53] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758713
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88018
    [user_id] => 1886
)

[2025-10-06 09:51:53] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:51:54] [debug] MembershipOrderHandler: User data updated 1886
[2025-10-06 09:51:54] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:51:54] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1886
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88018
)

[2025-10-06 09:51:54] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:51:54] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:51:54] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758713
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88018
    [user_id] => 1886
)

[2025-10-06 09:51:54] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:51:54
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:51:54] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1886
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88018
)

[2025-10-06 09:51:54] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1886
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:51:54] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:51:54] [debug] Payment method set:  online
[2025-10-06 09:51:54] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:51:54] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:51:54] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:51:54] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:51:54] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:51:54] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:51:54] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:51:54] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:51:54] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:51:54] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:51:54] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:51:54] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:51:54] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:51:54] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1886
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:51:54] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:51:54] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:51:54] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:51:54] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:51:54] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1886
    [lgl_id] => 944857
)

[2025-10-06 09:51:54] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:51:54] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:51:55] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:51:55] [debug] âŒ Error creating membership object Array
(
    [uid] => 1886
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:51:55] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:51:55] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1886
    [success] => Registration call completed
)

[2025-10-06 09:51:55] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1886
    [lgl_api_called] => YES
)

[2025-10-06 09:51:55] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:51:55] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88018
    [user_id] => 1886
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:51:55] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:51:55] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:51:55] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88018
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:52:28] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88019
    [timestamp] => 2025-10-06 09:52:28
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:52:28] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88019
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1887
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:52:28
    [item_count] => 0
)

[2025-10-06 09:52:28] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1887
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:52:28] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1887
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:52:28] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:52:28] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:52:28] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1887
    [order_id] => 88019
)

[2025-10-06 09:52:28] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:52:28] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88019
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:52:28] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:52:28] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88019
    [product_id] => 67487
)

[2025-10-06 09:52:28] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:52:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88019
    [timestamp] => 2025-10-06 09:52:29
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:52:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88019
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1887
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:52:28
    [item_count] => 1
)

[2025-10-06 09:52:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1887
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:52:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1887
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:52:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:52:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:52:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1887
    [order_id] => 88019
)

[2025-10-06 09:52:29] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:52:29] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:52:29] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:52:29] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1887
    [order_id] => 88019
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:52:29] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:52:29] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1887
    [order_id] => 88019
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:52:29
)

[2025-10-06 09:52:29] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:52:29] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:52:29] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:52:29] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:52:29] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:52:29] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:52:29] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:52:29] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1887
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:52:29] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1887
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:52:29] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1887
[2025-10-06 09:52:29] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:52:29] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:52:29] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:52:29] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758748
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88019
    [user_id] => 1887
)

[2025-10-06 09:52:29] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:52:29] [debug] MembershipOrderHandler: User data updated 1887
[2025-10-06 09:52:29] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:52:29] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1887
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88019
)

[2025-10-06 09:52:29] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:52:29] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:52:29] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758748
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88019
    [user_id] => 1887
)

[2025-10-06 09:52:29] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:52:29
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:52:29] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1887
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88019
)

[2025-10-06 09:52:29] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1887
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:52:29] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:52:29] [debug] Payment method set:  online
[2025-10-06 09:52:29] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:52:29] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:52:29] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:52:29] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:52:30] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:52:30] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:52:30] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:52:30] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:52:30] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:52:30] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:52:30] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:52:30] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:52:30] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:52:30] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1887
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:52:30] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:52:30] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:52:30] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:52:30] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:52:30] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1887
    [lgl_id] => 944857
)

[2025-10-06 09:52:30] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:52:30] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:52:30] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:52:30] [debug] âŒ Error creating membership object Array
(
    [uid] => 1887
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:52:30] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 429
)

[2025-10-06 09:52:30] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1887
    [success] => Registration call completed
)

[2025-10-06 09:52:30] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1887
    [lgl_api_called] => YES
)

[2025-10-06 09:52:30] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:52:30] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88019
    [user_id] => 1887
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:52:30] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:52:30] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:52:30] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88019
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:53:10] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88020
    [timestamp] => 2025-10-06 09:53:10
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:53:10] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88020
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1888
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:53:10
    [item_count] => 0
)

[2025-10-06 09:53:10] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1888
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:53:10] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1888
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:53:10] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:53:10] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:53:10] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1888
    [order_id] => 88020
)

[2025-10-06 09:53:10] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:53:10] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88020
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:53:10] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:53:10] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88020
    [product_id] => 67487
)

[2025-10-06 09:53:10] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:53:10] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88020
    [timestamp] => 2025-10-06 09:53:10
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:53:10] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88020
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1888
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:53:10
    [item_count] => 1
)

[2025-10-06 09:53:10] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1888
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:53:10] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1888
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:53:10] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:53:10] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:53:10] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1888
    [order_id] => 88020
)

[2025-10-06 09:53:10] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:53:10] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:53:10] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:53:10] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1888
    [order_id] => 88020
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:53:10] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:53:10] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1888
    [order_id] => 88020
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:53:10
)

[2025-10-06 09:53:10] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:53:10] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:53:10] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:53:10] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:53:10] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:53:10] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:53:10] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:53:10] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1888
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:53:10] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1888
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:53:10] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1888
[2025-10-06 09:53:10] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:53:10] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:53:10] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:53:10] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758790
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88020
    [user_id] => 1888
)

[2025-10-06 09:53:10] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:53:11] [debug] MembershipOrderHandler: User data updated 1888
[2025-10-06 09:53:11] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:53:11] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1888
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88020
)

[2025-10-06 09:53:11] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:53:11] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:53:11] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758790
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88020
    [user_id] => 1888
)

[2025-10-06 09:53:11] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:53:11
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:53:11] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1888
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88020
)

[2025-10-06 09:53:11] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1888
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:53:11] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:53:11] [debug] Payment method set:  online
[2025-10-06 09:53:11] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:53:11] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:53:11] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:53:11] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:53:11] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:53:11] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:53:11] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:53:11] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:53:11] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:53:11] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:53:11] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:53:11] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:53:11] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:53:11] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1888
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:53:11] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:53:11] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:53:11] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:53:11] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:53:11] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1888
    [lgl_id] => 944857
)

[2025-10-06 09:53:11] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:53:11] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:53:12] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:53:12] [debug] âŒ Error creating membership object Array
(
    [uid] => 1888
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:53:12] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 435
)

[2025-10-06 09:53:12] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1888
    [success] => Registration call completed
)

[2025-10-06 09:53:12] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1888
    [lgl_api_called] => YES
)

[2025-10-06 09:53:12] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:53:12] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88020
    [user_id] => 1888
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:53:12] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:53:12] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:53:12] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88020
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:53:15] [debug] Membership cron jobs scheduled successfully
[2025-10-06 09:53:15] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-06 09:53:15] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-06 09:53:16] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:53:16] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:53:16] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:53:16] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:53:16] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:53:16] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:53:16] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88021
    [timestamp] => 2025-10-06 09:53:16
    [memory_usage] => 118MB
)

[2025-10-06 09:53:16] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88021
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1889
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:53:16
    [item_count] => 0
)

[2025-10-06 09:53:16] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1889
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:53:16] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1889
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:53:16] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:53:16] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:53:16] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1889
    [order_id] => 88021
)

[2025-10-06 09:53:16] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:53:16] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88021
    [final_memory_usage] => 118MB
)

[2025-10-06 09:53:16] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:53:16] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88021
    [product_id] => 67487
)

[2025-10-06 09:53:16] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:53:16] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88021
    [timestamp] => 2025-10-06 09:53:16
    [memory_usage] => 122MB
)

[2025-10-06 09:53:16] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88021
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1889
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:53:16
    [item_count] => 1
)

[2025-10-06 09:53:16] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1889
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:53:16] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1889
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:53:16] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:53:16] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:53:16] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1889
    [order_id] => 88021
)

[2025-10-06 09:53:16] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:53:16] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:53:16] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:53:16] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1889
    [order_id] => 88021
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:53:16] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:53:16] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1889
    [order_id] => 88021
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:53:16
)

[2025-10-06 09:53:16] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:53:16] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:53:16] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:53:16] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:53:16] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:53:16] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:53:16] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:53:16] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1889
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:53:16] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1889
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:53:16] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1889
[2025-10-06 09:53:16] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:53:16] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:53:16] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:53:16] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758796
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88021
    [user_id] => 1889
)

[2025-10-06 09:53:16] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:53:17] [debug] MembershipOrderHandler: User data updated 1889
[2025-10-06 09:53:17] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:53:17] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1889
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88021
)

[2025-10-06 09:53:17] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:53:17] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:53:17] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758796
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88021
    [user_id] => 1889
)

[2025-10-06 09:53:17] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:53:17
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:53:17] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1889
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88021
)

[2025-10-06 09:53:17] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1889
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:53:17] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:53:17] [debug] Payment method set:  online
[2025-10-06 09:53:17] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:53:17] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:53:17] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:53:17] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:53:17] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:53:17] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:53:17] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:53:17] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:53:17] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:53:17] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:53:17] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:53:17] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:53:17] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:53:17] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1889
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:53:17] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:53:17] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:53:18] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:53:18] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:53:18] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1889
    [lgl_id] => 944857
)

[2025-10-06 09:53:18] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:53:18] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:53:18] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:53:18] [debug] âŒ Error creating membership object Array
(
    [uid] => 1889
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:53:18] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 435
)

[2025-10-06 09:53:18] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1889
    [success] => Registration call completed
)

[2025-10-06 09:53:18] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1889
    [lgl_api_called] => YES
)

[2025-10-06 09:53:18] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:53:18] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88021
    [user_id] => 1889
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:53:18] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:53:18] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:53:18] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88021
    [final_memory_usage] => 122MB
)

[2025-10-06 09:53:48] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88022
    [timestamp] => 2025-10-06 09:53:48
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:53:48] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88022
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1890
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:53:48
    [item_count] => 0
)

[2025-10-06 09:53:48] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1890
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:53:48] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1890
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:53:48] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:53:48] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:53:48] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1890
    [order_id] => 88022
)

[2025-10-06 09:53:48] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:53:48] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88022
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:53:48] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:53:48] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88022
    [product_id] => 67487
)

[2025-10-06 09:53:48] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:53:48] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88022
    [timestamp] => 2025-10-06 09:53:48
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:53:48] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88022
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1890
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:53:48
    [item_count] => 1
)

[2025-10-06 09:53:48] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1890
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:53:48] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1890
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:53:48] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:53:48] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:53:48] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1890
    [order_id] => 88022
)

[2025-10-06 09:53:48] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:53:48] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:53:48] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:53:48] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1890
    [order_id] => 88022
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:53:48] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:53:48] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1890
    [order_id] => 88022
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:53:48
)

[2025-10-06 09:53:48] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:53:48] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:53:48] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:53:48] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:53:48] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:53:48] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:53:48] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:53:48] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1890
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:53:48] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1890
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:53:48] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1890
[2025-10-06 09:53:48] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:53:48] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:53:48] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:53:48] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758828
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88022
    [user_id] => 1890
)

[2025-10-06 09:53:48] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:53:49] [debug] MembershipOrderHandler: User data updated 1890
[2025-10-06 09:53:49] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:53:49] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1890
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88022
)

[2025-10-06 09:53:49] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:53:49] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:53:49] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758828
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88022
    [user_id] => 1890
)

[2025-10-06 09:53:49] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:53:49
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:53:49] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1890
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88022
)

[2025-10-06 09:53:49] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1890
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:53:49] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:53:49] [debug] Payment method set:  online
[2025-10-06 09:53:49] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:53:49] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:53:49] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:53:49] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:53:50] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:53:50] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:53:50] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:53:50] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:53:50] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:53:50] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:53:50] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:53:50] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:53:50] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:53:50] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1890
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:53:50] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:53:50] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:53:50] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:53:50] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:53:50] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1890
    [lgl_id] => 944857
)

[2025-10-06 09:53:50] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:53:50] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:53:51] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:53:51] [debug] âŒ Error creating membership object Array
(
    [uid] => 1890
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:53:51] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 437
)

[2025-10-06 09:53:51] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1890
    [success] => Registration call completed
)

[2025-10-06 09:53:51] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1890
    [lgl_api_called] => YES
)

[2025-10-06 09:53:51] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:53:51] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88022
    [user_id] => 1890
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:53:51] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:53:51] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:53:51] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88022
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:54:28] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88023
    [timestamp] => 2025-10-06 09:54:28
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:54:28] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88023
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1891
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:54:28
    [item_count] => 0
)

[2025-10-06 09:54:28] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1891
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:54:28] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1891
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:54:28] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:54:28] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:54:28] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1891
    [order_id] => 88023
)

[2025-10-06 09:54:28] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:54:28] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88023
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:54:28] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:54:28] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88023
    [product_id] => 67487
)

[2025-10-06 09:54:28] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:54:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88023
    [timestamp] => 2025-10-06 09:54:29
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:54:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88023
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1891
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:54:28
    [item_count] => 1
)

[2025-10-06 09:54:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1891
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:54:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1891
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:54:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:54:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:54:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1891
    [order_id] => 88023
)

[2025-10-06 09:54:29] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:54:29] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:54:29] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:54:29] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1891
    [order_id] => 88023
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:54:29] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:54:29] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1891
    [order_id] => 88023
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:54:29
)

[2025-10-06 09:54:29] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:54:29] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:54:29] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:54:29] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:54:29] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:54:29] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:54:29] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:54:29] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1891
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:54:29] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1891
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:54:29] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1891
[2025-10-06 09:54:29] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:54:29] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:54:29] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:54:29] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758868
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88023
    [user_id] => 1891
)

[2025-10-06 09:54:29] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:54:29] [debug] MembershipOrderHandler: User data updated 1891
[2025-10-06 09:54:29] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:54:29] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1891
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88023
)

[2025-10-06 09:54:29] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:54:29] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:54:29] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758868
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88023
    [user_id] => 1891
)

[2025-10-06 09:54:29] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:54:29
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:54:29] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1891
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88023
)

[2025-10-06 09:54:29] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1891
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:54:29] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:54:29] [debug] Payment method set:  online
[2025-10-06 09:54:29] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:54:29] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:54:29] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:54:29] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:54:30] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:54:30] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:54:30] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:54:30] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:54:30] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:54:30] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:54:30] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:54:30] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:54:30] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:54:30] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1891
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:54:30] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:54:30] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:54:30] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:54:30] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:54:30] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1891
    [lgl_id] => 944857
)

[2025-10-06 09:54:30] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:54:30] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:54:30] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:54:30] [debug] âŒ Error creating membership object Array
(
    [uid] => 1891
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:54:30] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 441
)

[2025-10-06 09:54:30] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1891
    [success] => Registration call completed
)

[2025-10-06 09:54:30] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1891
    [lgl_api_called] => YES
)

[2025-10-06 09:54:30] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:54:30] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88023
    [user_id] => 1891
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:54:30] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:54:30] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:54:30] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88023
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:54:54] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88024
    [timestamp] => 2025-10-06 09:54:54
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:54:54] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88024
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1892
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:54:54
    [item_count] => 0
)

[2025-10-06 09:54:54] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1892
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:54:54] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1892
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:54:54] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:54:54] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:54:54] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1892
    [order_id] => 88024
)

[2025-10-06 09:54:54] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:54:54] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88024
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:54:54] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:54:54] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88024
    [product_id] => 67487
)

[2025-10-06 09:54:55] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:54:55] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88024
    [timestamp] => 2025-10-06 09:54:55
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:54:55] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88024
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1892
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:54:54
    [item_count] => 1
)

[2025-10-06 09:54:55] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1892
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:54:55] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1892
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:54:55] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:54:55] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:54:55] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1892
    [order_id] => 88024
)

[2025-10-06 09:54:55] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:54:55] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:54:55] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:54:55] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1892
    [order_id] => 88024
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:54:55] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:54:55] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1892
    [order_id] => 88024
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:54:55
)

[2025-10-06 09:54:55] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:54:55] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:54:55] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:54:55] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:54:55] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:54:55] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:54:55] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:54:55] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1892
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:54:55] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1892
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:54:55] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1892
[2025-10-06 09:54:55] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:54:55] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:54:55] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:54:55] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758894
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88024
    [user_id] => 1892
)

[2025-10-06 09:54:55] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:54:55] [debug] MembershipOrderHandler: User data updated 1892
[2025-10-06 09:54:55] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:54:55] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1892
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88024
)

[2025-10-06 09:54:55] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:54:55] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:54:55] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758894
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88024
    [user_id] => 1892
)

[2025-10-06 09:54:55] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:54:55
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:54:55] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1892
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88024
)

[2025-10-06 09:54:55] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1892
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:54:55] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:54:55] [debug] Payment method set:  online
[2025-10-06 09:54:55] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:54:55] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:54:55] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:54:55] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:54:56] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:54:56] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:54:56] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:54:56] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:54:56] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:54:56] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:54:56] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:54:56] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:54:56] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:54:56] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1892
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:54:56] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:54:56] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:54:56] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:54:56] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:54:56] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1892
    [lgl_id] => 944857
)

[2025-10-06 09:54:56] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:54:56] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:54:57] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:54:57] [debug] âŒ Error creating membership object Array
(
    [uid] => 1892
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:54:57] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 448
)

[2025-10-06 09:54:57] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1892
    [success] => Registration call completed
)

[2025-10-06 09:54:57] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1892
    [lgl_api_called] => YES
)

[2025-10-06 09:54:57] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:54:57] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88024
    [user_id] => 1892
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:54:57] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:54:57] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:54:57] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88024
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:55:47] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88025
    [timestamp] => 2025-10-06 09:55:47
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:55:47] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88025
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1893
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:55:47
    [item_count] => 0
)

[2025-10-06 09:55:47] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1893
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:55:47] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1893
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:55:47] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:55:47] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:55:47] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1893
    [order_id] => 88025
)

[2025-10-06 09:55:47] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:55:47] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88025
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:55:47] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:55:47] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88025
    [product_id] => 67487
)

[2025-10-06 09:55:47] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:55:47] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88025
    [timestamp] => 2025-10-06 09:55:47
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:55:47] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88025
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1893
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:55:47
    [item_count] => 1
)

[2025-10-06 09:55:47] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1893
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:55:47] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1893
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:55:47] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:55:47] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:55:47] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1893
    [order_id] => 88025
)

[2025-10-06 09:55:47] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:55:47] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:55:47] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:55:47] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1893
    [order_id] => 88025
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:55:47] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:55:47] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1893
    [order_id] => 88025
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:55:47
)

[2025-10-06 09:55:47] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:55:47] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:55:47] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:55:47] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:55:47] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:55:47] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:55:47] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:55:47] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1893
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:55:47] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1893
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:55:47] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1893
[2025-10-06 09:55:47] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:55:47] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:55:47] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:55:47] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758947
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88025
    [user_id] => 1893
)

[2025-10-06 09:55:47] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:55:48] [debug] MembershipOrderHandler: User data updated 1893
[2025-10-06 09:55:48] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:55:48] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1893
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88025
)

[2025-10-06 09:55:48] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:55:48] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:55:48] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758947
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88025
    [user_id] => 1893
)

[2025-10-06 09:55:48] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:55:48
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:55:48] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1893
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88025
)

[2025-10-06 09:55:48] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1893
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:55:48] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:55:48] [debug] Payment method set:  online
[2025-10-06 09:55:48] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:55:48] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:55:48] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:55:48] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:55:48] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:55:48] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:55:48] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:55:48] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:55:48] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:55:48] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:55:48] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:55:48] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:55:48] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:55:48] [debug] ðŸš¨ CHECKPOINT: handleExistingConstituent method started Array
(
    [uid] => 1893
    [lgl_id] => 944857
    [method] => 
    [has_method] => 
)

[2025-10-06 09:55:48] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1893
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:55:48] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:55:48] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:55:48] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:55:48] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:55:48] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1893
    [lgl_id] => 944857
)

[2025-10-06 09:55:48] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:55:48] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:55:49] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:55:49] [debug] âŒ Error creating membership object Array
(
    [uid] => 1893
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:55:49] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 455
)

[2025-10-06 09:55:49] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1893
    [success] => Registration call completed
)

[2025-10-06 09:55:49] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1893
    [lgl_api_called] => YES
)

[2025-10-06 09:55:49] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:55:49] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88025
    [user_id] => 1893
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:55:49] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:55:49] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:55:49] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88025
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:56:09] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88026
    [timestamp] => 2025-10-06 09:56:09
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:56:09] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88026
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1894
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:56:09
    [item_count] => 0
)

[2025-10-06 09:56:09] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1894
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:56:09] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1894
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:56:09] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:56:09] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:56:09] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1894
    [order_id] => 88026
)

[2025-10-06 09:56:09] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:56:09] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88026
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:56:09] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:56:09] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88026
    [product_id] => 67487
)

[2025-10-06 09:56:09] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:56:09] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88026
    [timestamp] => 2025-10-06 09:56:09
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:56:09] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88026
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1894
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:56:09
    [item_count] => 1
)

[2025-10-06 09:56:09] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1894
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:56:09] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1894
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:56:09] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:56:09] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:56:09] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1894
    [order_id] => 88026
)

[2025-10-06 09:56:09] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:56:09] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:56:09] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:56:09] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1894
    [order_id] => 88026
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:56:09] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:56:09] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1894
    [order_id] => 88026
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:56:09
)

[2025-10-06 09:56:09] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:56:09] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:56:09] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:56:09] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:56:09] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:56:09] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:56:09] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:56:09] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1894
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:56:09] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1894
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:56:09] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1894
[2025-10-06 09:56:09] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:56:09] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:56:09] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:56:09] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758969
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88026
    [user_id] => 1894
)

[2025-10-06 09:56:09] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:56:10] [debug] MembershipOrderHandler: User data updated 1894
[2025-10-06 09:56:10] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:56:10] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1894
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88026
)

[2025-10-06 09:56:10] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:56:10] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:56:10] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759758969
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88026
    [user_id] => 1894
)

[2025-10-06 09:56:10] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:56:10
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:56:10] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1894
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88026
)

[2025-10-06 09:56:10] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1894
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:56:10] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:56:10] [debug] Payment method set:  online
[2025-10-06 09:56:10] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:56:10] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:56:10] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:56:10] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:56:10] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:56:10] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:56:10] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:56:10] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:56:10] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:56:10] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:56:10] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:56:10] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:56:10] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:56:10] [debug] ðŸš¨ CHECKPOINT: handleExistingConstituent method started Array
(
    [uid] => 1894
    [lgl_id] => 944857
    [method] => 
    [has_method] => 
)

[2025-10-06 09:56:10] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1894
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:56:10] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:56:10] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:56:11] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:56:11] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:56:11] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1894
    [lgl_id] => 944857
)

[2025-10-06 09:56:11] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:56:11] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:56:11] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:56:11] [debug] âŒ Error creating membership object Array
(
    [uid] => 1894
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:56:11] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 455
)

[2025-10-06 09:56:11] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1894
    [success] => Registration call completed
)

[2025-10-06 09:56:11] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1894
    [lgl_api_called] => YES
)

[2025-10-06 09:56:11] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:56:11] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88026
    [user_id] => 1894
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:56:11] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:56:11] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:56:11] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88026
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:57:51] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88027
    [timestamp] => 2025-10-06 09:57:51
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:57:51] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88027
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1895
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:57:51
    [item_count] => 0
)

[2025-10-06 09:57:51] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1895
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:57:51] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1895
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:57:51] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:57:51] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:57:51] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1895
    [order_id] => 88027
)

[2025-10-06 09:57:51] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:57:51] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88027
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:57:51] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:57:51] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88027
    [product_id] => 67487
)

[2025-10-06 09:57:51] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:57:51] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88027
    [timestamp] => 2025-10-06 09:57:51
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:57:51] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88027
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1895
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:57:51
    [item_count] => 1
)

[2025-10-06 09:57:51] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1895
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:57:51] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1895
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:57:51] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:57:51] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:57:51] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1895
    [order_id] => 88027
)

[2025-10-06 09:57:51] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:57:51] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:57:51] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:57:51] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1895
    [order_id] => 88027
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:57:51] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:57:51] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1895
    [order_id] => 88027
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:57:51
)

[2025-10-06 09:57:51] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:57:51] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:57:51] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:57:51] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:57:51] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:57:51] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:57:51] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:57:51] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1895
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:57:51] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1895
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:57:51] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1895
[2025-10-06 09:57:51] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:57:51] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:57:51] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:57:51] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759071
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88027
    [user_id] => 1895
)

[2025-10-06 09:57:51] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:57:52] [debug] MembershipOrderHandler: User data updated 1895
[2025-10-06 09:57:52] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:57:52] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1895
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88027
)

[2025-10-06 09:57:52] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:57:52] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:57:52] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759071
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88027
    [user_id] => 1895
)

[2025-10-06 09:57:52] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:57:52
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:57:52] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1895
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88027
)

[2025-10-06 09:57:52] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1895
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:57:52] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:57:52] [debug] Payment method set:  online
[2025-10-06 09:57:52] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:57:52] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:57:52] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:57:52] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:57:52] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:57:52] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:57:52] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:57:52] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:57:52] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:57:52] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:57:52] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:57:52] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:57:52] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:57:52] [debug] ðŸš¨ CHECKPOINT: handleExistingConstituent method started Array
(
    [uid] => 1895
    [lgl_id] => 944857
    [method] => 
    [has_method] => 
)

[2025-10-06 09:57:52] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1895
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:57:52] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:57:52] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:57:53] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:57:53] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:57:53] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1895
    [lgl_id] => 944857
)

[2025-10-06 09:57:53] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:57:53] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:57:53] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:57:53] [debug] âŒ Error creating membership object Array
(
    [uid] => 1895
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:57:53] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 455
)

[2025-10-06 09:57:53] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1895
    [success] => Registration call completed
)

[2025-10-06 09:57:53] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1895
    [lgl_api_called] => YES
)

[2025-10-06 09:57:53] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:57:53] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88027
    [user_id] => 1895
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:57:53] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:57:53] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:57:53] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88027
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 09:58:23] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88028
    [timestamp] => 2025-10-06 09:58:23
    [memory_usage] => 150.8125MB
)

[2025-10-06 09:58:23] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88028
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1896
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:58:23
    [item_count] => 0
)

[2025-10-06 09:58:23] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1896
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 09:58:23] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1896
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:58:23] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 09:58:23] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:58:23] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1896
    [order_id] => 88028
)

[2025-10-06 09:58:23] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:58:23] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88028
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 09:58:23] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:58:23] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88028
    [product_id] => 67487
)

[2025-10-06 09:58:23] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 09:58:24] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88028
    [timestamp] => 2025-10-06 09:58:24
    [memory_usage] => 154.8125MB
)

[2025-10-06 09:58:24] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88028
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1896
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 09:58:23
    [item_count] => 1
)

[2025-10-06 09:58:24] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1896
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 09:58:24] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1896
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 09:58:24] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 09:58:24] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 09:58:24] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1896
    [order_id] => 88028
)

[2025-10-06 09:58:24] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 09:58:24] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 09:58:24] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 09:58:24] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1896
    [order_id] => 88028
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 09:58:24] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 09:58:24] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1896
    [order_id] => 88028
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 09:58:24
)

[2025-10-06 09:58:24] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 09:58:24] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 09:58:24] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 09:58:24] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 09:58:24] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 09:58:24] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 09:58:24] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 09:58:24] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1896
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 09:58:24] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1896
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 09:58:24] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1896
[2025-10-06 09:58:24] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 09:58:24] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 09:58:24] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 09:58:24] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759103
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88028
    [user_id] => 1896
)

[2025-10-06 09:58:24] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 09:58:24] [debug] MembershipOrderHandler: User data updated 1896
[2025-10-06 09:58:24] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 09:58:24] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1896
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88028
)

[2025-10-06 09:58:24] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 09:58:24] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 09:58:24] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759103
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88028
    [user_id] => 1896
)

[2025-10-06 09:58:24] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 09:58:24
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 09:58:24] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1896
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88028
)

[2025-10-06 09:58:24] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1896
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 09:58:24] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 09:58:24] [debug] Payment method set:  online
[2025-10-06 09:58:24] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 09:58:24] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 09:58:24] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 09:58:24] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 09:58:25] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 09:58:25] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 09:58:25] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 09:58:25] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 09:58:25] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 09:58:25] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:58:25] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 09:58:25] [debug] ðŸ”„ UserRegistrationAction: Handling existing LGL constituent...
[2025-10-06 09:58:25] [debug] UserRegistrationAction: FOUND LGL USER:  944857
[2025-10-06 09:58:25] [debug] ðŸš¨ CHECKPOINT: handleExistingConstituent method started Array
(
    [uid] => 1896
    [lgl_id] => 944857
    [method] => 
    [has_method] => 
)

[2025-10-06 09:58:25] [debug] ðŸ†• UserRegistrationAction: Adding membership to existing constituent Array
(
    [uid] => 1896
    [lgl_id] => 944857
    [membership_level] => Unknown
)

[2025-10-06 09:58:25] [debug] ðŸš« UserRegistrationAction: Deactivating existing memberships for constituent 944857
[2025-10-06 09:58:25] [debug] ðŸ” Connection::getConstituentData() Array
(
    [lgl_id] => 944857
)

[2025-10-06 09:58:25] [debug] âœ… Constituent data retrieved successfully
[2025-10-06 09:58:25] [debug] âš ï¸ No memberships found for constituent 944857
[2025-10-06 09:58:25] [debug] ðŸŽ« UserRegistrationAction: Creating membership object Array
(
    [uid] => 1896
    [lgl_id] => 944857
)

[2025-10-06 09:58:25] [debug] ðŸ“ Membership data created Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-06
    [finish_date] => 2026-10-06
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-06
    [parent_user_id] => 
)

[2025-10-06 09:58:25] [debug] âž• Connection::addMembership() Array
(
    [lgl_id] => 944857
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-06
            [finish_date] => 2026-10-06
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-06
            [parent_user_id] => 
        )

)

[2025-10-06 09:58:25] [debug] âŒ Failed to add membership Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"Membership level cannot be blank"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 09:58:25] [debug] âŒ Error creating membership object Array
(
    [uid] => 1896
    [lgl_id] => 944857
    [error] => Failed to create membership in LGL
)

[2025-10-06 09:58:25] [debug] âŒ UserRegistrationAction: Failed to add membership to existing constituent Array
(
    [error] => Failed to create membership in LGL
    [file] => /Users/andrewskinner/Local Sites/upstate-international/app/public/wp-content/plugins/Integrate-LGL/src/JetFormBuilder/Actions/UserRegistrationAction.php
    [line] => 455
)

[2025-10-06 09:58:25] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1896
    [success] => Registration call completed
)

[2025-10-06 09:58:25] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1896
    [lgl_api_called] => YES
)

[2025-10-06 09:58:25] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 09:58:25] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88028
    [user_id] => 1896
    [final_membership_level] => Individual Membership
)

[2025-10-06 09:58:25] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 09:58:25] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 09:58:25] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88028
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 10:06:11] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88029
    [timestamp] => 2025-10-06 10:06:11
    [memory_usage] => 150.8125MB
)

[2025-10-06 10:06:11] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88029
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1897
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:06:11
    [item_count] => 0
)

[2025-10-06 10:06:11] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1897
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 10:06:11] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1897
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:06:11] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 10:06:11] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:06:11] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1897
    [order_id] => 88029
)

[2025-10-06 10:06:11] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 10:06:11] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88029
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 10:06:11] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:06:11] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88029
    [product_id] => 67487
)

[2025-10-06 10:06:11] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:06:11] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88029
    [timestamp] => 2025-10-06 10:06:11
    [memory_usage] => 154.8125MB
)

[2025-10-06 10:06:11] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88029
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1897
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:06:11
    [item_count] => 1
)

[2025-10-06 10:06:11] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1897
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 10:06:11] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1897
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:06:11] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 10:06:11] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:06:11] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1897
    [order_id] => 88029
)

[2025-10-06 10:06:11] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 10:06:11] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 10:06:11] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 10:06:11] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1897
    [order_id] => 88029
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 10:06:11] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 10:06:11] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1897
    [order_id] => 88029
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 10:06:11
)

[2025-10-06 10:06:11] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 10:06:11] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 10:06:11] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 10:06:11] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 10:06:11] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 10:06:11] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 10:06:11] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 10:06:11] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1897
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 10:06:11] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1897
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 10:06:11] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1897
[2025-10-06 10:06:11] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 10:06:11] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 10:06:11] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 10:06:11] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759571
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88029
    [user_id] => 1897
)

[2025-10-06 10:06:11] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 10:06:12] [debug] MembershipOrderHandler: User data updated 1897
[2025-10-06 10:06:12] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 10:06:12] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1897
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88029
)

[2025-10-06 10:06:12] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 10:06:12] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 10:06:12] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759571
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88029
    [user_id] => 1897
)

[2025-10-06 10:06:12] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 10:06:12
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 10:06:12] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1897
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88029
)

[2025-10-06 10:06:12] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1897
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 10:06:12] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 10:06:12] [debug] Payment method set:  online
[2025-10-06 10:06:12] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 10:06:12] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 10:06:12] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 10:06:12] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 10:06:12] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 10:06:12] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 10:06:12] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 10:06:12] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 10:06:12] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 10:06:12] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 10:06:12] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 10:06:12] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-06 10:06:20] [debug] Membership cron jobs scheduled successfully
[2025-10-06 10:06:21] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-06 10:06:21] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-06 10:06:21] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 10:06:21] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 10:06:21] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 10:06:21] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 10:06:21] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 10:06:21] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 10:06:21] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88030
    [timestamp] => 2025-10-06 10:06:21
    [memory_usage] => 118MB
)

[2025-10-06 10:06:21] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88030
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1897
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:06:21
    [item_count] => 0
)

[2025-10-06 10:06:21] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1897
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 10:06:21] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1897
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:06:21] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 10:06:21] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:06:21] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1897
    [order_id] => 88030
)

[2025-10-06 10:06:21] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 10:06:21] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88030
    [final_memory_usage] => 118MB
)

[2025-10-06 10:06:22] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:06:22] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88030
    [product_id] => 67487
)

[2025-10-06 10:06:22] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:06:22] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88030
    [timestamp] => 2025-10-06 10:06:22
    [memory_usage] => 122MB
)

[2025-10-06 10:06:22] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88030
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1897
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:06:21
    [item_count] => 1
)

[2025-10-06 10:06:22] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1897
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 10:06:22] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1897
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:06:22] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 10:06:22] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:06:22] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1897
    [order_id] => 88030
)

[2025-10-06 10:06:22] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 10:06:22] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 10:06:22] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 10:06:22] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1897
    [order_id] => 88030
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 10:06:22] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 10:06:22] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1897
    [order_id] => 88030
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 10:06:22
)

[2025-10-06 10:06:22] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 10:06:22] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 10:06:22] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 10:06:22] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 10:06:22] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 10:06:22] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 10:06:22] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 10:06:22] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1897
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 10:06:22] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1897
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 10:06:22] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1897
[2025-10-06 10:06:22] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 10:06:22] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 10:06:22] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 10:06:22] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759581
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88030
    [user_id] => 1897
)

[2025-10-06 10:06:22] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 10:06:22] [debug] MembershipOrderHandler: User data updated 1897
[2025-10-06 10:06:22] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 10:06:22] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1897
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88030
)

[2025-10-06 10:06:22] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 10:06:22] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 10:06:22] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759581
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88030
    [user_id] => 1897
)

[2025-10-06 10:06:22] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 10:06:22
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 10:06:22] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1897
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88030
)

[2025-10-06 10:06:22] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1897
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 10:06:22] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 10:06:22] [debug] Payment method set:  online
[2025-10-06 10:06:22] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 10:06:22] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 10:06:22] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 10:06:22] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 10:06:23] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 10:06:23] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 10:06:23] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 10:06:23] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 10:06:23] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 10:06:23] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 10:06:23] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 10:06:23] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-06 10:06:59] [debug] Membership cron jobs scheduled successfully
[2025-10-06 10:07:00] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-06 10:07:00] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-06 10:07:01] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 10:07:01] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 10:07:01] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 10:07:01] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 10:07:01] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 10:07:01] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 10:07:01] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88031
    [timestamp] => 2025-10-06 10:07:01
    [memory_usage] => 118MB
)

[2025-10-06 10:07:01] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88031
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1897
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:07:01
    [item_count] => 0
)

[2025-10-06 10:07:01] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1897
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 10:07:01] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1897
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:07:01] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 10:07:01] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:07:01] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1897
    [order_id] => 88031
)

[2025-10-06 10:07:01] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 10:07:01] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88031
    [final_memory_usage] => 118MB
)

[2025-10-06 10:07:01] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:07:01] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88031
    [product_id] => 67487
)

[2025-10-06 10:07:01] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:07:01] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88031
    [timestamp] => 2025-10-06 10:07:01
    [memory_usage] => 122MB
)

[2025-10-06 10:07:01] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88031
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1897
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:07:01
    [item_count] => 1
)

[2025-10-06 10:07:01] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1897
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 10:07:01] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1897
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:07:01] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 10:07:01] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:07:01] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1897
    [order_id] => 88031
)

[2025-10-06 10:07:01] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 10:07:01] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 10:07:01] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 10:07:01] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1897
    [order_id] => 88031
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 10:07:01] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 10:07:01] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1897
    [order_id] => 88031
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 10:07:01
)

[2025-10-06 10:07:01] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 10:07:01] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 10:07:01] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 10:07:01] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 10:07:01] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 10:07:01] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 10:07:01] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 10:07:01] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1897
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 10:07:01] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1897
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 10:07:01] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1897
[2025-10-06 10:07:01] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 10:07:01] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 10:07:01] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 10:07:01] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759621
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88031
    [user_id] => 1897
)

[2025-10-06 10:07:01] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 10:07:01] [debug] MembershipOrderHandler: User data updated 1897
[2025-10-06 10:07:01] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 10:07:01] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1897
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88031
)

[2025-10-06 10:07:01] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 10:07:01] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 10:07:01] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759621
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88031
    [user_id] => 1897
)

[2025-10-06 10:07:01] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 10:07:01
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 10:07:01] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1897
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88031
)

[2025-10-06 10:07:01] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1897
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 10:07:01] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 10:07:01] [debug] Payment method set:  online
[2025-10-06 10:07:01] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 10:07:01] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 10:07:01] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 10:07:01] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 10:07:02] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 10:07:02] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 10:07:02] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 10:07:02] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 10:07:02] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944857
)

[2025-10-06 10:07:02] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944857
)

[2025-10-06 10:07:02] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944857
    [found_existing] => YES
)

[2025-10-06 10:07:02] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-06 10:07:03] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944857
)

[2025-10-06 10:07:03] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-06 10:07:03] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944857
    [payment_data] => Array
        (
            [success] => 
            [error] => Order not found: 0
        )

)

[2025-10-06 10:07:03] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-06 10:07:03] [debug] âœ… Added payment object Array
(
    [payment_id] => 
)

[2025-10-06 10:07:03] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1897
    [lgl_id] => 944857
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-06 10:07:03] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1897
    [success] => Registration call completed
)

[2025-10-06 10:07:03] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1897
    [lgl_api_called] => YES
)

[2025-10-06 10:07:03] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 10:07:03] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88031
    [user_id] => 1897
    [final_membership_level] => Individual Membership
)

[2025-10-06 10:07:03] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 10:07:03] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 10:07:03] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88031
    [final_memory_usage] => 122MB
)

[2025-10-06 10:08:18] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88032
    [timestamp] => 2025-10-06 10:08:18
    [memory_usage] => 150.8125MB
)

[2025-10-06 10:08:18] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88032
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1898
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:08:18
    [item_count] => 0
)

[2025-10-06 10:08:18] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1898
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 10:08:18] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1898
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:08:18] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 10:08:18] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:08:18] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1898
    [order_id] => 88032
)

[2025-10-06 10:08:18] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 10:08:18] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88032
    [final_memory_usage] => 150.8125MB
)

[2025-10-06 10:08:18] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:08:18] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88032
    [product_id] => 67487
)

[2025-10-06 10:08:18] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:08:19] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88032
    [timestamp] => 2025-10-06 10:08:19
    [memory_usage] => 154.8125MB
)

[2025-10-06 10:08:19] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88032
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1898
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:08:18
    [item_count] => 1
)

[2025-10-06 10:08:19] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1898
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 10:08:19] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1898
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:08:19] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 10:08:19] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:08:19] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1898
    [order_id] => 88032
)

[2025-10-06 10:08:19] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 10:08:19] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 10:08:19] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 10:08:19] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1898
    [order_id] => 88032
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 10:08:19] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 10:08:19] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1898
    [order_id] => 88032
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 10:08:19
)

[2025-10-06 10:08:19] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 10:08:19] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 10:08:19] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 10:08:19] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 10:08:19] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 10:08:19] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 10:08:19] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 10:08:19] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1898
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 10:08:19] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1898
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 10:08:19] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1898
[2025-10-06 10:08:19] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 10:08:19] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 10:08:19] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 10:08:19] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759698
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88032
    [user_id] => 1898
)

[2025-10-06 10:08:19] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 10:08:19] [debug] MembershipOrderHandler: User data updated 1898
[2025-10-06 10:08:19] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 10:08:19] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1898
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88032
)

[2025-10-06 10:08:19] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 10:08:19] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 10:08:19] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759698
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88032
    [user_id] => 1898
)

[2025-10-06 10:08:19] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 10:08:19
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 10:08:19] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1898
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88032
)

[2025-10-06 10:08:19] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1898
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 10:08:19] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 10:08:19] [debug] Payment method set:  online
[2025-10-06 10:08:19] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 10:08:19] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 10:08:19] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 10:08:19] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 10:08:20] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 10:08:20] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 10:08:20] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 10:08:20] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 10:08:20] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 946387
)

[2025-10-06 10:08:20] [debug] âœ… Email search match found Array
(
    [lgl_id] => 946387
)

[2025-10-06 10:08:20] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 946387
    [found_existing] => YES
)

[2025-10-06 10:08:20] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-06 10:08:21] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 946387
)

[2025-10-06 10:08:21] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-06 10:08:21] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1898
    [lgl_id] => 946387
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-06 10:08:21] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88032
    [price] => 77.63
    [date] => 2025-10-06
    [payment_type] => online
)

[2025-10-06 10:08:21] [debug] âŒ Payment creation failed Array
(
    [error] => Payment data creation failed: No payment types available for memberships
    [uid] => 1898
    [lgl_id] => 946387
)

[2025-10-06 10:08:21] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1898
    [lgl_id] => 946387
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-06 10:08:21] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1898
    [success] => Registration call completed
)

[2025-10-06 10:08:21] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1898
    [lgl_api_called] => YES
)

[2025-10-06 10:08:21] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 10:08:21] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88032
    [user_id] => 1898
    [final_membership_level] => Individual Membership
)

[2025-10-06 10:08:21] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 10:08:21] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 10:08:21] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88032
    [final_memory_usage] => 154.8125MB
)

[2025-10-06 10:08:28] [debug] Membership cron jobs scheduled successfully
[2025-10-06 10:08:29] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-06 10:08:29] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-06 10:08:29] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 10:08:29] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 10:08:29] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 10:08:29] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 10:08:29] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 946377
)

[2025-10-06 10:08:29] [debug] âœ… Email search match found Array
(
    [lgl_id] => 946377
)

[2025-10-06 10:08:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88033
    [timestamp] => 2025-10-06 10:08:29
    [memory_usage] => 118MB
)

[2025-10-06 10:08:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88033
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1899
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:08:29
    [item_count] => 0
)

[2025-10-06 10:08:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1899
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-06 10:08:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1899
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:08:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-06 10:08:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:08:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1899
    [order_id] => 88033
)

[2025-10-06 10:08:29] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 10:08:29] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88033
    [final_memory_usage] => 118MB
)

[2025-10-06 10:08:29] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:08:29] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88033
    [product_id] => 67487
)

[2025-10-06 10:08:29] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-06 10:08:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88033
    [timestamp] => 2025-10-06 10:08:29
    [memory_usage] => 122MB
)

[2025-10-06 10:08:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88033
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1899
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-06 10:08:29
    [item_count] => 1
)

[2025-10-06 10:08:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1899
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-06 10:08:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1899
    [payment_method] => 
    [stored_as] => online
)

[2025-10-06 10:08:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-06 10:08:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-06 10:08:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1899
    [order_id] => 88033
)

[2025-10-06 10:08:29] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-06 10:08:29] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-06 10:08:29] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-06 10:08:29] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1899
    [order_id] => 88033
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-06 10:08:29] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-06 10:08:29] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1899
    [order_id] => 88033
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-06 10:08:29
)

[2025-10-06 10:08:29] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-06 10:08:29] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-06 10:08:29] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-06 10:08:29] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-06 10:08:29] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-06 10:08:29] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-06 10:08:29] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-06 10:08:29] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1899
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-06 10:08:29] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1899
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-06 10:08:29] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1899
[2025-10-06 10:08:29] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-06 10:08:29] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-06 10:08:29] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-06 10:08:29] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759709
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88033
    [user_id] => 1899
)

[2025-10-06 10:08:29] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-06 10:08:30] [debug] MembershipOrderHandler: User data updated 1899
[2025-10-06 10:08:30] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-06 10:08:30] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1899
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88033
)

[2025-10-06 10:08:30] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-06 10:08:30] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-06 10:08:30] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1759759709
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88033
    [user_id] => 1899
)

[2025-10-06 10:08:30] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-06 10:08:30
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-06 10:08:30] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1899
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88033
)

[2025-10-06 10:08:30] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1899
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-06 10:08:30] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-06 10:08:30] [debug] Payment method set:  online
[2025-10-06 10:08:30] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-06 10:08:30] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-06 10:08:30] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-06 10:08:30] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-06 10:08:31] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-06 10:08:31] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-06 10:08:31] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-06 10:08:31] [debug] âœ… Found 25 constituents with method 1
[2025-10-06 10:08:31] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 946377
)

[2025-10-06 10:08:31] [debug] âœ… Email search match found Array
(
    [lgl_id] => 946377
)

[2025-10-06 10:08:31] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 946377
    [found_existing] => YES
)

[2025-10-06 10:08:31] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-06 10:08:32] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 946377
)

[2025-10-06 10:08:32] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-06 10:08:32] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1899
    [lgl_id] => 946377
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-06 10:08:32] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88033
    [price] => 77.63
    [date] => 2025-10-06
    [payment_type] => online
)

[2025-10-06 10:08:32] [debug] âŒ Payment creation failed Array
(
    [error] => Payment data creation failed: No payment types available for memberships
    [uid] => 1899
    [lgl_id] => 946377
)

[2025-10-06 10:08:32] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1899
    [lgl_id] => 946377
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-06 10:08:32] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1899
    [success] => Registration call completed
)

[2025-10-06 10:08:32] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1899
    [lgl_api_called] => YES
)

[2025-10-06 10:08:32] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-06 10:08:32] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88033
    [user_id] => 1899
    [final_membership_level] => Individual Membership
)

[2025-10-06 10:08:32] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-06 10:08:32] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-06 10:08:32] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88033
    [final_memory_usage] => 122MB
)

[2025-10-10 14:17:39] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:17:39] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:17:39] [debug] Starting daily membership renewal check
[2025-10-10 14:17:39] [debug] Starting membership renewal processing
[2025-10-10 14:17:39] [debug] User 794: -406 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1118 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 795 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1853 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1119: -532 days until renewal
[2025-10-10 14:17:39] [debug] User 796: -259 days until renewal
[2025-10-10 14:17:39] [debug] User 1120: -480 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1559 - not in-person membership
[2025-10-10 14:17:39] [debug] User 797: -316 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1713 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1121: 355827 days until renewal
[2025-10-10 14:17:39] [debug] User 798: -398 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1787 - not in-person membership
[2025-10-10 14:17:39] [debug] User 799: -514 days until renewal
[2025-10-10 14:17:39] [debug] User 1122: -227 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1679 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1545 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1364 - not in-person membership
[2025-10-10 14:17:39] [debug] User 801: -314 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1335 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1642 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1432 - not in-person membership
[2025-10-10 14:17:39] [debug] User 802: -461 days until renewal
[2025-10-10 14:17:39] [debug] User 803: -267 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 804 - not in-person membership
[2025-10-10 14:17:39] [debug] User 805: -582 days until renewal
[2025-10-10 14:17:39] [debug] User 806: -444 days until renewal
[2025-10-10 14:17:39] [debug] User 807: -231 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1357 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1299 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1608 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1560 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1402 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1091: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1780 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1123 - not in-person membership
[2025-10-10 14:17:39] [debug] User 808: 355827 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1384 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1806 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1662 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1783 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1233: -176 days until renewal
[2025-10-10 14:17:39] [debug] User 809: 355827 days until renewal
[2025-10-10 14:17:39] [debug] User 810: -301 days until renewal
[2025-10-10 14:17:39] [debug] User 811: -421 days until renewal
[2025-10-10 14:17:39] [debug] User 812: -238 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1727 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1567 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1724 - not in-person membership
[2025-10-10 14:17:39] [debug] User 813: -273 days until renewal
[2025-10-10 14:17:39] [debug] User 814: 355827 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1599 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1729 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1230 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1309 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1248 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 815 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1268 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1124: -279 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1232 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1753 - not in-person membership
[2025-10-10 14:17:39] [debug] User 816: -343 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1362 - not in-person membership
[2025-10-10 14:17:39] [debug] User 817: -297 days until renewal
[2025-10-10 14:17:39] [debug] User 1092: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1804 - not in-person membership
[2025-10-10 14:17:39] [debug] User 818: -378 days until renewal
[2025-10-10 14:17:39] [debug] User 1125: -300 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 819 - not in-person membership
[2025-10-10 14:17:39] [debug] User 820: -443 days until renewal
[2025-10-10 14:17:39] [debug] User 821: -252 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1416 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1606 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1126: -385 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1412 - not in-person membership
[2025-10-10 14:17:39] [debug] User 822: 355827 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1658 - not in-person membership
[2025-10-10 14:17:39] [debug] User 823: -285 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 824 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1127: -538 days until renewal
[2025-10-10 14:17:39] [debug] User 825: -277 days until renewal
[2025-10-10 14:17:39] [debug] User 826: 87 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1631 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1128: -296 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1394 - not in-person membership
[2025-10-10 14:17:39] [debug] User 827: -231 days until renewal
[2025-10-10 14:17:39] [debug] User 1129: -574 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1615 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1613 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1290 - not in-person membership
[2025-10-10 14:17:39] [debug] User 828: -358 days until renewal
[2025-10-10 14:17:39] [debug] User 829: -458 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1820 - not in-person membership
[2025-10-10 14:17:39] [debug] User 830: -263 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1404 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1618 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1093: -261 days until renewal
[2025-10-10 14:17:39] [debug] User 831: -590 days until renewal
[2025-10-10 14:17:39] [debug] User 832: -325 days until renewal
[2025-10-10 14:17:39] [debug] User 1130: -498 days until renewal
[2025-10-10 14:17:39] [debug] User 833: -531 days until renewal
[2025-10-10 14:17:39] [debug] User 834: -412 days until renewal
[2025-10-10 14:17:39] [debug] User 835: -389 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1803 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1298 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 836 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1815 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1480 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 837 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1433 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1277 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1816 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1800 - not in-person membership
[2025-10-10 14:17:39] [debug] User 838: 137 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1851 - not in-person membership
[2025-10-10 14:17:39] [debug] User 839: -407 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1682 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1779 - not in-person membership
[2025-10-10 14:17:39] [debug] User 840: -299 days until renewal
[2025-10-10 14:17:39] [debug] User 1094: -506 days until renewal
[2025-10-10 14:17:39] [debug] User 1131: -419 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1546 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1329 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1132 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1095: 95 days until renewal
[2025-10-10 14:17:39] [debug] User 841: -283 days until renewal
[2025-10-10 14:17:39] [debug] User 1087: 355827 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1730 - not in-person membership
[2025-10-10 14:17:39] [debug] User 842: -414 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1312 - not in-person membership
[2025-10-10 14:17:39] [debug] User 843: -252 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1096 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1417 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1625 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1376 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1822 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1771 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1594 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1764 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1478 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1133 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1502 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1784 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1414 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1735 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1097: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 844 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1134: -566 days until renewal
[2025-10-10 14:17:39] [debug] User 845: -245 days until renewal
[2025-10-10 14:17:39] [debug] User 846: -231 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1266 - not in-person membership
[2025-10-10 14:17:39] [debug] User 847: -414 days until renewal
[2025-10-10 14:17:39] [debug] User 1135: -521 days until renewal
[2025-10-10 14:17:39] [debug] User 848: -290 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1652 - not in-person membership
[2025-10-10 14:17:39] [debug] User 849: -432 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1296 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1427 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1257 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1430 - not in-person membership
[2025-10-10 14:17:39] [debug] User 850: -270 days until renewal
[2025-10-10 14:17:39] [debug] User 851: -271 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1634 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1641 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1136: -500 days until renewal
[2025-10-10 14:17:39] [debug] User 1137: -575 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1138 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1368 - not in-person membership
[2025-10-10 14:17:39] [debug] User 852: -519 days until renewal
[2025-10-10 14:17:39] [debug] User 853: -529 days until renewal
[2025-10-10 14:17:39] [debug] User 854: -260 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1825 - not in-person membership
[2025-10-10 14:17:39] [debug] User 855: -414 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1540 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1508 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1805 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1428 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1782 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 856 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 857 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1273 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1616 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1760 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1140 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 858 - not in-person membership
[2025-10-10 14:17:39] [debug] User 859: -525 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1344 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1667 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1141: -299 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 860 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1858 - not in-person membership
[2025-10-10 14:17:39] [debug] User 861: -264 days until renewal
[2025-10-10 14:17:39] [debug] User 1142: -573 days until renewal
[2025-10-10 14:17:39] [debug] User 862: -530 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1854 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 863 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1143: -469 days until renewal
[2025-10-10 14:17:39] [debug] User 864: -245 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 865 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 866 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1144: -562 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1280 - not in-person membership
[2025-10-10 14:17:39] [debug] User 867: -524 days until renewal
[2025-10-10 14:17:39] [debug] User 1145: -424 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1601 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1398 - not in-person membership
[2025-10-10 14:17:39] [debug] User 868: -268 days until renewal
[2025-10-10 14:17:39] [debug] User 869: -418 days until renewal
[2025-10-10 14:17:39] [debug] User 870: -429 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1245 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1513 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1630 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1736 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1146 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1147: -273 days until renewal
[2025-10-10 14:17:39] [debug] User 871: -278 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1341 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1812 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1098: 103 days until renewal
[2025-10-10 14:17:39] [debug] User 1099: -261 days until renewal
[2025-10-10 14:17:39] [debug] User 872: -413 days until renewal
[2025-10-10 14:17:39] [debug] User 873: -266 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1744 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1702 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1088: -504 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1288 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1148 - not in-person membership
[2025-10-10 14:17:39] [debug] User 874: -277 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 875 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1715 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1824 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1714 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1149: -224 days until renewal
[2025-10-10 14:17:39] [debug] User 876: -408 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1443 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1525 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1655 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 877 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1150: -287 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1777 - not in-person membership
[2025-10-10 14:17:39] [debug] User 878: -399 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 879 - not in-person membership
[2025-10-10 14:17:39] [debug] User 880: -274 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1550 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1354 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1378 - not in-person membership
[2025-10-10 14:17:39] [debug] User 881: -461 days until renewal
[2025-10-10 14:17:39] [debug] User 882: -518 days until renewal
[2025-10-10 14:17:39] [debug] User 883: 151 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1632 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1221 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 884 - not in-person membership
[2025-10-10 14:17:39] [debug] User 885: -337 days until renewal
[2025-10-10 14:17:39] [debug] User 886: -520 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1619 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1786 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1291 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1152: -395 days until renewal
[2025-10-10 14:17:39] [debug] User 887: -283 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1775 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1790 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1620 - not in-person membership
[2025-10-10 14:17:39] [debug] User 888: -573 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1742 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1153 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 889 - not in-person membership
[2025-10-10 14:17:39] [debug] User 890: -407 days until renewal
[2025-10-10 14:17:39] [debug] User 1154: -422 days until renewal
[2025-10-10 14:17:39] [debug] User 891: -535 days until renewal
[2025-10-10 14:17:39] [debug] User 892: -308 days until renewal
[2025-10-10 14:17:39] [debug] User 1155: -524 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1156 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1157: -513 days until renewal
[2025-10-10 14:17:39] [debug] User 893: -498 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1287 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1338 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1158: -506 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1551 - not in-person membership
[2025-10-10 14:17:39] [debug] User 894: -586 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1509 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1664 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 895 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1811 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1251 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1718 - not in-person membership
[2025-10-10 14:17:39] [debug] User 896: -548 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1481 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1549 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1159: -224 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1571 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1748 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1304 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1317 - not in-person membership
[2025-10-10 14:17:39] [debug] User 897: 355827 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1603 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1564 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1302 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 898 - not in-person membership
[2025-10-10 14:17:39] [debug] User 899: -270 days until renewal
[2025-10-10 14:17:39] [debug] User 900: -574 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1554 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1386 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 901 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1465 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1855 - not in-person membership
[2025-10-10 14:17:39] [debug] User 902: -468 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1316 - not in-person membership
[2025-10-10 14:17:39] [debug] User 903: -512 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1666 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1431 - not in-person membership
[2025-10-10 14:17:39] [debug] User 904: -281 days until renewal
[2025-10-10 14:17:39] [debug] User 1160: -255 days until renewal
[2025-10-10 14:17:39] [debug] User 905: -260 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1355 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1605 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1810 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1289 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 906 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 907 - not in-person membership
[2025-10-10 14:17:39] [debug] User 908: -397 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1239 - not in-person membership
[2025-10-10 14:17:39] [debug] User 909: -526 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 910 - not in-person membership
[2025-10-10 14:17:39] [debug] User 911: -308 days until renewal
[2025-10-10 14:17:39] [debug] User 912: -572 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1425 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1759 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 913 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1161 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1100: 95 days until renewal
[2025-10-10 14:17:39] [debug] User 1101: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1381 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1089: 355827 days until renewal
[2025-10-10 14:17:39] [debug] User 1162: -278 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1469 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1860 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1552 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1315 - not in-person membership
[2025-10-10 14:17:39] [debug] User 914: -448 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1426 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1406 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1595 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1665 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1676 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1597 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1624 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1405 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1336 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1795 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 915 - not in-person membership
[2025-10-10 14:17:39] [debug] User 916: -253 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1773 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 917 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 918 - not in-person membership
[2025-10-10 14:17:39] [debug] User 919: -531 days until renewal
[2025-10-10 14:17:39] [debug] User 920: -415 days until renewal
[2025-10-10 14:17:39] [debug] User 921: -413 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1798 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1423 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1638 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1675 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1163: -472 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1848 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1563 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1409 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1250 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1339 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1797 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1267 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1796 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1670 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1382 - not in-person membership
[2025-10-10 14:17:39] [debug] User 922: -287 days until renewal
[2025-10-10 14:17:39] [debug] User 1103: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1447 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1235 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 923 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1264 - not in-person membership
[2025-10-10 14:17:39] [debug] User 924: -586 days until renewal
[2025-10-10 14:17:39] [debug] User 925: -291 days until renewal
[2025-10-10 14:17:39] [debug] User 1164: -475 days until renewal
[2025-10-10 14:17:39] [debug] User 926: -445 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1589 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1534 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1609 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1556 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1285 - not in-person membership
[2025-10-10 14:17:39] [debug] User 927: -286 days until renewal
[2025-10-10 14:17:39] [debug] User 928: -280 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1345 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1750 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1612 - not in-person membership
[2025-10-10 14:17:39] [debug] User 929: -277 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1165 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1817 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1770 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 930 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1166: -280 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1400 - not in-person membership
[2025-10-10 14:17:39] [debug] User 931: 94 days until renewal
[2025-10-10 14:17:39] [debug] User 932: 355827 days until renewal
[2025-10-10 14:17:39] [debug] User 1167: -405 days until renewal
[2025-10-10 14:17:39] [debug] User 933: -271 days until renewal
[2025-10-10 14:17:39] [debug] User 934: -507 days until renewal
[2025-10-10 14:17:39] [debug] User 935: -396 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1819 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1761 - not in-person membership
[2025-10-10 14:17:39] [debug] User 936: -332 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1265 - not in-person membership
[2025-10-10 14:17:39] [debug] User 937: -588 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 938 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1308 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1168: -420 days until renewal
[2025-10-10 14:17:39] [debug] User 939: -257 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1169 - not in-person membership
[2025-10-10 14:17:39] [debug] User 940: 355827 days until renewal
[2025-10-10 14:17:39] [debug] User 1170: -587 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 941 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1633 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1222 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1390 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1611 - not in-person membership
[2025-10-10 14:17:39] [debug] User 942: -452 days until renewal
[2025-10-10 14:17:39] [debug] User 943: -294 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 944 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1366 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1231 - not in-person membership
[2025-10-10 14:17:39] [debug] User 945: -417 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1387 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1411 - not in-person membership
[2025-10-10 14:17:39] [debug] User 946: -422 days until renewal
[2025-10-10 14:17:39] [debug] User 1104: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 947 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1766 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 948 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1557 - not in-person membership
[2025-10-10 14:17:39] [debug] User 949: -406 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1644 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1333 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1225 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1627 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1808 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1754 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1849 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1234 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 950 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1793 - not in-person membership
[2025-10-10 14:17:39] [debug] User 951: -400 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1172 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1450 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1562 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1622 - not in-person membership
[2025-10-10 14:17:39] [debug] User 952: -533 days until renewal
[2025-10-10 14:17:39] [debug] User 953: 355827 days until renewal
[2025-10-10 14:17:39] [debug] User 954: -412 days until renewal
[2025-10-10 14:17:39] [debug] User 955: -333 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1838 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1173 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1772 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1569 - not in-person membership
[2025-10-10 14:17:39] [debug] User 957: -503 days until renewal
[2025-10-10 14:17:39] [debug] User 958: -231 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1530 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1342 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 959 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1801 - not in-person membership
[2025-10-10 14:17:39] [debug] User 960: -407 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1399 - not in-person membership
[2025-10-10 14:17:39] [debug] User 961: -251 days until renewal
[2025-10-10 14:17:39] [debug] User 962: -271 days until renewal
[2025-10-10 14:17:39] [debug] User 963: -384 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1419 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1445 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1359 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1371 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1774 - not in-person membership
[2025-10-10 14:17:39] [debug] User 965: -253 days until renewal
[2025-10-10 14:17:39] [debug] User 966: -272 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1617 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1794 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1353 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1174: -424 days until renewal
[2025-10-10 14:17:39] [debug] User 967: 111 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1710 - not in-person membership
[2025-10-10 14:17:39] [debug] User 968: -397 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1756 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1175: -293 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1176 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1482 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1555 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 969 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1436 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1799 - not in-person membership
[2025-10-10 14:17:39] [debug] User 970: -430 days until renewal
[2025-10-10 14:17:39] [debug] User 971: -496 days until renewal
[2025-10-10 14:17:39] [debug] User 972: 355827 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1177 - not in-person membership
[2025-10-10 14:17:39] [debug] User 973: -506 days until renewal
[2025-10-10 14:17:39] [debug] User 1105: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1852 - not in-person membership
[2025-10-10 14:17:39] [debug] User 974: -475 days until renewal
[2025-10-10 14:17:39] [debug] User 975: -277 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1458 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1526 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1614 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1424 - not in-person membership
[2025-10-10 14:17:39] [debug] User 976: -263 days until renewal
[2025-10-10 14:17:39] [debug] User 977: -384 days until renewal
[2025-10-10 14:17:39] [debug] User 1178: -581 days until renewal
[2025-10-10 14:17:39] [debug] User 978: -388 days until renewal
[2025-10-10 14:17:39] [debug] User 979: -385 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 980 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1218: -212 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1327 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1659 - not in-person membership
[2025-10-10 14:17:39] [debug] User 981: -548 days until renewal
[2025-10-10 14:17:39] [debug] User 1106: -261 days until renewal
[2025-10-10 14:17:39] [debug] User 982: -420 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1769 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1732 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1179 - not in-person membership
[2025-10-10 14:17:39] [debug] User 983: -414 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1300 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 984 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1636 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1635 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1721 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1536 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1180: -429 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1228 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1181: -231 days until renewal
[2025-10-10 14:17:39] [debug] User 985: -254 days until renewal
[2025-10-10 14:17:39] [debug] User 1182: -527 days until renewal
[2025-10-10 14:17:39] [debug] User 986: -278 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1444 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 987 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1660 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1639 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1763 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 988 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1107: 82 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1183 - not in-person membership
[2025-10-10 14:17:39] [debug] User 989: -526 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1184 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1216: -217 days until renewal
[2025-10-10 14:17:39] [debug] User 990: -431 days until renewal
[2025-10-10 14:17:39] [debug] User 991: -273 days until renewal
[2025-10-10 14:17:39] [debug] User 992: -512 days until renewal
[2025-10-10 14:17:39] [debug] User 993: -519 days until renewal
[2025-10-10 14:17:39] [debug] User 994: -511 days until renewal
[2025-10-10 14:17:39] [debug] User 995: -522 days until renewal
[2025-10-10 14:17:39] [debug] User 996: -588 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1446 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1643 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 997 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1224 - not in-person membership
[2025-10-10 14:17:39] [debug] User 998: -504 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1607 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1584 - not in-person membership
[2025-10-10 14:17:39] [debug] User 999: -384 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1826 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1185: -539 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1186 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1649 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1000: -582 days until renewal
[2025-10-10 14:17:39] [debug] User 1187: -413 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1441 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1001: -245 days until renewal
[2025-10-10 14:17:39] [debug] User 1002: -475 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1188 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1003: -566 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1696 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1722 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1005: -295 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1752 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1006: -571 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1593 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1389 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1007: -434 days until renewal
[2025-10-10 14:17:39] [debug] User 1008: -507 days until renewal
[2025-10-10 14:17:39] [debug] User 1189: -511 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1190 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1009: -387 days until renewal
[2025-10-10 14:17:39] [debug] User 1010: -273 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1435 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1765 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1108: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1637 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1191 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1807 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1109: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1420 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1242 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1192: -439 days until renewal
[2025-10-10 14:17:39] [debug] User 1011: -448 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1012 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1193: -521 days until renewal
[2025-10-10 14:17:39] [debug] User 1013: -333 days until renewal
[2025-10-10 14:17:39] [debug] User 1194: -239 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1195 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1196 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1197: -520 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1198 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1629 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1454 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1014: 355827 days until renewal
[2025-10-10 14:17:39] [debug] User 1199: -415 days until renewal
[2025-10-10 14:17:39] [debug] User 1200: -297 days until renewal
[2025-10-10 14:17:39] [debug] User 1015: -574 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1016 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1747 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1401 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1017: -477 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1610 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1493 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1018 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1523 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1110 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1019: 24 days until renewal
[2025-10-10 14:17:39] [debug] User 1111: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1020 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1254 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1021: -252 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1022 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1262 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1023: -273 days until renewal
[2025-10-10 14:17:39] [debug] User 1201: -303 days until renewal
[2025-10-10 14:17:39] [debug] User 1202: -46 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1751 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1203: -427 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1024 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1025: -369 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1592 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1857 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1442 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1026 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1027: -591 days until renewal
[2025-10-10 14:17:39] [debug] User 1028: -363 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1029 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1030 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1717 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1581 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1031: -567 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1565 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1578 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1654 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1476 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1572 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1346 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1363 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1204: -319 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1223 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1032: -420 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1033 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1034: -381 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1577 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1035 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1205: -466 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1818 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1036: -278 days until renewal
[2025-10-10 14:17:39] [debug] User 1037: -525 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1292 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1038: -511 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1039 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1437 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1579 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1253 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1464 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1283 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1206: -577 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1040 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1112 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1259 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1042: -233 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1275 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1260 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1043: -516 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1241 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1044: -276 days until renewal
[2025-10-10 14:17:39] [debug] User 1045: -552 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1621 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1591 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1046 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1047: -506 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1048 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1657 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1788 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1537 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1049: -582 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1440 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1661 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1383 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1313 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1050: -351 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1548 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1542 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1410 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1361 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1749 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1237 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1051: -537 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1306 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1052: -415 days until renewal
[2025-10-10 14:17:39] [debug] User 1053: -415 days until renewal
[2025-10-10 14:17:39] [debug] User 1217: -213 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1623 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1582 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1054: -224 days until renewal
[2025-10-10 14:17:39] [debug] User 1055: -570 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1575 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1473 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1056: -405 days until renewal
[2025-10-10 14:17:39] [debug] User 1057: -244 days until renewal
[2025-10-10 14:17:39] [debug] User 1058: -428 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1789 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1365 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1059: -425 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1060 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1061: -406 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1429 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1653 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1439 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1278 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1678 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1561 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1062: 355827 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1755 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1063: -567 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1113 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1064: -507 days until renewal
[2025-10-10 14:17:39] [debug] User 1065: -278 days until renewal
[2025-10-10 14:17:39] [debug] User 1219: -211 days until renewal
[2025-10-10 14:17:39] [debug] User 1066: -581 days until renewal
[2025-10-10 14:17:39] [debug] User 1114: -261 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 359 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1535 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1574 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1802 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1115 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1207 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1293 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1067: -565 days until renewal
[2025-10-10 14:17:39] [debug] User 1068: -405 days until renewal
[2025-10-10 14:17:39] [debug] User 1208: -404 days until renewal
[2025-10-10 14:17:39] [debug] User 1069: 104 days until renewal
[2025-10-10 14:17:39] [debug] User 1116: 103 days until renewal
[2025-10-10 14:17:39] [debug] User 1070: -347 days until renewal
[2025-10-10 14:17:39] [debug] User 1071: -301 days until renewal
[2025-10-10 14:17:39] [debug] User 1072: -532 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1073 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1781 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1553 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1074: -410 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1408 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1418 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1768 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1210: -252 days until renewal
[2025-10-10 14:17:39] [debug] User 1075: -581 days until renewal
[2025-10-10 14:17:39] [debug] User 1076: 355827 days until renewal
[2025-10-10 14:17:39] [debug] User 1077: -418 days until renewal
[2025-10-10 14:17:39] [debug] User 1211: -325 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1090 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1078: -286 days until renewal
[2025-10-10 14:17:39] [debug] User 1079: -406 days until renewal
[2025-10-10 14:17:39] [debug] User 1212: -280 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1726 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1809 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1080 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1081 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1082: -273 days until renewal
[2025-10-10 14:17:39] [debug] User 1213: -579 days until renewal
[2025-10-10 14:17:39] [debug] User 1083: -567 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1856 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1085: -536 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1261 - not in-person membership
[2025-10-10 14:17:39] [debug] Skipping user 1741 - not in-person membership
[2025-10-10 14:17:39] [debug] User 1086: -511 days until renewal
[2025-10-10 14:17:39] [debug] Skipping user 1276 - not in-person membership
[2025-10-10 14:17:39] [debug] Membership renewal processing completed Array
(
    [processed] => 778
    [notified] => 0
    [deactivated] => 0
    [skipped] => 778
    [errors] => Array
        (
        )

)

[2025-10-10 14:17:39] [debug] Daily membership check completed Array
(
    [execution_time_ms] => 168.87
    [results] => Array
        (
            [processed] => 778
            [notified] => 0
            [deactivated] => 0
            [skipped] => 778
            [errors] => Array
                (
                )

        )

)

[2025-10-10 14:17:43] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:17:45] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:17:46] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:44:09] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:44:10] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:44:11] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:44:35] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:44:37] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:44:38] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:44:44] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:44:45] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:44:45] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:13] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:13] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:14] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:14] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:15] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:15] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:23] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:23] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:24] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:25] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:27] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:32] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:55:34] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:57:45] [debug] Membership cron jobs scheduled successfully
[2025-10-10 14:57:47] [debug] Membership cron jobs scheduled successfully
[2025-10-10 15:01:47] [debug] Membership cron jobs scheduled successfully
[2025-10-10 15:01:48] [debug] Membership cron jobs scheduled successfully
[2025-10-10 15:06:58] [debug] Membership cron jobs scheduled successfully
[2025-10-10 15:06:59] [debug] Membership cron jobs scheduled successfully
[2025-10-10 15:07:01] [debug] Membership cron jobs scheduled successfully
[2025-10-10 15:07:02] [debug] Membership cron jobs scheduled successfully
[2025-10-10 15:08:07] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:38:05] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:38:07] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:38:07] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:38:07] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:38:08] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:38:08] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:38:09] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-11 02:38:09] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-11 02:38:10] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 02:38:10] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 02:38:10] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 02:38:10] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 02:38:10] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 946382
)

[2025-10-11 02:38:10] [debug] âœ… Email search match found Array
(
    [lgl_id] => 946382
)

[2025-10-11 02:38:10] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88035
    [timestamp] => 2025-10-11 02:38:10
    [memory_usage] => 126MB
)

[2025-10-11 02:38:10] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88035
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1900
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 02:38:10
    [item_count] => 0
)

[2025-10-11 02:38:10] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1900
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 02:38:10] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1900
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 02:38:10] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 02:38:10] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 02:38:10] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1900
    [order_id] => 88035
)

[2025-10-11 02:38:10] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 02:38:10] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88035
    [final_memory_usage] => 126MB
)

[2025-10-11 02:38:10] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 02:38:10] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88035
    [product_id] => 67487
)

[2025-10-11 02:38:10] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 02:38:10] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88035
    [timestamp] => 2025-10-11 02:38:10
    [memory_usage] => 130MB
)

[2025-10-11 02:38:10] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88035
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1900
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 02:38:10
    [item_count] => 1
)

[2025-10-11 02:38:10] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1900
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 02:38:10] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1900
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 02:38:10] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 02:38:10] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 02:38:10] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1900
    [order_id] => 88035
)

[2025-10-11 02:38:10] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 02:38:10] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 02:38:10] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 02:38:10] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1900
    [order_id] => 88035
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 02:38:10] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 02:38:10] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1900
    [order_id] => 88035
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 02:38:10
)

[2025-10-11 02:38:10] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 02:38:10] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 02:38:10] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 02:38:10] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 02:38:10] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 02:38:10] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 02:38:10] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 02:38:10] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1900
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 02:38:10] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1900
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 02:38:10] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1900
[2025-10-11 02:38:10] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 02:38:10] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 02:38:10] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 02:38:10] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760164690
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88035
    [user_id] => 1900
)

[2025-10-11 02:38:10] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 02:38:11] [debug] MembershipOrderHandler: User data updated 1900
[2025-10-11 02:38:11] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 02:38:11] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1900
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88035
)

[2025-10-11 02:38:11] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 02:38:11] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 02:38:11] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760164690
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88035
    [user_id] => 1900
)

[2025-10-11 02:38:11] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 02:38:11
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 02:38:11] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1900
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88035
)

[2025-10-11 02:38:11] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1900
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 02:38:11] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 02:38:11] [debug] Payment method set:  online
[2025-10-11 02:38:11] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 02:38:11] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 02:38:11] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 02:38:11] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 02:38:11] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 02:38:11] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 02:38:11] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 02:38:11] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 02:38:11] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 946382
)

[2025-10-11 02:38:11] [debug] âœ… Email search match found Array
(
    [lgl_id] => 946382
)

[2025-10-11 02:38:11] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 946382
    [found_existing] => YES
)

[2025-10-11 02:38:11] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 02:38:12] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 946382
)

[2025-10-11 02:38:12] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 02:38:12] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1900
    [lgl_id] => 946382
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 02:38:12] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88035
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 02:38:13] [debug] âŒ Payment creation failed Array
(
    [error] => Payment data creation failed: No payment types available for memberships
    [uid] => 1900
    [lgl_id] => 946382
)

[2025-10-11 02:38:13] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1900
    [lgl_id] => 946382
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 02:38:13] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1900
    [success] => Registration call completed
)

[2025-10-11 02:38:13] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1900
    [lgl_api_called] => YES
)

[2025-10-11 02:38:13] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 02:38:13] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88035
    [user_id] => 1900
    [final_membership_level] => Individual Membership
)

[2025-10-11 02:38:13] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 02:38:13] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 02:38:13] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88035
    [final_memory_usage] => 130MB
)

[2025-10-11 02:38:13] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:46:12] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:46:12] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:50:59] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:51:01] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:51:04] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:51:06] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:51:45] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:51:46] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:51:46] [debug] Membership cron jobs scheduled successfully
[2025-10-11 02:54:12] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88036
    [timestamp] => 2025-10-11 02:54:12
    [memory_usage] => 150.8125MB
)

[2025-10-11 02:54:12] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88036
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1901
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 02:54:12
    [item_count] => 0
)

[2025-10-11 02:54:12] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1901
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 02:54:12] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1901
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 02:54:12] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 02:54:12] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 02:54:12] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1901
    [order_id] => 88036
)

[2025-10-11 02:54:12] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 02:54:12] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88036
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 02:54:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 02:54:13] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88036
    [product_id] => 67487
)

[2025-10-11 02:54:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 02:54:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88036
    [timestamp] => 2025-10-11 02:54:13
    [memory_usage] => 154.8125MB
)

[2025-10-11 02:54:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88036
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1901
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 02:54:12
    [item_count] => 1
)

[2025-10-11 02:54:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1901
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 02:54:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1901
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 02:54:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 02:54:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 02:54:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1901
    [order_id] => 88036
)

[2025-10-11 02:54:13] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 02:54:13] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 02:54:13] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 02:54:13] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1901
    [order_id] => 88036
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 02:54:13] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 02:54:13] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1901
    [order_id] => 88036
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 02:54:13
)

[2025-10-11 02:54:13] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 02:54:13] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 02:54:13] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 02:54:13] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 02:54:13] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 02:54:13] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 02:54:13] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 02:54:13] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1901
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 02:54:13] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1901
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 02:54:13] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1901
[2025-10-11 02:54:13] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 02:54:13] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 02:54:13] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 02:54:13] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760165652
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88036
    [user_id] => 1901
)

[2025-10-11 02:54:13] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 02:54:13] [debug] MembershipOrderHandler: User data updated 1901
[2025-10-11 02:54:13] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 02:54:13] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1901
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88036
)

[2025-10-11 02:54:13] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 02:54:13] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 02:54:13] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760165652
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88036
    [user_id] => 1901
)

[2025-10-11 02:54:13] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 02:54:13
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 02:54:13] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1901
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88036
)

[2025-10-11 02:54:13] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1901
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 02:54:13] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 02:54:13] [debug] Payment method set:  online
[2025-10-11 02:54:13] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 02:54:13] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 02:54:13] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 02:54:13] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 02:54:14] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 02:54:14] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 02:54:14] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 02:54:14] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 02:54:14] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 946392
)

[2025-10-11 02:54:14] [debug] âœ… Email search match found Array
(
    [lgl_id] => 946392
)

[2025-10-11 02:54:14] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 946392
    [found_existing] => YES
)

[2025-10-11 02:54:14] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 02:54:15] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 946392
)

[2025-10-11 02:54:15] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 02:54:15] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1901
    [lgl_id] => 946392
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 02:54:15] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88036
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 02:54:15] [debug] âŒ Payment creation failed Array
(
    [error] => Payment data creation failed: No payment types available for memberships
    [uid] => 1901
    [lgl_id] => 946392
)

[2025-10-11 02:54:15] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1901
    [lgl_id] => 946392
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 02:54:15] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1901
    [success] => Registration call completed
)

[2025-10-11 02:54:15] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1901
    [lgl_api_called] => YES
)

[2025-10-11 02:54:15] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 02:54:15] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88036
    [user_id] => 1901
    [final_membership_level] => Individual Membership
)

[2025-10-11 02:54:15] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 02:54:15] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 02:54:15] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88036
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 02:54:37] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88037
    [timestamp] => 2025-10-11 02:54:37
    [memory_usage] => 150.8125MB
)

[2025-10-11 02:54:37] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88037
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1902
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 02:54:37
    [item_count] => 0
)

[2025-10-11 02:54:37] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1902
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 02:54:37] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1902
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 02:54:37] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 02:54:37] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 02:54:37] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1902
    [order_id] => 88037
)

[2025-10-11 02:54:37] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 02:54:37] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88037
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 02:54:37] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 02:54:37] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88037
    [product_id] => 67487
)

[2025-10-11 02:54:37] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 02:54:38] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88037
    [timestamp] => 2025-10-11 02:54:38
    [memory_usage] => 154.8125MB
)

[2025-10-11 02:54:38] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88037
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1902
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 02:54:37
    [item_count] => 1
)

[2025-10-11 02:54:38] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1902
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 02:54:38] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1902
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 02:54:38] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 02:54:38] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 02:54:38] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1902
    [order_id] => 88037
)

[2025-10-11 02:54:38] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 02:54:38] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 02:54:38] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 02:54:38] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1902
    [order_id] => 88037
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 02:54:38] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 02:54:38] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1902
    [order_id] => 88037
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 02:54:38
)

[2025-10-11 02:54:38] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 02:54:38] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 02:54:38] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 02:54:38] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 02:54:38] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 02:54:38] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 02:54:38] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 02:54:38] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1902
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 02:54:38] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1902
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 02:54:38] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1902
[2025-10-11 02:54:38] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 02:54:38] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 02:54:38] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 02:54:38] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760165677
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88037
    [user_id] => 1902
)

[2025-10-11 02:54:38] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 02:54:38] [debug] MembershipOrderHandler: User data updated 1902
[2025-10-11 02:54:38] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 02:54:38] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1902
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88037
)

[2025-10-11 02:54:38] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 02:54:38] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 02:54:38] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760165677
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88037
    [user_id] => 1902
)

[2025-10-11 02:54:38] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 02:54:38
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 02:54:38] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1902
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88037
)

[2025-10-11 02:54:38] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1902
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 02:54:38] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 02:54:38] [debug] Payment method set:  online
[2025-10-11 02:54:38] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 02:54:38] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 02:54:38] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 02:54:38] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 02:54:39] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 02:54:39] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 02:54:39] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 02:54:39] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 02:54:39] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 945017
)

[2025-10-11 02:54:39] [debug] âœ… Email search match found Array
(
    [lgl_id] => 945017
)

[2025-10-11 02:54:39] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 945017
    [found_existing] => YES
)

[2025-10-11 02:54:39] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 02:54:40] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 945017
)

[2025-10-11 02:54:40] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 02:54:40] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1902
    [lgl_id] => 945017
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 02:54:40] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88037
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 02:54:40] [debug] âŒ Payment creation failed Array
(
    [error] => Payment data creation failed: No payment types available for memberships
    [uid] => 1902
    [lgl_id] => 945017
)

[2025-10-11 02:54:40] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1902
    [lgl_id] => 945017
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 02:54:40] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1902
    [success] => Registration call completed
)

[2025-10-11 02:54:40] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1902
    [lgl_api_called] => YES
)

[2025-10-11 02:54:40] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 02:54:40] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88037
    [user_id] => 1902
    [final_membership_level] => Individual Membership
)

[2025-10-11 02:54:40] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 02:54:40] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 02:54:40] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88037
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:01:24] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88038
    [timestamp] => 2025-10-11 03:01:24
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:01:24] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88038
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1903
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:01:24
    [item_count] => 0
)

[2025-10-11 03:01:24] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1903
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:01:24] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1903
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:01:24] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:01:24] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:01:24] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1903
    [order_id] => 88038
)

[2025-10-11 03:01:24] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:01:24] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88038
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:01:24] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:01:24] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88038
    [product_id] => 67487
)

[2025-10-11 03:01:24] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:01:24] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88038
    [timestamp] => 2025-10-11 03:01:24
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:01:24] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88038
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1903
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:01:24
    [item_count] => 1
)

[2025-10-11 03:01:24] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1903
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:01:24] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1903
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:01:24] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:01:24] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:01:24] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1903
    [order_id] => 88038
)

[2025-10-11 03:01:24] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:01:24] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:01:24] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:01:24] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1903
    [order_id] => 88038
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:01:24] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:01:24] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1903
    [order_id] => 88038
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:01:24
)

[2025-10-11 03:01:24] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:01:24] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:01:24] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:01:24] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:01:24] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:01:24] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:01:24] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:01:24] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1903
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:01:24] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1903
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:01:24] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1903
[2025-10-11 03:01:24] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:01:24] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:01:24] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:01:24] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166084
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88038
    [user_id] => 1903
)

[2025-10-11 03:01:24] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:01:24] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:01:24] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:01:24] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1903
)

[2025-10-11 03:01:24] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1903
    [type] => Individual Membership
)

[2025-10-11 03:01:24] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1903
)

[2025-10-11 03:01:24] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:01:24] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88038
    [total] => 77.63
)

[2025-10-11 03:01:24] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:01:24] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:01:24] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:01:24] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1903
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:01:24] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:01:24] [debug] LGL Constituents: All data set for user 1903
[2025-10-11 03:01:25] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946702
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:01:25Z
            [updated_at] => 2025-10-11T07:01:25Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946702,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:01:25Z","updated_at":"2025-10-11T07:01:25Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:01:25] [debug] MembershipOrderHandler: User data updated 1903
[2025-10-11 03:01:25] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:01:25] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1903
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88038
)

[2025-10-11 03:01:25] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:01:25] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:01:25] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166084
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88038
    [user_id] => 1903
)

[2025-10-11 03:01:25] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:01:25
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:01:25] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1903
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88038
)

[2025-10-11 03:01:25] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1903
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:01:25] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:01:25] [debug] Payment method set:  online
[2025-10-11 03:01:25] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:01:25] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:01:25] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:01:25] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:01:25] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:01:25] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:01:25] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:01:25] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:01:25] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 945047
)

[2025-10-11 03:01:25] [debug] âœ… Email search match found Array
(
    [lgl_id] => 945047
)

[2025-10-11 03:01:25] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 945047
    [found_existing] => YES
)

[2025-10-11 03:01:25] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:01:25] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:01:25] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:01:25] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1903
)

[2025-10-11 03:01:25] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1903
    [type] => Individual Membership
)

[2025-10-11 03:01:25] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1903
)

[2025-10-11 03:01:25] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:01:25] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88038
    [total] => 77.63
)

[2025-10-11 03:01:25] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:01:25] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:01:25] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:01:25] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1903
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:01:25] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:01:25] [debug] LGL Constituents: All data set for user 1903
[2025-10-11 03:01:26] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 945047
            [external_constituent_id] => t00050
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => series of novels
            [job_title] => 
            [addressee] => Lew Archer's office
            [salutation] => Archer's
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Lew Archer's office
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Archer's
            [alt_addressee] => Lew Archer's office
            [honorary_name] => Lew Archer's office
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:29:20Z
            [updated_at] => 2025-10-11T07:01:26Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838637
                            [street] => 8411 1/2 Sunset Boulevard
                            [city] => Hollywood
                            [state] => CA
                            [country] => US
                            [postal_code] => 90210
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 90210
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:29:21Z
                            [updated_at] => 2023-02-27T13:29:21Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 480207
                            [number] => (888) 555-0050
                            [phone_number_type_id] => 3
                            [phone_type_name] => Mobile
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550050
                            [created_at] => 2023-02-27T13:29:21Z
                            [updated_at] => 2023-02-27T13:29:21Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 277097
                            [address] => archer's@seriesofnovels.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:29:21Z
                            [updated_at] => 2023-02-27T13:29:21Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1282
                            [item_type] => Constituent
                            [name] => Communication Tags
                            [key] => tags
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 1
                            [editable] => 1
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12747
                                            [category_id] => 1282
                                            [name] => Do not mail
                                            [description] => 
                                            [short_code] => do_not_mail
                                            [ordinal] => 100
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:32Z
                                            [updated_at] => 2023-02-25T00:56:32Z
                                        )

                                )

                        )

                    [1] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                    [0] => Array
                        (
                            [id] => 1602
                            [constituent_id] => 945047
                            [membership_level_id] => 412
                            [membership_level_name] => Individual
                            [date_start] => 2021-02-27
                            [finish_date] => 2022-02-27
                            [note] => 
                            [created_at] => 2023-02-27T13:29:21Z
                            [updated_at] => 2023-02-27T13:29:21Z
                        )

                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":945047,"external_constituent_id":"t00050","is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"series of novels","job_title":null,"addressee":"Lew Archer's office","salutation":"Archer's","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Lew Archer's office","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Archer's","alt_addressee":"Lew Archer's office","honorary_name":"Lew Archer's office","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:29:20Z","updated_at":"2025-10-11T07:01:26Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838637,"street":"8411 1/2 Sunset Boulevard","city":"Hollywood","state":"CA","country":"US","postal_code":"90210","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"90210","verified":false,"verified_on":null,"created_at":"2023-02-27T13:29:21Z","updated_at":"2023-02-27T13:29:21Z"}],"phone_numbers":[{"id":480207,"number":"(888) 555-0050","phone_number_type_id":3,"phone_type_name":"Mobile","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550050","created_at":"2023-02-27T13:29:21Z","updated_at":"2023-02-27T13:29:21Z"}],"email_addresses":[{"id":277097,"address":"archer's@seriesofnovels.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:29:21Z","updated_at":"2023-02-27T13:29:21Z"}],"web_addresses":[],"categories":[{"id":1282,"item_type":"Constituent","name":"Communication Tags","key":"tags","facet_type":"list","ordinal":100,"removable":true,"editable":true,"display_format":"compact","keywords":[{"id":12747,"category_id":1282,"name":"Do not mail","description":null,"short_code":"do_not_mail","ordinal":100,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:32Z","updated_at":"2023-02-25T00:56:32Z"}]},{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[{"id":1602,"constituent_id":945047,"membership_level_id":412,"membership_level_name":"Individual","date_start":"2021-02-27","finish_date":"2022-02-27","note":null,"created_at":"2023-02-27T13:29:21Z","updated_at":"2023-02-27T13:29:21Z"}],"custom_attrs":[]}
)

[2025-10-11 03:01:26] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 945047
)

[2025-10-11 03:01:26] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:01:26] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1903
    [lgl_id] => 945047
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:01:26] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88038
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:01:26] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:01:26] [debug] ðŸ” LGL Payments: No cache, making API requests...
[2025-10-11 03:01:27] [debug] LGL Payments: Failed to retrieve payment types HTTP 404: {"status":404,"error":"Not Found"}
[2025-10-11 03:01:27] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
        )

    [funds_count] => 0
    [campaigns_count] => 0
    [payment_types_count] => 0
)

[2025-10-11 03:01:27] [debug] LGL Payments: Exception in setupMembershipPayment No payment types available for memberships
[2025-10-11 03:01:27] [debug] âŒ Payment creation failed Array
(
    [error] => Payment data creation failed: No payment types available for memberships
    [uid] => 1903
    [lgl_id] => 945047
)

[2025-10-11 03:01:27] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1903
    [lgl_id] => 945047
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:01:27] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1903
    [success] => Registration call completed
)

[2025-10-11 03:01:27] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1903
    [lgl_api_called] => YES
)

[2025-10-11 03:01:27] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:01:27] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88038
    [user_id] => 1903
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:01:27] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:01:27] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:01:27] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88038
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:03:45] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88039
    [timestamp] => 2025-10-11 03:03:45
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:03:45] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88039
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1904
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:03:45
    [item_count] => 0
)

[2025-10-11 03:03:45] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1904
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:03:45] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1904
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:03:45] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:03:45] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:03:45] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1904
    [order_id] => 88039
)

[2025-10-11 03:03:45] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:03:45] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88039
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:03:45] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:03:45] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88039
    [product_id] => 67487
)

[2025-10-11 03:03:45] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:03:45] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88039
    [timestamp] => 2025-10-11 03:03:45
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:03:45] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88039
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1904
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:03:45
    [item_count] => 1
)

[2025-10-11 03:03:45] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1904
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:03:45] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1904
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:03:45] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:03:45] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:03:45] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1904
    [order_id] => 88039
)

[2025-10-11 03:03:45] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:03:45] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:03:45] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:03:45] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1904
    [order_id] => 88039
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:03:45] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:03:45] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1904
    [order_id] => 88039
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:03:45
)

[2025-10-11 03:03:45] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:03:45] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:03:45] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:03:45] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:03:45] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:03:45] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:03:45] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:03:45] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1904
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:03:45] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1904
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:03:45] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1904
[2025-10-11 03:03:45] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:03:45] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:03:45] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:03:45] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166225
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88039
    [user_id] => 1904
)

[2025-10-11 03:03:45] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:03:45] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:03:45] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:03:45] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1904
)

[2025-10-11 03:03:45] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1904
    [type] => Individual Membership
)

[2025-10-11 03:03:45] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1904
)

[2025-10-11 03:03:45] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:03:45] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88039
    [total] => 77.63
)

[2025-10-11 03:03:45] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:03:45] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:03:45] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:03:45] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1904
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:03:45] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:03:45] [debug] LGL Constituents: All data set for user 1904
[2025-10-11 03:03:46] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946707
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:03:46Z
            [updated_at] => 2025-10-11T07:03:46Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946707,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:03:46Z","updated_at":"2025-10-11T07:03:46Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:03:46] [debug] MembershipOrderHandler: User data updated 1904
[2025-10-11 03:03:46] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:03:46] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1904
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88039
)

[2025-10-11 03:03:46] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:03:46] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:03:46] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166225
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88039
    [user_id] => 1904
)

[2025-10-11 03:03:46] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:03:46
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:03:46] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1904
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88039
)

[2025-10-11 03:03:46] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1904
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:03:46] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:03:46] [debug] Payment method set:  online
[2025-10-11 03:03:46] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:03:46] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:03:46] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:03:46] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:03:46] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:03:46] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:03:46] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:03:46] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:03:46] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:03:46] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:03:46] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:03:46] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:03:46] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:03:46] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:03:46] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1904
)

[2025-10-11 03:03:46] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1904
    [type] => Individual Membership
)

[2025-10-11 03:03:46] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1904
)

[2025-10-11 03:03:46] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:03:46] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88039
    [total] => 77.63
)

[2025-10-11 03:03:46] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:03:46] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:03:46] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:03:46] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1904
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:03:46] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:03:46] [debug] LGL Constituents: All data set for user 1904
[2025-10-11 03:03:47] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:03:47Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:03:47Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:03:47] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:03:47] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:03:47] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1904
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:03:47] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88039
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:03:47] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:03:47] [debug] ðŸ” LGL Payments: No cache, making API requests...
[2025-10-11 03:03:49] [debug] LGL Payments: Payment types retrieved Array
(
    [method] => Memberships
    [count] => 7
)

[2025-10-11 03:03:49] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:03:50] [debug] LGL Payments: Failed to create membership payment HTTP 404: {"status":404,"error":"Not Found"}
[2025-10-11 03:03:50] [debug] âŒ Payment creation failed Array
(
    [error] => Payment data creation failed: HTTP 404: {"status":404,"error":"Not Found"}
    [uid] => 1904
    [lgl_id] => 944817
)

[2025-10-11 03:03:50] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1904
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:03:50] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1904
    [success] => Registration call completed
)

[2025-10-11 03:03:50] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1904
    [lgl_api_called] => YES
)

[2025-10-11 03:03:50] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:03:50] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88039
    [user_id] => 1904
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:03:50] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:03:50] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:03:50] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88039
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:04:56] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88040
    [timestamp] => 2025-10-11 03:04:56
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:04:56] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88040
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1905
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:04:56
    [item_count] => 0
)

[2025-10-11 03:04:56] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1905
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:04:56] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1905
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:04:56] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:04:56] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:04:56] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1905
    [order_id] => 88040
)

[2025-10-11 03:04:56] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:04:56] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88040
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:04:56] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:04:56] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88040
    [product_id] => 67487
)

[2025-10-11 03:04:56] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:04:56] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88040
    [timestamp] => 2025-10-11 03:04:56
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:04:56] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88040
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1905
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:04:56
    [item_count] => 1
)

[2025-10-11 03:04:56] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1905
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:04:56] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1905
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:04:56] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:04:56] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:04:56] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1905
    [order_id] => 88040
)

[2025-10-11 03:04:56] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:04:56] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:04:56] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:04:56] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1905
    [order_id] => 88040
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:04:56] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:04:56] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1905
    [order_id] => 88040
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:04:56
)

[2025-10-11 03:04:56] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:04:56] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:04:56] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:04:56] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:04:56] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:04:56] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:04:56] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:04:56] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1905
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:04:56] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1905
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:04:56] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1905
[2025-10-11 03:04:56] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:04:56] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:04:56] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:04:56] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166296
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88040
    [user_id] => 1905
)

[2025-10-11 03:04:56] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:04:56] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:04:56] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:04:56] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1905
)

[2025-10-11 03:04:56] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1905
    [type] => Individual Membership
)

[2025-10-11 03:04:56] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1905
)

[2025-10-11 03:04:56] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:04:56] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88040
    [total] => 77.63
)

[2025-10-11 03:04:56] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:04:56] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:04:56] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:04:56] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1905
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:04:56] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:04:56] [debug] LGL Constituents: All data set for user 1905
[2025-10-11 03:04:57] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946712
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:04:57Z
            [updated_at] => 2025-10-11T07:04:57Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946712,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:04:57Z","updated_at":"2025-10-11T07:04:57Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:04:57] [debug] MembershipOrderHandler: User data updated 1905
[2025-10-11 03:04:57] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:04:57] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1905
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88040
)

[2025-10-11 03:04:57] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:04:57] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:04:57] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166296
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88040
    [user_id] => 1905
)

[2025-10-11 03:04:57] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:04:57
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:04:57] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1905
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88040
)

[2025-10-11 03:04:57] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1905
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:04:57] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:04:57] [debug] Payment method set:  online
[2025-10-11 03:04:57] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:04:57] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:04:57] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:04:57] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:04:57] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:04:57] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:04:57] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:04:57] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:04:57] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:04:57] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:04:57] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:04:57] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:04:57] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:04:57] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:04:57] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1905
)

[2025-10-11 03:04:57] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1905
    [type] => Individual Membership
)

[2025-10-11 03:04:57] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1905
)

[2025-10-11 03:04:57] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:04:57] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88040
    [total] => 77.63
)

[2025-10-11 03:04:57] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:04:57] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:04:57] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:04:57] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1905
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:04:57] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:04:57] [debug] LGL Constituents: All data set for user 1905
[2025-10-11 03:04:58] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:04:58Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:04:58Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:04:58] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:04:58] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:04:58] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1905
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:04:58] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88040
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:04:58] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:04:58] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:04:58] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:04:58] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88040
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88040
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:04:59] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905102
)

[2025-10-11 03:04:59] [debug] LGL Payments: Failed to create membership payment Unknown error
[2025-10-11 03:05:53] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88041
    [timestamp] => 2025-10-11 03:05:53
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:05:53] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88041
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1905
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:05:53
    [item_count] => 0
)

[2025-10-11 03:05:53] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1905
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:05:53] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1905
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:05:53] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:05:53] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:05:53] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1905
    [order_id] => 88041
)

[2025-10-11 03:05:53] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:05:53] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88041
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:05:53] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:05:53] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88041
    [product_id] => 67487
)

[2025-10-11 03:05:53] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:05:54] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88041
    [timestamp] => 2025-10-11 03:05:54
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:05:54] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88041
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1905
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:05:53
    [item_count] => 1
)

[2025-10-11 03:05:54] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1905
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:05:54] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1905
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:05:54] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:05:54] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:05:54] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1905
    [order_id] => 88041
)

[2025-10-11 03:05:54] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:05:54] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:05:54] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:05:54] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1905
    [order_id] => 88041
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:05:54] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:05:54] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1905
    [order_id] => 88041
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:05:54
)

[2025-10-11 03:05:54] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:05:54] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:05:54] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:05:54] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:05:54] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:05:54] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:05:54] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:05:54] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1905
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:05:54] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1905
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:05:54] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1905
[2025-10-11 03:05:54] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:05:54] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:05:54] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:05:54] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166353
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88041
    [user_id] => 1905
)

[2025-10-11 03:05:54] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:05:54] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:05:54] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:05:54] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1905
)

[2025-10-11 03:05:54] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1905
    [type] => Individual Membership
)

[2025-10-11 03:05:54] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1905
)

[2025-10-11 03:05:54] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:05:54] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88041
    [total] => 77.63
)

[2025-10-11 03:05:54] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:05:54] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:05:54] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:05:54] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1905
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:05:54] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:05:54] [debug] LGL Constituents: All data set for user 1905
[2025-10-11 03:05:54] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946712
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:04:57Z
            [updated_at] => 2025-10-11T07:05:54Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12797
                                            [category_id] => 1287
                                            [name] => Non Donor
                                            [description] => 
                                            [short_code] => non_donor
                                            [ordinal] => 4
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946712,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:04:57Z","updated_at":"2025-10-11T07:05:54Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12797,"category_id":1287,"name":"Non Donor","description":null,"short_code":"non_donor","ordinal":4,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:05:54] [debug] MembershipOrderHandler: User data updated 1905
[2025-10-11 03:05:54] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:05:54] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1905
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88041
)

[2025-10-11 03:05:54] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:05:54] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:05:54] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166353
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88041
    [user_id] => 1905
)

[2025-10-11 03:05:54] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:05:54
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:05:54] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1905
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88041
)

[2025-10-11 03:05:54] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1905
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:05:54] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:05:54] [debug] Payment method set:  online
[2025-10-11 03:05:54] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:05:54] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:05:54] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:05:54] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:05:55] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:05:55] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:05:55] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:05:55] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:05:55] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:05:55] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:05:55] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:05:55] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:05:55] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:05:55] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:05:55] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1905
)

[2025-10-11 03:05:55] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1905
    [type] => Individual Membership
)

[2025-10-11 03:05:55] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1905
)

[2025-10-11 03:05:55] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:05:55] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88041
    [total] => 77.63
)

[2025-10-11 03:05:55] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:05:55] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:05:55] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:05:55] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1905
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:05:55] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:05:55] [debug] LGL Constituents: All data set for user 1905
[2025-10-11 03:05:55] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:05:55Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:05:55Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:05:56] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:05:56] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:05:56] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1905
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:05:56] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88041
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:05:56] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:05:56] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:05:56] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:05:56] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88041
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88041
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:05:56] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905107
)

[2025-10-11 03:05:56] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88041
    [amount] => 77.63
)

[2025-10-11 03:05:56] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905107
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905107
                    [constituent_id] => 944817
                    [external_id] => 88041
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88041
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:05:56Z
                    [updated_at] => 2025-10-11T07:05:56Z
                )

        )

)

[2025-10-11 03:05:56] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:05:56] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:05:56] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1905
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:05:56] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1905
    [success] => Registration call completed
)

[2025-10-11 03:05:56] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1905
    [lgl_api_called] => YES
)

[2025-10-11 03:05:56] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:05:56] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88041
    [user_id] => 1905
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:05:56] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:05:56] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:05:56] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88041
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:06:12] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88042
    [timestamp] => 2025-10-11 03:06:12
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:06:12] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88042
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1906
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:06:12
    [item_count] => 0
)

[2025-10-11 03:06:12] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1906
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:06:12] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1906
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:06:12] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:06:12] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:06:12] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1906
    [order_id] => 88042
)

[2025-10-11 03:06:12] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:06:12] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88042
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:06:12] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:06:12] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88042
    [product_id] => 67487
)

[2025-10-11 03:06:12] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:06:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88042
    [timestamp] => 2025-10-11 03:06:13
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:06:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88042
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1906
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:06:12
    [item_count] => 1
)

[2025-10-11 03:06:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1906
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:06:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1906
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:06:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:06:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:06:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1906
    [order_id] => 88042
)

[2025-10-11 03:06:13] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:06:13] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:06:13] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:06:13] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1906
    [order_id] => 88042
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:06:13] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:06:13] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1906
    [order_id] => 88042
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:06:13
)

[2025-10-11 03:06:13] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:06:13] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:06:13] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:06:13] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:06:13] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:06:13] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:06:13] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:06:13] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1906
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:06:13] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1906
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:06:13] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1906
[2025-10-11 03:06:13] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:06:13] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:06:13] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:06:13] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166372
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88042
    [user_id] => 1906
)

[2025-10-11 03:06:13] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:06:13] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:06:13] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:06:13] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1906
)

[2025-10-11 03:06:13] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1906
    [type] => Individual Membership
)

[2025-10-11 03:06:13] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1906
)

[2025-10-11 03:06:13] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:06:13] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88042
    [total] => 77.63
)

[2025-10-11 03:06:13] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:06:13] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:06:13] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:06:13] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1906
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:06:13] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:06:13] [debug] LGL Constituents: All data set for user 1906
[2025-10-11 03:06:13] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946717
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:06:13Z
            [updated_at] => 2025-10-11T07:06:13Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946717,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:06:13Z","updated_at":"2025-10-11T07:06:13Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:06:13] [debug] MembershipOrderHandler: User data updated 1906
[2025-10-11 03:06:13] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:06:13] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1906
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88042
)

[2025-10-11 03:06:13] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:06:13] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:06:13] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166372
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88042
    [user_id] => 1906
)

[2025-10-11 03:06:13] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:06:13
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:06:13] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1906
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88042
)

[2025-10-11 03:06:13] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1906
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:06:13] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:06:13] [debug] Payment method set:  online
[2025-10-11 03:06:13] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:06:13] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:06:13] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:06:13] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:06:14] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:06:14] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:06:14] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:06:14] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:06:14] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:06:14] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:06:14] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:06:14] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:06:14] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:06:14] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:06:14] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1906
)

[2025-10-11 03:06:14] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1906
    [type] => Individual Membership
)

[2025-10-11 03:06:14] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1906
)

[2025-10-11 03:06:14] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:06:14] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88042
    [total] => 77.63
)

[2025-10-11 03:06:14] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:06:14] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:06:14] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:06:14] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1906
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:06:14] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:06:14] [debug] LGL Constituents: All data set for user 1906
[2025-10-11 03:06:14] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:06:14Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:06:14Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:06:15] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:06:15] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:06:15] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1906
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:06:15] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88042
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:06:15] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:06:15] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:06:15] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:06:15] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88042
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88042
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:06:15] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905112
)

[2025-10-11 03:06:15] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88042
    [amount] => 77.63
)

[2025-10-11 03:06:15] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905112
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905112
                    [constituent_id] => 944817
                    [external_id] => 88042
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88042
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:06:15Z
                    [updated_at] => 2025-10-11T07:06:15Z
                )

        )

)

[2025-10-11 03:06:16] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:06:16] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:06:16] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1906
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:06:16] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1906
    [success] => Registration call completed
)

[2025-10-11 03:06:16] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1906
    [lgl_api_called] => YES
)

[2025-10-11 03:06:16] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:06:16] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88042
    [user_id] => 1906
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:06:16] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:06:16] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:06:16] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88042
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:08:43] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:08:44] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-11 03:08:44] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-11 03:08:44] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:08:44] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:08:44] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:08:44] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:08:44] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:08:44] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:08:44] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88043
    [timestamp] => 2025-10-11 03:08:44
    [memory_usage] => 154MB
)

[2025-10-11 03:08:44] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88043
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1907
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:08:44
    [item_count] => 0
)

[2025-10-11 03:08:44] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1907
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:08:44] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1907
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:08:44] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:08:44] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:08:44] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1907
    [order_id] => 88043
)

[2025-10-11 03:08:44] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:08:44] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88043
    [final_memory_usage] => 154MB
)

[2025-10-11 03:08:44] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:08:44] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88043
    [product_id] => 67487
)

[2025-10-11 03:08:44] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:08:44] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88043
    [timestamp] => 2025-10-11 03:08:44
    [memory_usage] => 154MB
)

[2025-10-11 03:08:44] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88043
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1907
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:08:44
    [item_count] => 1
)

[2025-10-11 03:08:44] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1907
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:08:44] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1907
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:08:44] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:08:44] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:08:44] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1907
    [order_id] => 88043
)

[2025-10-11 03:08:44] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:08:44] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:08:44] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:08:44] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1907
    [order_id] => 88043
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:08:44] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:08:44] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1907
    [order_id] => 88043
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:08:44
)

[2025-10-11 03:08:44] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:08:44] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:08:44] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:08:44] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:08:44] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:08:44] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:08:44] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:08:44] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1907
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:08:44] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1907
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:08:44] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1907
[2025-10-11 03:08:44] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:08:44] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:08:44] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:08:44] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166524
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88043
    [user_id] => 1907
)

[2025-10-11 03:08:44] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:08:44] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:08:44] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:08:44] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1907
)

[2025-10-11 03:08:44] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1907
    [type] => Individual Membership
)

[2025-10-11 03:08:44] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1907
)

[2025-10-11 03:08:44] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:08:44] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88043
    [total] => 77.63
)

[2025-10-11 03:08:44] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:08:44] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:08:44] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:08:44] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1907
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:08:44] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:08:44] [debug] LGL Constituents: All data set for user 1907
[2025-10-11 03:08:45] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946722
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:08:45Z
            [updated_at] => 2025-10-11T07:08:45Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946722,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:08:45Z","updated_at":"2025-10-11T07:08:45Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:08:45] [debug] MembershipOrderHandler: User data updated 1907
[2025-10-11 03:08:45] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:08:45] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1907
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88043
)

[2025-10-11 03:08:45] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:08:45] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:08:45] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166524
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88043
    [user_id] => 1907
)

[2025-10-11 03:08:45] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:08:45
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:08:45] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1907
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88043
)

[2025-10-11 03:08:45] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1907
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:08:45] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:08:45] [debug] Payment method set:  online
[2025-10-11 03:08:45] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:08:45] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:08:45] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:08:45] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:08:45] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:08:45] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:08:45] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:08:45] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:08:45] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:08:45] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:08:45] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:08:45] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:08:45] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:08:45] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:08:45] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1907
)

[2025-10-11 03:08:45] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1907
    [type] => Individual Membership
)

[2025-10-11 03:08:45] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1907
)

[2025-10-11 03:08:45] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:08:45] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88043
    [total] => 77.63
)

[2025-10-11 03:08:45] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:08:45] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:08:45] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:08:45] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1907
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:08:45] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:08:45] [debug] LGL Constituents: All data set for user 1907
[2025-10-11 03:08:46] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:08:46Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:08:46Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:08:46] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:08:46] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:08:46] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1907
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:08:46] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88043
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:08:46] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:08:46] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:08:46] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:08:46] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88043
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88043
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:08:47] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905117
)

[2025-10-11 03:08:47] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88043
    [amount] => 77.63
)

[2025-10-11 03:08:47] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905117
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905117
                    [constituent_id] => 944817
                    [external_id] => 88043
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88043
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:08:47Z
                    [updated_at] => 2025-10-11T07:08:47Z
                )

        )

)

[2025-10-11 03:08:47] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:08:47] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:08:47] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1907
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:08:47] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1907
    [success] => Registration call completed
)

[2025-10-11 03:08:47] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1907
    [lgl_api_called] => YES
)

[2025-10-11 03:08:47] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:08:47] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88043
    [user_id] => 1907
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:08:47] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:08:47] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:08:47] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88043
    [final_memory_usage] => 154MB
)

[2025-10-11 03:08:49] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:09:12] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-11 03:09:12] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-11 03:09:13] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:09:13] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:09:13] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:09:13] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:09:13] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:09:13] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:09:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88044
    [timestamp] => 2025-10-11 03:09:13
    [memory_usage] => 164MB
)

[2025-10-11 03:09:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88044
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1908
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:09:13
    [item_count] => 0
)

[2025-10-11 03:09:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1908
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:09:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1908
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:09:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:09:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:09:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1908
    [order_id] => 88044
)

[2025-10-11 03:09:13] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:09:13] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88044
    [final_memory_usage] => 164MB
)

[2025-10-11 03:09:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:09:13] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88044
    [product_id] => 67487
)

[2025-10-11 03:09:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:09:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88044
    [timestamp] => 2025-10-11 03:09:13
    [memory_usage] => 164MB
)

[2025-10-11 03:09:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88044
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1908
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:09:13
    [item_count] => 1
)

[2025-10-11 03:09:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1908
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:09:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1908
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:09:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:09:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:09:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1908
    [order_id] => 88044
)

[2025-10-11 03:09:13] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:09:13] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:09:13] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:09:13] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1908
    [order_id] => 88044
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:09:13] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:09:13] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1908
    [order_id] => 88044
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:09:13
)

[2025-10-11 03:09:13] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:09:13] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:09:13] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:09:13] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:09:13] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:09:13] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:09:13] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:09:13] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1908
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:09:13] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1908
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:09:13] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1908
[2025-10-11 03:09:13] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:09:13] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:09:13] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:09:13] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166553
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88044
    [user_id] => 1908
)

[2025-10-11 03:09:13] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:09:13] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:09:13] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:09:13] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1908
)

[2025-10-11 03:09:13] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1908
    [type] => Individual Membership
)

[2025-10-11 03:09:13] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1908
)

[2025-10-11 03:09:13] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:09:13] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88044
    [total] => 77.63
)

[2025-10-11 03:09:13] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:09:13] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:09:13] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:09:13] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1908
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:09:13] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:09:13] [debug] LGL Constituents: All data set for user 1908
[2025-10-11 03:09:14] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946727
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:09:13Z
            [updated_at] => 2025-10-11T07:09:13Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946727,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:09:13Z","updated_at":"2025-10-11T07:09:13Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:09:14] [debug] MembershipOrderHandler: User data updated 1908
[2025-10-11 03:09:14] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:09:14] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1908
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88044
)

[2025-10-11 03:09:14] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:09:14] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:09:14] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166553
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88044
    [user_id] => 1908
)

[2025-10-11 03:09:14] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:09:14
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:09:14] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1908
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88044
)

[2025-10-11 03:09:14] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1908
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:09:14] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:09:14] [debug] Payment method set:  online
[2025-10-11 03:09:14] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:09:14] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:09:14] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:09:14] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:09:14] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:09:14] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:09:14] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:09:14] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:09:14] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:09:14] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:09:14] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:09:14] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:09:14] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:09:14] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:09:14] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1908
)

[2025-10-11 03:09:14] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1908
    [type] => Individual Membership
)

[2025-10-11 03:09:14] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1908
)

[2025-10-11 03:09:14] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:09:14] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88044
    [total] => 77.63
)

[2025-10-11 03:09:14] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:09:14] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:09:14] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:09:14] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1908
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:09:14] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:09:14] [debug] LGL Constituents: All data set for user 1908
[2025-10-11 03:09:15] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:09:15Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:09:15Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:09:15] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:09:15] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:09:15] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1908
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:09:15] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88044
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:09:15] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:09:15] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:09:15] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:09:15] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88044
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88044
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:09:16] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905122
)

[2025-10-11 03:09:16] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88044
    [amount] => 77.63
)

[2025-10-11 03:09:16] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905122
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905122
                    [constituent_id] => 944817
                    [external_id] => 88044
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88044
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:09:16Z
                    [updated_at] => 2025-10-11T07:09:16Z
                )

        )

)

[2025-10-11 03:09:16] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:09:16] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:09:16] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1908
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:09:16] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1908
    [success] => Registration call completed
)

[2025-10-11 03:09:16] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1908
    [lgl_api_called] => YES
)

[2025-10-11 03:09:16] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:09:16] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88044
    [user_id] => 1908
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:09:16] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:09:16] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:09:16] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88044
    [final_memory_usage] => 164MB
)

[2025-10-11 03:09:17] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:09:18] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-11 03:09:18] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-11 03:09:19] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:09:19] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:09:19] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:09:19] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:09:19] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:09:19] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:09:19] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88045
    [timestamp] => 2025-10-11 03:09:19
    [memory_usage] => 164MB
)

[2025-10-11 03:09:19] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88045
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1909
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:09:19
    [item_count] => 0
)

[2025-10-11 03:09:19] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1909
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:09:19] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1909
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:09:19] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:09:19] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:09:19] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1909
    [order_id] => 88045
)

[2025-10-11 03:09:19] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:09:19] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88045
    [final_memory_usage] => 164MB
)

[2025-10-11 03:09:19] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:09:19] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88045
    [product_id] => 67487
)

[2025-10-11 03:09:19] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:09:19] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88045
    [timestamp] => 2025-10-11 03:09:19
    [memory_usage] => 164MB
)

[2025-10-11 03:09:19] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88045
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1909
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:09:19
    [item_count] => 1
)

[2025-10-11 03:09:19] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1909
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:09:19] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1909
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:09:19] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:09:19] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:09:19] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1909
    [order_id] => 88045
)

[2025-10-11 03:09:19] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:09:19] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:09:19] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:09:19] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1909
    [order_id] => 88045
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:09:19] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:09:19] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1909
    [order_id] => 88045
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:09:19
)

[2025-10-11 03:09:19] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:09:19] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:09:19] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:09:19] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:09:19] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:09:19] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:09:19] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:09:19] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1909
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:09:19] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1909
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:09:19] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1909
[2025-10-11 03:09:19] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:09:19] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:09:19] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:09:19] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166559
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88045
    [user_id] => 1909
)

[2025-10-11 03:09:19] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:09:19] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:09:19] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:09:19] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1909
)

[2025-10-11 03:09:19] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1909
    [type] => Individual Membership
)

[2025-10-11 03:09:19] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1909
)

[2025-10-11 03:09:19] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:09:19] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88045
    [total] => 77.63
)

[2025-10-11 03:09:19] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:09:19] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:09:19] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:09:19] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1909
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:09:19] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:09:19] [debug] LGL Constituents: All data set for user 1909
[2025-10-11 03:09:19] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946732
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:09:19Z
            [updated_at] => 2025-10-11T07:09:19Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946732,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:09:19Z","updated_at":"2025-10-11T07:09:19Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:09:19] [debug] MembershipOrderHandler: User data updated 1909
[2025-10-11 03:09:19] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:09:19] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1909
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88045
)

[2025-10-11 03:09:19] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:09:19] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:09:19] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166559
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88045
    [user_id] => 1909
)

[2025-10-11 03:09:19] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:09:19
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:09:19] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1909
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88045
)

[2025-10-11 03:09:19] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1909
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:09:19] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:09:19] [debug] Payment method set:  online
[2025-10-11 03:09:19] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:09:19] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:09:19] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:09:19] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:09:20] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:09:20] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:09:20] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:09:20] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:09:20] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:09:20] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:09:20] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:09:20] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:09:20] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:09:20] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:09:20] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1909
)

[2025-10-11 03:09:20] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1909
    [type] => Individual Membership
)

[2025-10-11 03:09:20] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1909
)

[2025-10-11 03:09:20] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:09:20] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88045
    [total] => 77.63
)

[2025-10-11 03:09:20] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:09:20] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:09:20] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:09:20] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1909
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:09:20] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:09:20] [debug] LGL Constituents: All data set for user 1909
[2025-10-11 03:09:20] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:09:20Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:09:20Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:09:21] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:09:21] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:09:21] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1909
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:09:21] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88045
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:09:21] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:09:21] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:09:21] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:09:21] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88045
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88045
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:09:21] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905127
)

[2025-10-11 03:09:21] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88045
    [amount] => 77.63
)

[2025-10-11 03:09:21] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905127
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905127
                    [constituent_id] => 944817
                    [external_id] => 88045
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88045
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:09:21Z
                    [updated_at] => 2025-10-11T07:09:21Z
                )

        )

)

[2025-10-11 03:09:22] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:09:22] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:09:22] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1909
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:09:22] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1909
    [success] => Registration call completed
)

[2025-10-11 03:09:22] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1909
    [lgl_api_called] => YES
)

[2025-10-11 03:09:22] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:09:22] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88045
    [user_id] => 1909
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:09:22] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:09:22] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:09:22] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88045
    [final_memory_usage] => 164MB
)

[2025-10-11 03:09:27] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:09:45] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:09:46] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:09:54] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:09:55] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:12:47] [debug] Test message from independent debug system
[2025-10-11 03:12:55] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88046
    [timestamp] => 2025-10-11 03:12:55
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:12:55] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88046
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1910
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:12:55
    [item_count] => 0
)

[2025-10-11 03:12:55] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1910
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:12:55] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1910
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:12:55] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:12:55] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:12:55] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1910
    [order_id] => 88046
)

[2025-10-11 03:12:55] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:12:55] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88046
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:12:55] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:12:55] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88046
    [product_id] => 67487
)

[2025-10-11 03:12:55] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:12:55] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88046
    [timestamp] => 2025-10-11 03:12:55
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:12:55] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88046
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1910
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:12:55
    [item_count] => 1
)

[2025-10-11 03:12:55] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1910
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:12:55] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1910
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:12:55] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:12:55] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:12:55] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1910
    [order_id] => 88046
)

[2025-10-11 03:12:55] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:12:55] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:12:55] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:12:55] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1910
    [order_id] => 88046
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:12:55] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:12:55] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1910
    [order_id] => 88046
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:12:55
)

[2025-10-11 03:12:55] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:12:55] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:12:55] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:12:55] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:12:55] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:12:55] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:12:55] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:12:55] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1910
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:12:55] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1910
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:12:55] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1910
[2025-10-11 03:12:55] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:12:55] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:12:55] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:12:55] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166775
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88046
    [user_id] => 1910
)

[2025-10-11 03:12:55] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:12:55] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:12:55] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:12:55] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1910
)

[2025-10-11 03:12:55] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1910
    [type] => Individual Membership
)

[2025-10-11 03:12:55] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1910
)

[2025-10-11 03:12:55] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:12:55] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88046
    [total] => 77.63
)

[2025-10-11 03:12:55] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:12:55] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:12:55] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:12:55] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1910
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:12:55] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:12:55] [debug] LGL Constituents: All data set for user 1910
[2025-10-11 03:12:56] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946737
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:12:56Z
            [updated_at] => 2025-10-11T07:12:56Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946737,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:12:56Z","updated_at":"2025-10-11T07:12:56Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:12:56] [debug] MembershipOrderHandler: User data updated 1910
[2025-10-11 03:12:56] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:12:56] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1910
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88046
)

[2025-10-11 03:12:56] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:12:56] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:12:56] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166775
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88046
    [user_id] => 1910
)

[2025-10-11 03:12:56] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:12:56
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:12:56] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1910
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88046
)

[2025-10-11 03:12:56] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1910
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:12:56] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:12:56] [debug] Payment method set:  online
[2025-10-11 03:12:56] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:12:56] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:12:56] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:12:56] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:12:56] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:12:56] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:12:56] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:12:56] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:12:56] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:12:56] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:12:56] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:12:56] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:12:56] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:12:56] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:12:56] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1910
)

[2025-10-11 03:12:56] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1910
    [type] => Individual Membership
)

[2025-10-11 03:12:56] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1910
)

[2025-10-11 03:12:56] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:12:56] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88046
    [total] => 77.63
)

[2025-10-11 03:12:56] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:12:56] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:12:56] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:12:56] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1910
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:12:56] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:12:56] [debug] LGL Constituents: All data set for user 1910
[2025-10-11 03:12:56] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:12:56Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:12:56Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:12:57] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:12:57] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:12:57] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1910
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:12:57] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88046
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:12:57] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:12:57] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:12:57] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:12:57] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88046
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88046
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:12:57] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905132
)

[2025-10-11 03:12:57] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88046
    [amount] => 77.63
)

[2025-10-11 03:12:57] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905132
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905132
                    [constituent_id] => 944817
                    [external_id] => 88046
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88046
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:12:57Z
                    [updated_at] => 2025-10-11T07:12:57Z
                )

        )

)

[2025-10-11 03:12:58] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:12:58] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:12:58] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1910
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:12:58] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1910
    [success] => Registration call completed
)

[2025-10-11 03:12:58] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1910
    [lgl_api_called] => YES
)

[2025-10-11 03:12:58] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:12:58] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88046
    [user_id] => 1910
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:12:58] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:12:58] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:12:58] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88046
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:13:09] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:13:10] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Test User
    [email] => test@example.com
)

[2025-10-11 03:13:10] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => test@example.com
        )

)

[2025-10-11 03:13:10] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:13:10] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:13:10] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:13:10] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:13:10] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:13:10] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:13:10] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88047
    [timestamp] => 2025-10-11 03:13:10
    [memory_usage] => 124MB
)

[2025-10-11 03:13:10] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88047
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1911
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:13:10
    [item_count] => 0
)

[2025-10-11 03:13:10] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1911
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:13:10] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1911
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:13:10] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:13:10] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:13:10] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1911
    [order_id] => 88047
)

[2025-10-11 03:13:10] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:13:10] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88047
    [final_memory_usage] => 124MB
)

[2025-10-11 03:13:10] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:13:10] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88047
    [product_id] => 67487
)

[2025-10-11 03:13:10] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:13:11] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88047
    [timestamp] => 2025-10-11 03:13:11
    [memory_usage] => 128MB
)

[2025-10-11 03:13:11] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88047
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1911
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:13:10
    [item_count] => 1
)

[2025-10-11 03:13:11] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1911
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:13:11] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1911
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:13:11] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:13:11] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:13:11] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1911
    [order_id] => 88047
)

[2025-10-11 03:13:11] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:13:11] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:13:11] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:13:11] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1911
    [order_id] => 88047
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:13:11] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:13:11] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1911
    [order_id] => 88047
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:13:11
)

[2025-10-11 03:13:11] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:13:11] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:13:11] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:13:11] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:13:11] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:13:11] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:13:11] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:13:11] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1911
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:13:11] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1911
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:13:11] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1911
[2025-10-11 03:13:11] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:13:11] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:13:11] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:13:11] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166790
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88047
    [user_id] => 1911
)

[2025-10-11 03:13:11] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:13:11] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:13:11] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:13:11] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1911
)

[2025-10-11 03:13:11] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1911
    [type] => Individual Membership
)

[2025-10-11 03:13:11] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1911
)

[2025-10-11 03:13:11] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:13:11] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88047
    [total] => 77.63
)

[2025-10-11 03:13:11] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:13:11] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:13:11] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:13:11] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1911
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:13:11] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:13:11] [debug] LGL Constituents: All data set for user 1911
[2025-10-11 03:13:11] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946742
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:13:11Z
            [updated_at] => 2025-10-11T07:13:11Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946742,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:13:11Z","updated_at":"2025-10-11T07:13:11Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:13:11] [debug] MembershipOrderHandler: User data updated 1911
[2025-10-11 03:13:11] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:13:11] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1911
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88047
)

[2025-10-11 03:13:11] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:13:11] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:13:11] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166790
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88047
    [user_id] => 1911
)

[2025-10-11 03:13:11] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:13:11
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:13:11] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1911
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88047
)

[2025-10-11 03:13:11] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1911
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:13:11] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:13:11] [debug] Payment method set:  online
[2025-10-11 03:13:11] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:13:11] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:13:11] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:13:11] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:13:12] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:13:12] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:13:12] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:13:12] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:13:12] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:13:12] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:13:12] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:13:12] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:13:12] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:13:12] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:13:12] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1911
)

[2025-10-11 03:13:12] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1911
    [type] => Individual Membership
)

[2025-10-11 03:13:12] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1911
)

[2025-10-11 03:13:12] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:13:12] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88047
    [total] => 77.63
)

[2025-10-11 03:13:12] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:13:12] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:13:12] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:13:12] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1911
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:13:12] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:13:12] [debug] LGL Constituents: All data set for user 1911
[2025-10-11 03:13:12] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:13:12Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:13:12Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:13:13] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:13:13] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:13:13] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1911
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:13:13] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88047
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:13:13] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:13:13] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:13:13] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:13:13] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88047
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88047
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:13:13] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905137
)

[2025-10-11 03:13:13] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88047
    [amount] => 77.63
)

[2025-10-11 03:13:13] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905137
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905137
                    [constituent_id] => 944817
                    [external_id] => 88047
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88047
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:13:13Z
                    [updated_at] => 2025-10-11T07:13:13Z
                )

        )

)

[2025-10-11 03:13:14] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:13:14] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:13:14] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1911
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:13:14] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1911
    [success] => Registration call completed
)

[2025-10-11 03:13:14] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1911
    [lgl_api_called] => YES
)

[2025-10-11 03:13:14] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:13:14] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88047
    [user_id] => 1911
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:13:14] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:13:14] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:13:14] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88047
    [final_memory_usage] => 128MB
)

[2025-10-11 03:13:25] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:13:25] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:13:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88051
    [timestamp] => 2025-10-11 03:13:29
    [memory_usage] => 136MB
)

[2025-10-11 03:13:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88051
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1912
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:13:29
    [item_count] => 0
)

[2025-10-11 03:13:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1912
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:13:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1912
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:13:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:13:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:13:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1912
    [order_id] => 88051
)

[2025-10-11 03:13:29] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:13:29] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88051
    [final_memory_usage] => 136MB
)

[2025-10-11 03:13:29] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:13:29] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88051
    [product_id] => 67487
)

[2025-10-11 03:13:29] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:13:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88051
    [timestamp] => 2025-10-11 03:13:29
    [memory_usage] => 142MB
)

[2025-10-11 03:13:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88051
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1912
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:13:29
    [item_count] => 1
)

[2025-10-11 03:13:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1912
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:13:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1912
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:13:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:13:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:13:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1912
    [order_id] => 88051
)

[2025-10-11 03:13:29] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:13:29] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:13:29] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:13:29] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1912
    [order_id] => 88051
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:13:29] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:13:29] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1912
    [order_id] => 88051
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:13:29
)

[2025-10-11 03:13:29] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:13:29] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:13:29] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:13:29] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:13:29] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:13:29] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:13:29] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:13:29] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1912
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:13:29] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1912
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:13:29] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1912
[2025-10-11 03:13:29] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:13:29] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:13:29] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:13:29] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166809
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88051
    [user_id] => 1912
)

[2025-10-11 03:13:29] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:13:29] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:13:29] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:13:29] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1912
)

[2025-10-11 03:13:29] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1912
    [type] => Individual Membership
)

[2025-10-11 03:13:29] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1912
)

[2025-10-11 03:13:29] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:13:29] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88051
    [total] => 77.63
)

[2025-10-11 03:13:29] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:13:29] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:13:29] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:13:29] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1912
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:13:29] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:13:29] [debug] LGL Constituents: All data set for user 1912
[2025-10-11 03:13:29] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946747
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:13:29Z
            [updated_at] => 2025-10-11T07:13:29Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946747,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:13:29Z","updated_at":"2025-10-11T07:13:29Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:13:29] [debug] MembershipOrderHandler: User data updated 1912
[2025-10-11 03:13:29] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:13:29] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1912
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88051
)

[2025-10-11 03:13:29] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:13:29] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:13:29] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166809
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88051
    [user_id] => 1912
)

[2025-10-11 03:13:29] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:13:29
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:13:29] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1912
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88051
)

[2025-10-11 03:13:29] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1912
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:13:29] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:13:29] [debug] Payment method set:  online
[2025-10-11 03:13:29] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:13:29] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:13:29] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:13:29] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:13:30] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:13:30] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:13:30] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:13:30] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:13:30] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:13:30] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:13:30] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:13:30] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:13:30] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:13:30] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:13:30] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1912
)

[2025-10-11 03:13:30] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1912
    [type] => Individual Membership
)

[2025-10-11 03:13:30] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1912
)

[2025-10-11 03:13:30] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:13:30] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88051
    [total] => 77.63
)

[2025-10-11 03:13:30] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:13:30] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:13:30] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:13:30] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1912
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:13:30] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:13:30] [debug] LGL Constituents: All data set for user 1912
[2025-10-11 03:13:30] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:13:30Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:13:30Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:13:31] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:13:31] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:13:31] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1912
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:13:31] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88051
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:13:31] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:13:31] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:13:31] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:13:31] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88051
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88051
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:13:32] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905142
)

[2025-10-11 03:13:32] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88051
    [amount] => 77.63
)

[2025-10-11 03:13:32] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905142
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905142
                    [constituent_id] => 944817
                    [external_id] => 88051
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88051
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:13:31Z
                    [updated_at] => 2025-10-11T07:13:31Z
                )

        )

)

[2025-10-11 03:13:32] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:13:32] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:13:32] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1912
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:13:32] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1912
    [success] => Registration call completed
)

[2025-10-11 03:13:32] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1912
    [lgl_api_called] => YES
)

[2025-10-11 03:13:32] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:13:32] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88051
    [user_id] => 1912
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:13:32] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:13:32] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:13:32] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88051
    [final_memory_usage] => 144MB
)

[2025-10-11 03:13:33] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:13:33] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88052
    [timestamp] => 2025-10-11 03:13:33
    [memory_usage] => 126MB
)

[2025-10-11 03:13:33] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88052
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1913
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:13:33
    [item_count] => 0
)

[2025-10-11 03:13:33] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1913
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:13:33] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1913
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:13:33] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:13:33] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:13:33] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1913
    [order_id] => 88052
)

[2025-10-11 03:13:33] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:13:33] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88052
    [final_memory_usage] => 126MB
)

[2025-10-11 03:13:33] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:13:33] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88052
    [product_id] => 67487
)

[2025-10-11 03:13:33] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:13:33] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88052
    [timestamp] => 2025-10-11 03:13:33
    [memory_usage] => 130MB
)

[2025-10-11 03:13:33] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88052
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1913
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:13:33
    [item_count] => 1
)

[2025-10-11 03:13:33] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1913
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:13:33] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1913
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:13:33] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:13:33] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:13:33] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1913
    [order_id] => 88052
)

[2025-10-11 03:13:33] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:13:33] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:13:33] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:13:33] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1913
    [order_id] => 88052
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:13:33] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:13:33] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1913
    [order_id] => 88052
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:13:33
)

[2025-10-11 03:13:33] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:13:33] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:13:33] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:13:33] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:13:33] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:13:33] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:13:33] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:13:33] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1913
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:13:33] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1913
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:13:33] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1913
[2025-10-11 03:13:33] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:13:33] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:13:33] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:13:33] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166813
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88052
    [user_id] => 1913
)

[2025-10-11 03:13:33] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:13:33] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:13:33] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:13:33] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1913
)

[2025-10-11 03:13:33] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1913
    [type] => Individual Membership
)

[2025-10-11 03:13:33] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1913
)

[2025-10-11 03:13:33] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:13:33] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88052
    [total] => 77.63
)

[2025-10-11 03:13:33] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:13:33] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:13:33] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:13:33] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1913
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:13:33] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:13:33] [debug] LGL Constituents: All data set for user 1913
[2025-10-11 03:13:34] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946752
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:13:34Z
            [updated_at] => 2025-10-11T07:13:34Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946752,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:13:34Z","updated_at":"2025-10-11T07:13:34Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:13:34] [debug] MembershipOrderHandler: User data updated 1913
[2025-10-11 03:13:34] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:13:34] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1913
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88052
)

[2025-10-11 03:13:34] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:13:34] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:13:34] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166813
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88052
    [user_id] => 1913
)

[2025-10-11 03:13:34] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:13:34
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:13:34] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1913
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88052
)

[2025-10-11 03:13:34] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1913
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:13:34] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:13:34] [debug] Payment method set:  online
[2025-10-11 03:13:34] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:13:34] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:13:34] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:13:34] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:13:34] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:13:34] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:13:34] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:13:34] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:13:34] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:13:34] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:13:34] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:13:34] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:13:34] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:13:34] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:13:34] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1913
)

[2025-10-11 03:13:34] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1913
    [type] => Individual Membership
)

[2025-10-11 03:13:34] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1913
)

[2025-10-11 03:13:34] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:13:34] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88052
    [total] => 77.63
)

[2025-10-11 03:13:34] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:13:34] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:13:34] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:13:34] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1913
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:13:34] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:13:34] [debug] LGL Constituents: All data set for user 1913
[2025-10-11 03:13:35] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:13:35Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:13:35Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:13:35] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:13:35] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:13:35] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1913
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:13:35] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88052
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:13:35] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:13:35] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:13:35] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:13:35] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88052
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88052
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:13:36] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905147
)

[2025-10-11 03:13:36] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88052
    [amount] => 77.63
)

[2025-10-11 03:13:36] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905147
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905147
                    [constituent_id] => 944817
                    [external_id] => 88052
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88052
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:13:36Z
                    [updated_at] => 2025-10-11T07:13:36Z
                )

        )

)

[2025-10-11 03:13:36] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:13:36] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:13:36] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1913
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:13:36] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1913
    [success] => Registration call completed
)

[2025-10-11 03:13:36] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1913
    [lgl_api_called] => YES
)

[2025-10-11 03:13:36] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:13:36] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88052
    [user_id] => 1913
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:13:36] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:13:36] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:13:36] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88052
    [final_memory_usage] => 130MB
)

[2025-10-11 03:14:00] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:14:00] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88053
    [timestamp] => 2025-10-11 03:14:00
    [memory_usage] => 126MB
)

[2025-10-11 03:14:00] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88053
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1914
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:14:00
    [item_count] => 0
)

[2025-10-11 03:14:00] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1914
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:14:00] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1914
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:14:00] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:14:00] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:14:00] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1914
    [order_id] => 88053
)

[2025-10-11 03:14:00] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:14:00] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88053
    [final_memory_usage] => 126MB
)

[2025-10-11 03:14:00] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:14:00] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88053
    [product_id] => 67487
)

[2025-10-11 03:14:01] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:14:01] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88053
    [timestamp] => 2025-10-11 03:14:01
    [memory_usage] => 132MB
)

[2025-10-11 03:14:01] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88053
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1914
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:14:00
    [item_count] => 1
)

[2025-10-11 03:14:01] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1914
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:14:01] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1914
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:14:01] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:14:01] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:14:01] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1914
    [order_id] => 88053
)

[2025-10-11 03:14:01] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:14:01] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:14:01] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:14:01] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1914
    [order_id] => 88053
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:14:01] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:14:01] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1914
    [order_id] => 88053
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:14:01
)

[2025-10-11 03:14:01] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:14:01] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:14:01] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:14:01] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:14:01] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:14:01] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:14:01] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:14:01] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1914
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:14:01] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1914
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:14:01] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1914
[2025-10-11 03:14:01] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:14:01] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:14:01] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:14:01] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166840
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88053
    [user_id] => 1914
)

[2025-10-11 03:14:01] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:14:01] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:14:01] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:14:01] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1914
)

[2025-10-11 03:14:01] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1914
    [type] => Individual Membership
)

[2025-10-11 03:14:01] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1914
)

[2025-10-11 03:14:01] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:14:01] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88053
    [total] => 77.63
)

[2025-10-11 03:14:01] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:14:01] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:14:01] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:14:01] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1914
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:14:01] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:14:01] [debug] LGL Constituents: All data set for user 1914
[2025-10-11 03:14:01] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946757
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:14:01Z
            [updated_at] => 2025-10-11T07:14:01Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946757,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:14:01Z","updated_at":"2025-10-11T07:14:01Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:14:01] [debug] MembershipOrderHandler: User data updated 1914
[2025-10-11 03:14:01] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:14:01] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1914
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88053
)

[2025-10-11 03:14:01] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:14:01] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:14:01] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166840
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88053
    [user_id] => 1914
)

[2025-10-11 03:14:01] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:14:01
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:14:01] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1914
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88053
)

[2025-10-11 03:14:01] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1914
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:14:01] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:14:01] [debug] Payment method set:  online
[2025-10-11 03:14:01] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:14:01] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:14:01] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:14:01] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:14:02] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:14:02] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:14:02] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:14:02] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:14:02] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:14:02] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:14:02] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:14:02] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:14:02] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:14:02] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:14:02] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1914
)

[2025-10-11 03:14:02] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1914
    [type] => Individual Membership
)

[2025-10-11 03:14:02] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1914
)

[2025-10-11 03:14:02] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:14:02] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88053
    [total] => 77.63
)

[2025-10-11 03:14:02] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:14:02] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:14:02] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:14:02] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1914
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:14:02] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:14:02] [debug] LGL Constituents: All data set for user 1914
[2025-10-11 03:14:02] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:14:02Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:14:02Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:14:02] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:14:02] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:14:02] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1914
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:14:02] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88053
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:14:02] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:14:02] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:14:02] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:14:02] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88053
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88053
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:14:03] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905152
)

[2025-10-11 03:14:03] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88053
    [amount] => 77.63
)

[2025-10-11 03:14:03] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905152
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905152
                    [constituent_id] => 944817
                    [external_id] => 88053
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88053
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:14:03Z
                    [updated_at] => 2025-10-11T07:14:03Z
                )

        )

)

[2025-10-11 03:14:03] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:14:03] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:14:03] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1914
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:14:03] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1914
    [success] => Registration call completed
)

[2025-10-11 03:14:03] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1914
    [lgl_api_called] => YES
)

[2025-10-11 03:14:03] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:14:04] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88053
    [user_id] => 1914
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:14:04] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:14:04] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:14:04] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88053
    [final_memory_usage] => 132MB
)

[2025-10-11 03:15:55] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88054
    [timestamp] => 2025-10-11 03:15:55
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:15:55] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88054
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1915
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:15:55
    [item_count] => 0
)

[2025-10-11 03:15:55] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1915
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:15:55] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1915
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:15:55] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:15:55] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:15:55] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1915
    [order_id] => 88054
)

[2025-10-11 03:15:55] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:15:55] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88054
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:15:55] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:15:55] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88054
    [product_id] => 67487
)

[2025-10-11 03:15:55] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:15:56] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88054
    [timestamp] => 2025-10-11 03:15:56
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:15:56] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88054
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1915
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:15:55
    [item_count] => 1
)

[2025-10-11 03:15:56] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1915
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:15:56] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1915
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:15:56] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:15:56] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:15:56] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1915
    [order_id] => 88054
)

[2025-10-11 03:15:56] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:15:56] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:15:56] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:15:56] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1915
    [order_id] => 88054
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:15:56] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:15:56] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1915
    [order_id] => 88054
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:15:56
)

[2025-10-11 03:15:56] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:15:56] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:15:56] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:15:56] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:15:56] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:15:56] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:15:56] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:15:56] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1915
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:15:56] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1915
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:15:56] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1915
[2025-10-11 03:15:56] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:15:56] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:15:56] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:15:56] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166955
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88054
    [user_id] => 1915
)

[2025-10-11 03:15:56] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:15:56] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:15:56] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:15:56] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1915
)

[2025-10-11 03:15:56] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1915
    [type] => Individual Membership
)

[2025-10-11 03:15:56] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1915
)

[2025-10-11 03:15:56] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:15:56] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88054
    [total] => 77.63
)

[2025-10-11 03:15:56] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:15:56] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:15:56] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:15:56] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1915
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:15:56] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:15:56] [debug] LGL Constituents: All data set for user 1915
[2025-10-11 03:15:56] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946762
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:15:56Z
            [updated_at] => 2025-10-11T07:15:56Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946762,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:15:56Z","updated_at":"2025-10-11T07:15:56Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:15:56] [debug] MembershipOrderHandler: User data updated 1915
[2025-10-11 03:15:56] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:15:56] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1915
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88054
)

[2025-10-11 03:15:56] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:15:56] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:15:56] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166955
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88054
    [user_id] => 1915
)

[2025-10-11 03:15:56] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:15:56
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:15:56] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1915
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88054
)

[2025-10-11 03:15:56] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1915
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:15:56] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:15:56] [debug] Payment method set:  online
[2025-10-11 03:15:56] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:15:56] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:15:56] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:15:56] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:15:57] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:15:57] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:15:57] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:15:57] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:15:57] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:15:57] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:15:57] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:15:57] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:15:57] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:15:57] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:15:57] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1915
)

[2025-10-11 03:15:57] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1915
    [type] => Individual Membership
)

[2025-10-11 03:15:57] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1915
)

[2025-10-11 03:15:57] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:15:57] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88054
    [total] => 77.63
)

[2025-10-11 03:15:57] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:15:57] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:15:57] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:15:57] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1915
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:15:57] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:15:57] [debug] LGL Constituents: All data set for user 1915
[2025-10-11 03:15:57] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:15:57Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:15:57Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:15:58] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:15:58] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:15:58] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1915
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:15:58] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88054
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:15:58] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:15:58] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:15:58] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:15:58] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88054
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88054
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:15:58] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905157
)

[2025-10-11 03:15:58] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88054
    [amount] => 77.63
)

[2025-10-11 03:15:58] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905157
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905157
                    [constituent_id] => 944817
                    [external_id] => 88054
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88054
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:15:58Z
                    [updated_at] => 2025-10-11T07:15:58Z
                )

        )

)

[2025-10-11 03:15:59] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:15:59] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:15:59] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1915
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:15:59] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1915
    [success] => Registration call completed
)

[2025-10-11 03:15:59] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1915
    [lgl_api_called] => YES
)

[2025-10-11 03:15:59] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:15:59] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88054
    [user_id] => 1915
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:15:59] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:15:59] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:15:59] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88054
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:16:11] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88055
    [timestamp] => 2025-10-11 03:16:11
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:16:11] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88055
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1916
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:16:11
    [item_count] => 0
)

[2025-10-11 03:16:11] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1916
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:16:11] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1916
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:16:11] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:16:11] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:16:11] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1916
    [order_id] => 88055
)

[2025-10-11 03:16:11] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:16:11] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88055
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:16:11] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:16:11] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88055
    [product_id] => 67487
)

[2025-10-11 03:16:11] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:16:11] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88055
    [timestamp] => 2025-10-11 03:16:11
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:16:11] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88055
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1916
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:16:11
    [item_count] => 1
)

[2025-10-11 03:16:11] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1916
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:16:11] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1916
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:16:11] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:16:11] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:16:11] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1916
    [order_id] => 88055
)

[2025-10-11 03:16:11] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:16:11] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:16:11] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:16:11] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1916
    [order_id] => 88055
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:16:11] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:16:11] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1916
    [order_id] => 88055
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:16:11
)

[2025-10-11 03:16:11] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:16:11] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:16:11] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:16:11] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:16:11] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:16:11] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:16:11] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:16:11] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1916
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:16:11] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1916
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:16:11] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1916
[2025-10-11 03:16:11] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:16:11] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:16:11] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:16:11] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166971
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88055
    [user_id] => 1916
)

[2025-10-11 03:16:11] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:16:11] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:16:11] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:16:11] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1916
)

[2025-10-11 03:16:11] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1916
    [type] => Individual Membership
)

[2025-10-11 03:16:11] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1916
)

[2025-10-11 03:16:11] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:16:11] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88055
    [total] => 77.63
)

[2025-10-11 03:16:11] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:16:11] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:16:11] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:16:11] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1916
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:16:11] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:16:11] [debug] LGL Constituents: All data set for user 1916
[2025-10-11 03:16:11] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946767
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:16:11Z
            [updated_at] => 2025-10-11T07:16:11Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946767,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:16:11Z","updated_at":"2025-10-11T07:16:11Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:16:11] [debug] MembershipOrderHandler: User data updated 1916
[2025-10-11 03:16:11] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:16:11] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1916
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88055
)

[2025-10-11 03:16:11] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:16:11] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:16:11] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166971
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88055
    [user_id] => 1916
)

[2025-10-11 03:16:11] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:16:11
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:16:11] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1916
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88055
)

[2025-10-11 03:16:11] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1916
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:16:11] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:16:11] [debug] Payment method set:  online
[2025-10-11 03:16:11] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:16:11] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:16:11] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:16:11] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:16:12] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:16:12] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:16:12] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:16:12] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:16:12] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:16:12] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:16:12] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:16:12] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:16:12] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:16:12] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:16:12] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1916
)

[2025-10-11 03:16:12] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1916
    [type] => Individual Membership
)

[2025-10-11 03:16:12] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1916
)

[2025-10-11 03:16:12] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:16:12] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88055
    [total] => 77.63
)

[2025-10-11 03:16:12] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:16:12] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:16:12] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:16:12] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1916
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:16:12] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:16:12] [debug] LGL Constituents: All data set for user 1916
[2025-10-11 03:16:12] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:16:12Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:16:12Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:16:13] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:16:13] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:16:13] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1916
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:16:13] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88055
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:16:13] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:16:13] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:16:13] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:16:13] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88055
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88055
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:16:13] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905162
)

[2025-10-11 03:16:13] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88055
    [amount] => 77.63
)

[2025-10-11 03:16:13] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905162
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905162
                    [constituent_id] => 944817
                    [external_id] => 88055
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88055
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:16:13Z
                    [updated_at] => 2025-10-11T07:16:13Z
                )

        )

)

[2025-10-11 03:16:14] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:16:14] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:16:14] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1916
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:16:14] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1916
    [success] => Registration call completed
)

[2025-10-11 03:16:14] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1916
    [lgl_api_called] => YES
)

[2025-10-11 03:16:14] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:16:14] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88055
    [user_id] => 1916
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:16:14] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:16:14] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:16:14] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88055
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:16:29] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:16:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88056
    [timestamp] => 2025-10-11 03:16:29
    [memory_usage] => 124MB
)

[2025-10-11 03:16:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88056
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1917
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:16:29
    [item_count] => 0
)

[2025-10-11 03:16:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1917
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:16:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1917
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:16:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:16:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:16:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1917
    [order_id] => 88056
)

[2025-10-11 03:16:29] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:16:29] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88056
    [final_memory_usage] => 124MB
)

[2025-10-11 03:16:29] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:16:29] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88056
    [product_id] => 67487
)

[2025-10-11 03:16:29] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:16:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88056
    [timestamp] => 2025-10-11 03:16:29
    [memory_usage] => 128MB
)

[2025-10-11 03:16:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88056
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1917
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:16:29
    [item_count] => 1
)

[2025-10-11 03:16:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1917
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:16:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1917
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:16:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:16:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:16:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1917
    [order_id] => 88056
)

[2025-10-11 03:16:29] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:16:29] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:16:29] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:16:29] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1917
    [order_id] => 88056
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:16:29] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:16:29] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1917
    [order_id] => 88056
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:16:29
)

[2025-10-11 03:16:29] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:16:29] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:16:29] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:16:29] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:16:29] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:16:29] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:16:29] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:16:29] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1917
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:16:29] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1917
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:16:29] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1917
[2025-10-11 03:16:29] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:16:29] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:16:29] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:16:29] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166989
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88056
    [user_id] => 1917
)

[2025-10-11 03:16:29] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:16:29] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:16:29] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:16:29] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1917
)

[2025-10-11 03:16:29] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1917
    [type] => Individual Membership
)

[2025-10-11 03:16:29] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1917
)

[2025-10-11 03:16:29] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:16:29] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88056
    [total] => 77.63
)

[2025-10-11 03:16:29] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:16:29] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:16:29] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:16:29] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1917
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:16:29] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:16:29] [debug] LGL Constituents: All data set for user 1917
[2025-10-11 03:16:30] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946772
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:16:30Z
            [updated_at] => 2025-10-11T07:16:30Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946772,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:16:30Z","updated_at":"2025-10-11T07:16:30Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:16:30] [debug] MembershipOrderHandler: User data updated 1917
[2025-10-11 03:16:30] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:16:30] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1917
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88056
)

[2025-10-11 03:16:30] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:16:30] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:16:30] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760166989
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88056
    [user_id] => 1917
)

[2025-10-11 03:16:30] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:16:30
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:16:30] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1917
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88056
)

[2025-10-11 03:16:30] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1917
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:16:30] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:16:30] [debug] Payment method set:  online
[2025-10-11 03:16:30] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:16:30] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:16:30] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:16:30] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:16:30] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:16:30] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:16:30] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:16:30] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:16:30] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:16:30] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:16:30] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:16:30] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:16:30] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:16:30] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:16:30] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1917
)

[2025-10-11 03:16:30] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1917
    [type] => Individual Membership
)

[2025-10-11 03:16:30] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1917
)

[2025-10-11 03:16:30] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:16:30] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88056
    [total] => 77.63
)

[2025-10-11 03:16:30] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:16:30] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:16:31] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:16:31] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1917
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:16:31] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:16:31] [debug] LGL Constituents: All data set for user 1917
[2025-10-11 03:16:31] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:16:31Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:16:31Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:16:31] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:16:31] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:16:31] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1917
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:16:31] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88056
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:16:31] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:16:31] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:16:31] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:16:31] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88056
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88056
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:16:32] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905167
)

[2025-10-11 03:16:32] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88056
    [amount] => 77.63
)

[2025-10-11 03:16:32] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905167
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905167
                    [constituent_id] => 944817
                    [external_id] => 88056
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88056
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:16:32Z
                    [updated_at] => 2025-10-11T07:16:32Z
                )

        )

)

[2025-10-11 03:16:32] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:16:32] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:16:32] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1917
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:16:32] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1917
    [success] => Registration call completed
)

[2025-10-11 03:16:32] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1917
    [lgl_api_called] => YES
)

[2025-10-11 03:16:32] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:16:32] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88056
    [user_id] => 1917
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:16:32] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:16:32] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:16:32] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88056
    [final_memory_usage] => 128MB
)

[2025-10-11 03:21:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88057
    [timestamp] => 2025-10-11 03:21:29
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:21:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88057
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1918
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:21:29
    [item_count] => 0
)

[2025-10-11 03:21:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1918
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:21:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1918
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:21:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:21:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:21:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1918
    [order_id] => 88057
)

[2025-10-11 03:21:29] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:21:29] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88057
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:21:29] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:21:29] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88057
    [product_id] => 67487
)

[2025-10-11 03:21:29] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:21:29] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88057
    [timestamp] => 2025-10-11 03:21:29
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:21:29] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88057
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1918
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:21:29
    [item_count] => 1
)

[2025-10-11 03:21:29] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1918
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:21:29] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1918
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:21:29] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:21:29] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:21:29] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1918
    [order_id] => 88057
)

[2025-10-11 03:21:29] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:21:29] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:21:29] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:21:29] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1918
    [order_id] => 88057
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:21:29] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:21:29] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1918
    [order_id] => 88057
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:21:29
)

[2025-10-11 03:21:29] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:21:29] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:21:29] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:21:29] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:21:29] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:21:29] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:21:29] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:21:29] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1918
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:21:29] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1918
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:21:29] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1918
[2025-10-11 03:21:29] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:21:29] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:21:29] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:21:29] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167289
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88057
    [user_id] => 1918
)

[2025-10-11 03:21:29] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:21:29] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:21:29] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:21:29] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1918
)

[2025-10-11 03:21:29] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1918
    [type] => Individual Membership
)

[2025-10-11 03:21:29] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1918
)

[2025-10-11 03:21:29] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:21:29] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88057
    [total] => 77.63
)

[2025-10-11 03:21:29] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:21:29] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:21:29] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:21:29] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1918
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:21:29] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:21:29] [debug] LGL Constituents: All data set for user 1918
[2025-10-11 03:21:30] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946777
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:21:30Z
            [updated_at] => 2025-10-11T07:21:30Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946777,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:21:30Z","updated_at":"2025-10-11T07:21:30Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:21:30] [debug] MembershipOrderHandler: User data updated 1918
[2025-10-11 03:21:30] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:21:30] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1918
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88057
)

[2025-10-11 03:21:30] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:21:30] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:21:30] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167289
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88057
    [user_id] => 1918
)

[2025-10-11 03:21:30] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:21:30
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:21:30] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1918
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88057
)

[2025-10-11 03:21:30] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1918
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:21:30] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:21:30] [debug] Payment method set:  online
[2025-10-11 03:21:30] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:21:30] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:21:30] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:21:30] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:21:30] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:21:30] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:21:30] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:21:30] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:21:30] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:21:30] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:21:30] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:21:30] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:21:30] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:21:30] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:21:30] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1918
)

[2025-10-11 03:21:30] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1918
    [type] => Individual Membership
)

[2025-10-11 03:21:30] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1918
)

[2025-10-11 03:21:30] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:21:30] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88057
    [total] => 77.63
)

[2025-10-11 03:21:30] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:21:30] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:21:30] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:21:30] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1918
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:21:30] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:21:30] [debug] LGL Constituents: All data set for user 1918
[2025-10-11 03:21:31] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:21:31Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:21:31Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:21:31] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:21:31] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:21:31] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1918
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:21:31] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88057
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:21:31] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:21:31] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:21:31] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:21:31] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88057
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88057
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:21:32] [debug] âŒ Failed to add payment Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 905172
            [constituent_id] => 944817
            [external_id] => 88057
            [is_anon] => 
            [gift_type_id] => 5
            [gift_type_name] => Other Income
            [gift_category_id] => 6092
            [gift_category_name] => Donation
            [campaign_id] => 857
            [campaign_name] => Membership Fees
            [fund_id] => 4127
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 1542
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 0
            [note] => Website Registration, Order #88057
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 
            [tribute_name] => 
            [tributee_name] => 
            [tribute_dedication] => 
            [tribute_recipient_name] => 
            [tribute_recipient_salutation] => 
            [tribute_recipient_email] => 
            [tribute_recipient_address] => 
            [tribute_recipient_notification_template] => 
            [team_member] => 
            [team_member_email] => 
            [custom_fields] => Array
                (
                )

            [created_at] => 2025-10-11T07:21:32Z
            [updated_at] => 2025-10-11T07:21:32Z
        )

    [raw_response] => {"api_version":"1.0","id":905172,"constituent_id":944817,"external_id":"88057","is_anon":false,"gift_type_id":5,"gift_type_name":"Other Income","gift_category_id":6092,"gift_category_name":"Donation","campaign_id":857,"campaign_name":"Membership Fees","fund_id":4127,"fund_name":"General Fund","appeal_id":0,"appeal_name":null,"event_id":0,"event_name":null,"received_amount":77.63,"received_date":"2025-10-11","payment_type_id":1542,"payment_type_name":"online","check_number":"","deductible_amount":0.0,"note":"Website Registration, Order #88057","ack_template_name":null,"deposit_date":"2025-10-11","deposited_amount":77.63,"parent_gift_id":0,"parent_external_id":null,"tribute_name":null,"tributee_name":null,"tribute_dedication":null,"tribute_recipient_name":null,"tribute_recipient_salutation":null,"tribute_recipient_email":null,"tribute_recipient_address":null,"tribute_recipient_notification_template":null,"team_member":null,"team_member_email":null,"custom_fields":[],"created_at":"2025-10-11T07:21:32Z","updated_at":"2025-10-11T07:21:32Z"}
)

[2025-10-11 03:21:32] [debug] LGL Payments: Failed to create membership payment Unknown error
[2025-10-11 03:21:32] [debug] âŒ Payment creation failed Array
(
    [error] => Payment data creation failed: Unknown error
    [uid] => 1918
    [lgl_id] => 944817
)

[2025-10-11 03:21:32] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1918
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:21:32] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1918
    [success] => Registration call completed
)

[2025-10-11 03:21:32] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1918
    [lgl_api_called] => YES
)

[2025-10-11 03:21:32] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:21:32] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88057
    [user_id] => 1918
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:21:32] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:21:32] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:21:32] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88057
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:21:58] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88058
    [timestamp] => 2025-10-11 03:21:58
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:21:58] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88058
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1919
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:21:58
    [item_count] => 0
)

[2025-10-11 03:21:58] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1919
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:21:58] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1919
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:21:58] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:21:58] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:21:58] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1919
    [order_id] => 88058
)

[2025-10-11 03:21:58] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:21:58] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88058
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:21:58] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:21:58] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88058
    [product_id] => 67487
)

[2025-10-11 03:21:58] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:21:58] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88058
    [timestamp] => 2025-10-11 03:21:58
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:21:58] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88058
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1919
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:21:58
    [item_count] => 1
)

[2025-10-11 03:21:58] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1919
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:21:58] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1919
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:21:58] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:21:58] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:21:58] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1919
    [order_id] => 88058
)

[2025-10-11 03:21:58] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:21:58] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:21:58] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:21:58] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1919
    [order_id] => 88058
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:21:58] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:21:58] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1919
    [order_id] => 88058
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:21:58
)

[2025-10-11 03:21:58] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:21:58] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:21:58] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:21:58] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:21:58] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:21:58] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:21:58] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:21:58] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1919
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:21:58] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1919
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:21:58] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1919
[2025-10-11 03:21:58] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:21:58] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:21:58] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:21:58] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167318
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88058
    [user_id] => 1919
)

[2025-10-11 03:21:58] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:21:58] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:21:58] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:21:58] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1919
)

[2025-10-11 03:21:58] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1919
    [type] => Individual Membership
)

[2025-10-11 03:21:58] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1919
)

[2025-10-11 03:21:58] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:21:58] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88058
    [total] => 77.63
)

[2025-10-11 03:21:58] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:21:58] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:21:58] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:21:58] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1919
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:21:58] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:21:58] [debug] LGL Constituents: All data set for user 1919
[2025-10-11 03:21:58] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946782
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:21:58Z
            [updated_at] => 2025-10-11T07:21:58Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946782,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:21:58Z","updated_at":"2025-10-11T07:21:58Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:21:58] [debug] MembershipOrderHandler: User data updated 1919
[2025-10-11 03:21:58] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:21:58] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1919
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88058
)

[2025-10-11 03:21:58] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:21:58] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:21:58] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167318
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88058
    [user_id] => 1919
)

[2025-10-11 03:21:58] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:21:58
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:21:58] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1919
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88058
)

[2025-10-11 03:21:58] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1919
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:21:58] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:21:58] [debug] Payment method set:  online
[2025-10-11 03:21:58] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:21:58] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:21:58] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:21:58] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:21:59] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:21:59] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:21:59] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:21:59] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:21:59] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:21:59] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:21:59] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:21:59] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:21:59] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:21:59] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:21:59] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1919
)

[2025-10-11 03:21:59] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1919
    [type] => Individual Membership
)

[2025-10-11 03:21:59] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1919
)

[2025-10-11 03:21:59] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:21:59] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88058
    [total] => 77.63
)

[2025-10-11 03:21:59] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:21:59] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:21:59] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:21:59] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1919
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:21:59] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:21:59] [debug] LGL Constituents: All data set for user 1919
[2025-10-11 03:21:59] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:21:59Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:21:59Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:22:00] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:22:00] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:22:00] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1919
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:22:00] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88058
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:22:00] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:22:00] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:22:00] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:22:00] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88058
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88058
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:22:00] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905177
)

[2025-10-11 03:22:00] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88058
    [amount] => 77.63
)

[2025-10-11 03:22:00] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [success] => 1
            [id] => 905177
            [data] => Array
                (
                    [api_version] => 1.0
                    [id] => 905177
                    [constituent_id] => 944817
                    [external_id] => 88058
                    [is_anon] => 
                    [gift_type_id] => 5
                    [gift_type_name] => Other Income
                    [gift_category_id] => 6092
                    [gift_category_name] => Donation
                    [campaign_id] => 857
                    [campaign_name] => Membership Fees
                    [fund_id] => 4127
                    [fund_name] => General Fund
                    [appeal_id] => 0
                    [appeal_name] => 
                    [event_id] => 0
                    [event_name] => 
                    [received_amount] => 77.63
                    [received_date] => 2025-10-11
                    [payment_type_id] => 1542
                    [payment_type_name] => online
                    [check_number] => 
                    [deductible_amount] => 0
                    [note] => Website Registration, Order #88058
                    [ack_template_name] => 
                    [deposit_date] => 2025-10-11
                    [deposited_amount] => 77.63
                    [parent_gift_id] => 0
                    [parent_external_id] => 
                    [tribute_name] => 
                    [tributee_name] => 
                    [tribute_dedication] => 
                    [tribute_recipient_name] => 
                    [tribute_recipient_salutation] => 
                    [tribute_recipient_email] => 
                    [tribute_recipient_address] => 
                    [tribute_recipient_notification_template] => 
                    [team_member] => 
                    [team_member_email] => 
                    [custom_fields] => Array
                        (
                        )

                    [created_at] => 2025-10-11T07:22:00Z
                    [updated_at] => 2025-10-11T07:22:00Z
                )

        )

)

[2025-10-11 03:22:01] [debug] âŒ Failed to add payment Array
(
    [success] => 
    [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
    [http_code] => 422
    [data] => 
)

[2025-10-11 03:22:01] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => Array
        (
            [success] => 
            [error] => HTTP 422: {"api_version":"1.0","error":"error saving object","description":"A gift must have a type and amount to be created; Amount must be a valid number, like 200.05 or 150"}
            [http_code] => 422
        )

)

[2025-10-11 03:22:01] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1919
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:22:01] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1919
    [success] => Registration call completed
)

[2025-10-11 03:22:01] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1919
    [lgl_api_called] => YES
)

[2025-10-11 03:22:01] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:22:01] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88058
    [user_id] => 1919
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:22:01] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:22:01] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:22:01] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88058
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:25:14] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88059
    [timestamp] => 2025-10-11 03:25:14
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:25:15] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88059
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1920
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:25:14
    [item_count] => 0
)

[2025-10-11 03:25:15] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1920
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:25:15] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1920
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:25:15] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:25:15] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:25:15] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1920
    [order_id] => 88059
)

[2025-10-11 03:25:15] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:25:15] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88059
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:25:15] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:25:15] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88059
    [product_id] => 67487
)

[2025-10-11 03:25:15] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:25:15] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88059
    [timestamp] => 2025-10-11 03:25:15
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:25:15] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88059
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1920
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:25:14
    [item_count] => 1
)

[2025-10-11 03:25:15] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1920
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:25:15] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1920
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:25:15] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:25:15] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:25:15] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1920
    [order_id] => 88059
)

[2025-10-11 03:25:15] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:25:15] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:25:15] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:25:15] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1920
    [order_id] => 88059
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:25:15] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:25:15] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1920
    [order_id] => 88059
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:25:15
)

[2025-10-11 03:25:15] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:25:15] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:25:15] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:25:15] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:25:15] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:25:15] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:25:15] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:25:15] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1920
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:25:15] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1920
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:25:15] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1920
[2025-10-11 03:25:15] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:25:15] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:25:15] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:25:15] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167514
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88059
    [user_id] => 1920
)

[2025-10-11 03:25:15] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:25:15] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:25:15] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:25:15] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1920
)

[2025-10-11 03:25:15] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1920
    [type] => Individual Membership
)

[2025-10-11 03:25:15] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1920
)

[2025-10-11 03:25:15] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:25:15] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88059
    [total] => 77.63
)

[2025-10-11 03:25:15] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:25:15] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:25:15] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:25:15] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1920
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:25:15] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:25:15] [debug] LGL Constituents: All data set for user 1920
[2025-10-11 03:25:15] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946787
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:25:15Z
            [updated_at] => 2025-10-11T07:25:15Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946787,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:25:15Z","updated_at":"2025-10-11T07:25:15Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:25:15] [debug] MembershipOrderHandler: User data updated 1920
[2025-10-11 03:25:15] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:25:15] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1920
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88059
)

[2025-10-11 03:25:15] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:25:15] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:25:15] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167514
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88059
    [user_id] => 1920
)

[2025-10-11 03:25:15] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:25:15
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:25:15] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1920
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88059
)

[2025-10-11 03:25:15] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1920
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:25:15] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:25:15] [debug] Payment method set:  online
[2025-10-11 03:25:15] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:25:15] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:25:15] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:25:15] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:25:16] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:25:16] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:25:16] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:25:16] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:25:16] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:25:16] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:25:16] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:25:16] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:25:16] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:25:16] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:25:16] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1920
)

[2025-10-11 03:25:16] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1920
    [type] => Individual Membership
)

[2025-10-11 03:25:16] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1920
)

[2025-10-11 03:25:16] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:25:16] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88059
    [total] => 77.63
)

[2025-10-11 03:25:16] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:25:16] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:25:16] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:25:16] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1920
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:25:16] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:25:16] [debug] LGL Constituents: All data set for user 1920
[2025-10-11 03:25:16] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:25:16Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:25:16Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:25:17] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:25:17] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:25:17] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1920
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:25:17] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88059
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:25:17] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:25:17] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:25:17] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:25:17] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88059
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88059
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:25:17] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905182
)

[2025-10-11 03:25:17] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88059
    [amount] => 77.63
)

[2025-10-11 03:25:17] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905182
    [lgl_id] => 944817
    [order_id] => 88059
    [amount] => 77.63
)

[2025-10-11 03:25:17] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1920
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:25:17] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1920
    [success] => Registration call completed
)

[2025-10-11 03:25:17] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1920
    [lgl_api_called] => YES
)

[2025-10-11 03:25:17] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:25:17] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88059
    [user_id] => 1920
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:25:17] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:25:17] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:25:17] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88059
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:26:04] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:26:04] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88060
    [timestamp] => 2025-10-11 03:26:04
    [memory_usage] => 124MB
)

[2025-10-11 03:26:04] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88060
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1921
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:26:04
    [item_count] => 0
)

[2025-10-11 03:26:04] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1921
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:26:04] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1921
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:26:04] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:26:04] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:26:04] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1921
    [order_id] => 88060
)

[2025-10-11 03:26:04] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:26:04] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88060
    [final_memory_usage] => 124MB
)

[2025-10-11 03:26:04] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:26:04] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88060
    [product_id] => 67487
)

[2025-10-11 03:26:04] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:26:05] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88060
    [timestamp] => 2025-10-11 03:26:05
    [memory_usage] => 128MB
)

[2025-10-11 03:26:05] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88060
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1921
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:26:04
    [item_count] => 1
)

[2025-10-11 03:26:05] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1921
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:26:05] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1921
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:26:05] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:26:05] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:26:05] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1921
    [order_id] => 88060
)

[2025-10-11 03:26:05] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:26:05] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:26:05] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:26:05] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1921
    [order_id] => 88060
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:26:05] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:26:05] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1921
    [order_id] => 88060
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:26:05
)

[2025-10-11 03:26:05] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:26:05] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:26:05] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:26:05] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:26:05] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:26:05] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:26:05] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:26:05] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1921
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:26:05] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1921
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:26:05] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1921
[2025-10-11 03:26:05] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:26:05] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:26:05] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:26:05] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167564
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88060
    [user_id] => 1921
)

[2025-10-11 03:26:05] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:26:05] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:26:05] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:26:05] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1921
)

[2025-10-11 03:26:05] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1921
    [type] => Individual Membership
)

[2025-10-11 03:26:05] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1921
)

[2025-10-11 03:26:05] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:26:05] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88060
    [total] => 77.63
)

[2025-10-11 03:26:05] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:26:05] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:26:05] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:26:05] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1921
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:26:05] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:26:05] [debug] LGL Constituents: All data set for user 1921
[2025-10-11 03:26:05] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946792
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:26:05Z
            [updated_at] => 2025-10-11T07:26:05Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946792,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:26:05Z","updated_at":"2025-10-11T07:26:05Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:26:05] [debug] MembershipOrderHandler: User data updated 1921
[2025-10-11 03:26:05] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:26:05] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1921
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88060
)

[2025-10-11 03:26:05] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:26:05] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:26:05] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167564
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88060
    [user_id] => 1921
)

[2025-10-11 03:26:05] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:26:05
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:26:05] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1921
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88060
)

[2025-10-11 03:26:05] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1921
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:26:05] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:26:05] [debug] Payment method set:  online
[2025-10-11 03:26:05] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:26:05] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:26:05] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:26:05] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:26:06] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:26:06] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:26:06] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:26:06] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:26:06] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:26:06] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:26:06] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:26:06] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:26:06] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:26:06] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:26:06] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1921
)

[2025-10-11 03:26:06] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1921
    [type] => Individual Membership
)

[2025-10-11 03:26:06] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1921
)

[2025-10-11 03:26:06] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:26:06] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88060
    [total] => 77.63
)

[2025-10-11 03:26:06] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:26:06] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:26:06] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:26:06] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1921
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:26:06] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:26:06] [debug] LGL Constituents: All data set for user 1921
[2025-10-11 03:26:06] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:26:06Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:26:06Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:26:07] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:26:07] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:26:07] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1921
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:26:07] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88060
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:26:07] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:26:07] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:26:07] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:26:07] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88060
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88060
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:26:07] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905187
)

[2025-10-11 03:26:07] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88060
    [amount] => 77.63
)

[2025-10-11 03:26:07] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905187
    [lgl_id] => 944817
    [order_id] => 88060
    [amount] => 77.63
)

[2025-10-11 03:26:07] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1921
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:26:07] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1921
    [success] => Registration call completed
)

[2025-10-11 03:26:07] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1921
    [lgl_api_called] => YES
)

[2025-10-11 03:26:07] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:26:07] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88060
    [user_id] => 1921
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:26:07] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:26:07] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:26:07] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88060
    [final_memory_usage] => 128MB
)

[2025-10-11 03:30:56] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88061
    [timestamp] => 2025-10-11 03:30:56
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:30:56] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88061
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1922
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:30:56
    [item_count] => 0
)

[2025-10-11 03:30:56] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1922
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:30:56] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1922
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:30:56] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:30:56] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:30:56] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1922
    [order_id] => 88061
)

[2025-10-11 03:30:56] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:30:56] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88061
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:30:56] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:30:56] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88061
    [product_id] => 67487
)

[2025-10-11 03:30:56] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:30:56] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88061
    [timestamp] => 2025-10-11 03:30:56
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:30:56] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88061
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1922
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:30:56
    [item_count] => 1
)

[2025-10-11 03:30:56] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1922
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:30:56] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1922
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:30:56] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:30:56] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:30:56] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1922
    [order_id] => 88061
)

[2025-10-11 03:30:56] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:30:56] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:30:56] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:30:56] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1922
    [order_id] => 88061
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:30:56] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:30:56] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1922
    [order_id] => 88061
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:30:56
)

[2025-10-11 03:30:56] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:30:56] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:30:56] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:30:56] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:30:56] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:30:56] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:30:56] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:30:56] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1922
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:30:56] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1922
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:30:56] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1922
[2025-10-11 03:30:56] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:30:56] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:30:56] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:30:56] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167856
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88061
    [user_id] => 1922
)

[2025-10-11 03:30:56] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:30:56] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:30:56] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:30:56] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1922
)

[2025-10-11 03:30:56] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1922
    [type] => Individual Membership
)

[2025-10-11 03:30:56] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1922
)

[2025-10-11 03:30:56] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:30:56] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88061
    [total] => 77.63
)

[2025-10-11 03:30:56] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:30:56] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:30:56] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:30:56] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1922
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:30:56] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:30:56] [debug] LGL Constituents: All data set for user 1922
[2025-10-11 03:30:57] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946797
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:30:57Z
            [updated_at] => 2025-10-11T07:30:57Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946797,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:30:57Z","updated_at":"2025-10-11T07:30:57Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:30:57] [debug] MembershipOrderHandler: User data updated 1922
[2025-10-11 03:30:57] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:30:57] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1922
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88061
)

[2025-10-11 03:30:57] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:30:57] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:30:57] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167856
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88061
    [user_id] => 1922
)

[2025-10-11 03:30:57] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:30:57
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:30:57] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1922
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88061
)

[2025-10-11 03:30:57] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1922
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:30:57] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:30:57] [debug] Payment method set:  online
[2025-10-11 03:30:57] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:30:57] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:30:57] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:30:57] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:30:58] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:30:58] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:30:58] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:30:58] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:30:58] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:30:58] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:30:58] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:30:58] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:30:58] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:30:58] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:30:58] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1922
)

[2025-10-11 03:30:58] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1922
    [type] => Individual Membership
)

[2025-10-11 03:30:58] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1922
)

[2025-10-11 03:30:58] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:30:58] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88061
    [total] => 77.63
)

[2025-10-11 03:30:58] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:30:58] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:30:58] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:30:58] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1922
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:30:58] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:30:58] [debug] LGL Constituents: All data set for user 1922
[2025-10-11 03:30:58] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:30:58Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:30:58Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:30:59] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:30:59] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:30:59] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1922
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:30:59] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88061
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:30:59] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:30:59] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:30:59] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:30:59] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88061
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88061
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:30:59] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905192
)

[2025-10-11 03:30:59] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88061
    [amount] => 77.63
)

[2025-10-11 03:30:59] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905192
    [lgl_id] => 944817
    [order_id] => 88061
    [amount] => 77.63
)

[2025-10-11 03:30:59] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1922
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:30:59] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1922
    [success] => Registration call completed
)

[2025-10-11 03:30:59] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1922
    [lgl_api_called] => YES
)

[2025-10-11 03:30:59] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:30:59] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88061
    [user_id] => 1922
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:30:59] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:30:59] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:30:59] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88061
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:32:14] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88062
    [timestamp] => 2025-10-11 03:32:14
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:32:14] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88062
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1923
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:32:14
    [item_count] => 0
)

[2025-10-11 03:32:14] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1923
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:32:14] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1923
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:32:14] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:32:14] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:32:14] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1923
    [order_id] => 88062
)

[2025-10-11 03:32:14] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:32:14] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88062
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:32:14] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:32:14] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88062
    [product_id] => 67487
)

[2025-10-11 03:32:15] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:32:15] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88062
    [timestamp] => 2025-10-11 03:32:15
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:32:15] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88062
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1923
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:32:14
    [item_count] => 1
)

[2025-10-11 03:32:15] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1923
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:32:15] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1923
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:32:15] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:32:15] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:32:15] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1923
    [order_id] => 88062
)

[2025-10-11 03:32:15] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:32:15] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:32:15] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:32:15] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1923
    [order_id] => 88062
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:32:15] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:32:15] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1923
    [order_id] => 88062
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:32:15
)

[2025-10-11 03:32:15] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:32:15] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:32:15] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:32:15] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:32:15] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:32:15] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:32:15] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:32:15] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1923
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:32:15] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1923
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:32:15] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1923
[2025-10-11 03:32:15] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:32:15] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:32:15] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:32:15] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167934
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88062
    [user_id] => 1923
)

[2025-10-11 03:32:15] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:32:15] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:32:15] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:32:15] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1923
)

[2025-10-11 03:32:15] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1923
    [type] => Individual Membership
)

[2025-10-11 03:32:15] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1923
)

[2025-10-11 03:32:15] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:32:15] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88062
    [total] => 77.63
)

[2025-10-11 03:32:15] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:32:15] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:32:15] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:32:15] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:32:15] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1923
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:32:15] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:32:15] [debug] LGL Constituents: All data set for user 1923
[2025-10-11 03:32:15] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946802
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:32:15Z
            [updated_at] => 2025-10-11T07:32:15Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946802,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:32:15Z","updated_at":"2025-10-11T07:32:15Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:32:15] [debug] MembershipOrderHandler: User data updated 1923
[2025-10-11 03:32:15] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:32:15] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1923
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88062
)

[2025-10-11 03:32:15] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:32:15] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:32:15] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167934
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88062
    [user_id] => 1923
)

[2025-10-11 03:32:15] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:32:15
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:32:15] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1923
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88062
)

[2025-10-11 03:32:15] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1923
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:32:15] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:32:15] [debug] Payment method set:  online
[2025-10-11 03:32:15] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:32:15] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:32:15] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:32:15] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:32:16] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:32:16] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:32:16] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:32:16] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:32:16] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:32:16] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:32:16] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:32:16] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:32:16] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:32:16] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:32:16] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1923
)

[2025-10-11 03:32:16] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1923
    [type] => Individual Membership
)

[2025-10-11 03:32:16] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1923
)

[2025-10-11 03:32:16] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:32:16] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88062
    [total] => 77.63
)

[2025-10-11 03:32:16] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:32:16] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:32:16] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:32:16] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:32:16] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1923
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:32:16] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:32:16] [debug] LGL Constituents: All data set for user 1923
[2025-10-11 03:32:16] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:32:16Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:32:16Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:32:17] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:32:17] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:32:17] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1923
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:32:17] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88062
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:32:17] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:32:17] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:32:17] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:32:17] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88062
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88062
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:32:18] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905197
)

[2025-10-11 03:32:18] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88062
    [amount] => 77.63
)

[2025-10-11 03:32:18] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905197
    [lgl_id] => 944817
    [order_id] => 88062
    [amount] => 77.63
)

[2025-10-11 03:32:18] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1923
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:32:18] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1923
    [success] => Registration call completed
)

[2025-10-11 03:32:18] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1923
    [lgl_api_called] => YES
)

[2025-10-11 03:32:18] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:32:18] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88062
    [user_id] => 1923
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:32:18] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:32:18] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:32:18] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88062
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:32:53] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88063
    [timestamp] => 2025-10-11 03:32:53
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:32:53] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88063
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1924
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:32:53
    [item_count] => 0
)

[2025-10-11 03:32:53] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1924
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:32:53] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1924
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:32:53] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:32:53] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:32:53] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1924
    [order_id] => 88063
)

[2025-10-11 03:32:53] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:32:53] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88063
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:32:53] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:32:53] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88063
    [product_id] => 67487
)

[2025-10-11 03:32:53] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:32:53] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88063
    [timestamp] => 2025-10-11 03:32:53
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:32:53] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88063
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1924
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:32:53
    [item_count] => 1
)

[2025-10-11 03:32:53] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1924
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:32:53] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1924
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:32:53] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:32:53] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:32:53] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1924
    [order_id] => 88063
)

[2025-10-11 03:32:53] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:32:53] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:32:53] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:32:53] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1924
    [order_id] => 88063
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:32:53] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:32:53] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1924
    [order_id] => 88063
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:32:53
)

[2025-10-11 03:32:53] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:32:53] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:32:53] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:32:53] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:32:53] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:32:53] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:32:53] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:32:53] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1924
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:32:53] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1924
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:32:53] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1924
[2025-10-11 03:32:53] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:32:53] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:32:53] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:32:53] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167973
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88063
    [user_id] => 1924
)

[2025-10-11 03:32:53] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:32:53] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:32:53] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:32:53] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1924
)

[2025-10-11 03:32:53] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1924
    [type] => Individual Membership
)

[2025-10-11 03:32:53] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1924
)

[2025-10-11 03:32:53] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:32:53] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88063
    [total] => 77.63
)

[2025-10-11 03:32:53] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:32:53] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:32:53] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:32:53] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:32:53] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1924
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:32:53] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:32:53] [debug] LGL Constituents: All data set for user 1924
[2025-10-11 03:32:54] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946807
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:32:53Z
            [updated_at] => 2025-10-11T07:32:53Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946807,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:32:53Z","updated_at":"2025-10-11T07:32:53Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:32:54] [debug] MembershipOrderHandler: User data updated 1924
[2025-10-11 03:32:54] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:32:54] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1924
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88063
)

[2025-10-11 03:32:54] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:32:54] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:32:54] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760167973
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88063
    [user_id] => 1924
)

[2025-10-11 03:32:54] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:32:54
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:32:54] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1924
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88063
)

[2025-10-11 03:32:54] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1924
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:32:54] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:32:54] [debug] Payment method set:  online
[2025-10-11 03:32:54] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:32:54] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:32:54] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:32:54] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:32:54] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:32:54] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:32:54] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:32:54] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:32:54] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:32:54] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:32:54] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:32:54] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:32:54] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:32:54] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:32:54] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1924
)

[2025-10-11 03:32:54] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1924
    [type] => Individual Membership
)

[2025-10-11 03:32:54] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1924
)

[2025-10-11 03:32:54] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:32:54] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88063
    [total] => 77.63
)

[2025-10-11 03:32:54] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:32:54] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:32:54] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:32:54] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:32:54] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1924
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:32:54] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:32:54] [debug] LGL Constituents: All data set for user 1924
[2025-10-11 03:32:55] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:32:54Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:32:54Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:32:55] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:32:55] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:32:55] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1924
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:32:55] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88063
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:32:55] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:32:55] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:32:55] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:32:55] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88063
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88063
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:32:56] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905202
)

[2025-10-11 03:32:56] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88063
    [amount] => 77.63
)

[2025-10-11 03:32:56] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905202
    [lgl_id] => 944817
    [order_id] => 88063
    [amount] => 77.63
)

[2025-10-11 03:32:56] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1924
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:32:56] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1924
    [success] => Registration call completed
)

[2025-10-11 03:32:56] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1924
    [lgl_api_called] => YES
)

[2025-10-11 03:32:56] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:32:56] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88063
    [user_id] => 1924
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:32:56] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:32:56] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:32:56] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88063
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:34:27] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88064
    [timestamp] => 2025-10-11 03:34:27
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:34:27] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88064
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1925
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:34:27
    [item_count] => 0
)

[2025-10-11 03:34:27] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1925
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:34:27] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1925
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:34:27] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:34:27] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:34:27] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1925
    [order_id] => 88064
)

[2025-10-11 03:34:27] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:34:27] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88064
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:34:27] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:34:27] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88064
    [product_id] => 67487
)

[2025-10-11 03:34:27] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:34:28] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88064
    [timestamp] => 2025-10-11 03:34:28
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:34:28] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88064
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1925
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:34:27
    [item_count] => 1
)

[2025-10-11 03:34:28] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1925
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:34:28] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1925
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:34:28] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:34:28] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:34:28] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1925
    [order_id] => 88064
)

[2025-10-11 03:34:28] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:34:28] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:34:28] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:34:28] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1925
    [order_id] => 88064
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:34:28] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:34:28] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1925
    [order_id] => 88064
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:34:28
)

[2025-10-11 03:34:28] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:34:28] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:34:28] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:34:28] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:34:28] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:34:28] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:34:28] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:34:28] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1925
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:34:28] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1925
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:34:28] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1925
[2025-10-11 03:34:28] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:34:28] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:34:28] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:34:28] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168067
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88064
    [user_id] => 1925
)

[2025-10-11 03:34:28] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:34:28] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:34:28] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:34:28] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1925
)

[2025-10-11 03:34:28] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1925
    [type] => Individual Membership
)

[2025-10-11 03:34:28] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1925
)

[2025-10-11 03:34:28] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:34:28] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88064
    [total] => 77.63
)

[2025-10-11 03:34:28] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:34:28] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:34:28] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:34:28] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:34:28] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1925
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:34:28] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:34:28] [debug] LGL Constituents: All data set for user 1925
[2025-10-11 03:34:28] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946812
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:34:28Z
            [updated_at] => 2025-10-11T07:34:28Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946812,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:34:28Z","updated_at":"2025-10-11T07:34:28Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:34:28] [debug] MembershipOrderHandler: User data updated 1925
[2025-10-11 03:34:28] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:34:28] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1925
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88064
)

[2025-10-11 03:34:28] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:34:28] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:34:28] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168067
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88064
    [user_id] => 1925
)

[2025-10-11 03:34:28] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:34:28
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:34:28] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1925
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88064
)

[2025-10-11 03:34:28] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1925
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:34:28] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:34:28] [debug] Payment method set:  online
[2025-10-11 03:34:28] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:34:28] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:34:28] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:34:28] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:34:29] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:34:29] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:34:29] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:34:29] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:34:29] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:34:29] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:34:29] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:34:29] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:34:29] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:34:29] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:34:29] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1925
)

[2025-10-11 03:34:29] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1925
    [type] => Individual Membership
)

[2025-10-11 03:34:29] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1925
)

[2025-10-11 03:34:29] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:34:29] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88064
    [total] => 77.63
)

[2025-10-11 03:34:29] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:34:29] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:34:29] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:34:29] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:34:29] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1925
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:34:29] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:34:29] [debug] LGL Constituents: All data set for user 1925
[2025-10-11 03:34:29] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:34:29Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:34:29Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:34:30] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:34:30] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:34:30] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1925
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:34:30] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88064
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:34:30] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:34:30] [debug] ðŸ” LGL Payments: No cache, making API requests...
[2025-10-11 03:34:30] [debug] LGL Payments: Payment types retrieved Array
(
    [method] => Memberships
    [count] => 7
)

[2025-10-11 03:34:30] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:34:30] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88064
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88064
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:34:31] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905207
)

[2025-10-11 03:34:31] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88064
    [amount] => 77.63
)

[2025-10-11 03:34:31] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905207
    [lgl_id] => 944817
    [order_id] => 88064
    [amount] => 77.63
)

[2025-10-11 03:34:31] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1925
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:34:31] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1925
    [success] => Registration call completed
)

[2025-10-11 03:34:31] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1925
    [lgl_api_called] => YES
)

[2025-10-11 03:34:31] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:34:31] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88064
    [user_id] => 1925
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:34:31] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:34:31] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:34:31] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88064
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:34:43] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88065
    [timestamp] => 2025-10-11 03:34:43
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:34:43] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88065
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1926
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:34:43
    [item_count] => 0
)

[2025-10-11 03:34:43] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1926
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:34:43] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1926
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:34:43] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:34:43] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:34:43] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1926
    [order_id] => 88065
)

[2025-10-11 03:34:43] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:34:43] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88065
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:34:44] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:34:44] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88065
    [product_id] => 67487
)

[2025-10-11 03:34:44] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:34:44] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88065
    [timestamp] => 2025-10-11 03:34:44
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:34:44] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88065
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1926
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:34:43
    [item_count] => 1
)

[2025-10-11 03:34:44] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1926
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:34:44] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1926
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:34:44] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:34:44] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:34:44] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1926
    [order_id] => 88065
)

[2025-10-11 03:34:44] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:34:44] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:34:44] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:34:44] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1926
    [order_id] => 88065
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:34:44] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:34:44] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1926
    [order_id] => 88065
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:34:44
)

[2025-10-11 03:34:44] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:34:44] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:34:44] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:34:44] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:34:44] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:34:44] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:34:44] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:34:44] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1926
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:34:44] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1926
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:34:44] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1926
[2025-10-11 03:34:44] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:34:44] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:34:44] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:34:44] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168083
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88065
    [user_id] => 1926
)

[2025-10-11 03:34:44] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:34:44] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:34:44] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:34:44] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1926
)

[2025-10-11 03:34:44] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1926
    [type] => Individual Membership
)

[2025-10-11 03:34:44] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1926
)

[2025-10-11 03:34:44] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:34:44] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88065
    [total] => 77.63
)

[2025-10-11 03:34:44] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:34:44] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:34:44] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:34:44] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:34:44] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1926
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:34:44] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:34:44] [debug] LGL Constituents: All data set for user 1926
[2025-10-11 03:34:44] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946817
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:34:44Z
            [updated_at] => 2025-10-11T07:34:44Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946817,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:34:44Z","updated_at":"2025-10-11T07:34:44Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:34:44] [debug] MembershipOrderHandler: User data updated 1926
[2025-10-11 03:34:44] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:34:44] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1926
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88065
)

[2025-10-11 03:34:44] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:34:44] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:34:44] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168083
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88065
    [user_id] => 1926
)

[2025-10-11 03:34:44] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:34:44
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:34:44] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1926
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88065
)

[2025-10-11 03:34:44] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1926
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:34:44] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:34:44] [debug] Payment method set:  online
[2025-10-11 03:34:44] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:34:44] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:34:44] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:34:44] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:34:45] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:34:45] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:34:45] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:34:45] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:34:45] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:34:45] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:34:45] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:34:45] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:34:45] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:34:45] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:34:45] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1926
)

[2025-10-11 03:34:45] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1926
    [type] => Individual Membership
)

[2025-10-11 03:34:45] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1926
)

[2025-10-11 03:34:45] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:34:45] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88065
    [total] => 77.63
)

[2025-10-11 03:34:45] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:34:45] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:34:45] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:34:45] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:34:45] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1926
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:34:45] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:34:45] [debug] LGL Constituents: All data set for user 1926
[2025-10-11 03:34:45] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:34:45Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:34:45Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:34:46] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:34:46] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:34:46] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1926
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:34:46] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88065
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:34:46] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:34:46] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:34:46] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:34:46] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88065
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88065
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:34:47] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905212
)

[2025-10-11 03:34:47] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88065
    [amount] => 77.63
)

[2025-10-11 03:34:47] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905212
    [lgl_id] => 944817
    [order_id] => 88065
    [amount] => 77.63
)

[2025-10-11 03:34:47] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1926
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:34:47] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1926
    [success] => Registration call completed
)

[2025-10-11 03:34:47] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1926
    [lgl_api_called] => YES
)

[2025-10-11 03:34:47] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:34:47] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88065
    [user_id] => 1926
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:34:47] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:34:47] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:34:47] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88065
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:35:08] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88066
    [timestamp] => 2025-10-11 03:35:08
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:35:08] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88066
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1927
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:35:08
    [item_count] => 0
)

[2025-10-11 03:35:08] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1927
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:35:08] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1927
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:35:08] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:35:08] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:35:08] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1927
    [order_id] => 88066
)

[2025-10-11 03:35:08] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:35:08] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88066
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:35:08] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:35:08] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88066
    [product_id] => 67487
)

[2025-10-11 03:35:09] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:35:09] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88066
    [timestamp] => 2025-10-11 03:35:09
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:35:09] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88066
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1927
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:35:08
    [item_count] => 1
)

[2025-10-11 03:35:09] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1927
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:35:09] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1927
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:35:09] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:35:09] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:35:09] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1927
    [order_id] => 88066
)

[2025-10-11 03:35:09] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:35:09] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:35:09] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:35:09] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1927
    [order_id] => 88066
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:35:09] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:35:09] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1927
    [order_id] => 88066
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:35:09
)

[2025-10-11 03:35:09] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:35:09] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:35:09] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:35:09] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:35:09] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:35:09] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:35:09] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:35:09] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1927
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:35:09] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1927
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:35:09] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1927
[2025-10-11 03:35:09] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:35:09] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:35:09] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:35:09] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168108
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88066
    [user_id] => 1927
)

[2025-10-11 03:35:09] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:35:09] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:35:09] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:35:09] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1927
)

[2025-10-11 03:35:09] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1927
    [type] => Individual Membership
)

[2025-10-11 03:35:09] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1927
)

[2025-10-11 03:35:09] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:35:09] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88066
    [total] => 77.63
)

[2025-10-11 03:35:09] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:35:09] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:35:09] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:35:09] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:35:09] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1927
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:35:09] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:35:09] [debug] LGL Constituents: All data set for user 1927
[2025-10-11 03:35:10] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946822
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:35:09Z
            [updated_at] => 2025-10-11T07:35:09Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946822,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:35:09Z","updated_at":"2025-10-11T07:35:09Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:35:10] [debug] MembershipOrderHandler: User data updated 1927
[2025-10-11 03:35:10] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:35:10] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1927
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88066
)

[2025-10-11 03:35:10] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:35:10] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:35:10] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168108
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88066
    [user_id] => 1927
)

[2025-10-11 03:35:10] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:35:10
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:35:10] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1927
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88066
)

[2025-10-11 03:35:10] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1927
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:35:10] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:35:10] [debug] Payment method set:  online
[2025-10-11 03:35:10] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:35:10] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:35:10] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:35:10] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:35:10] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:35:10] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:35:10] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:35:10] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:35:10] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:35:10] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:35:10] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:35:10] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:35:10] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:35:10] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:35:10] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1927
)

[2025-10-11 03:35:10] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1927
    [type] => Individual Membership
)

[2025-10-11 03:35:10] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1927
)

[2025-10-11 03:35:10] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:35:10] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88066
    [total] => 77.63
)

[2025-10-11 03:35:10] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:35:10] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:35:10] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:35:10] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:35:10] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1927
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:35:10] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:35:10] [debug] LGL Constituents: All data set for user 1927
[2025-10-11 03:35:11] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:35:11Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:35:11Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:35:11] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:35:11] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:35:11] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1927
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:35:11] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88066
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:35:11] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:35:11] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:35:11] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:35:11] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88066
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88066
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:35:12] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905217
)

[2025-10-11 03:35:12] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88066
    [amount] => 77.63
)

[2025-10-11 03:35:12] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905217
    [lgl_id] => 944817
    [order_id] => 88066
    [amount] => 77.63
)

[2025-10-11 03:35:12] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1927
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:35:12] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1927
    [success] => Registration call completed
)

[2025-10-11 03:35:12] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1927
    [lgl_api_called] => YES
)

[2025-10-11 03:35:12] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:35:12] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88066
    [user_id] => 1927
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:35:12] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:35:12] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:35:12] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88066
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:35:34] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88067
    [timestamp] => 2025-10-11 03:35:34
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:35:34] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88067
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1928
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:35:34
    [item_count] => 0
)

[2025-10-11 03:35:34] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1928
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:35:34] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1928
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:35:34] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:35:34] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:35:34] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1928
    [order_id] => 88067
)

[2025-10-11 03:35:34] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:35:34] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88067
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:35:34] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:35:34] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88067
    [product_id] => 67487
)

[2025-10-11 03:35:34] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:35:35] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88067
    [timestamp] => 2025-10-11 03:35:35
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:35:35] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88067
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1928
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:35:34
    [item_count] => 1
)

[2025-10-11 03:35:35] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1928
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:35:35] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1928
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:35:35] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:35:35] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:35:35] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1928
    [order_id] => 88067
)

[2025-10-11 03:35:35] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:35:35] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:35:35] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:35:35] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1928
    [order_id] => 88067
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:35:35] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:35:35] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1928
    [order_id] => 88067
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:35:35
)

[2025-10-11 03:35:35] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:35:35] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:35:35] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:35:35] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:35:35] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:35:35] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:35:35] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:35:35] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1928
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:35:35] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1928
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:35:35] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1928
[2025-10-11 03:35:35] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:35:35] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:35:35] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:35:35] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168134
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88067
    [user_id] => 1928
)

[2025-10-11 03:35:35] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:35:35] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:35:35] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:35:35] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1928
)

[2025-10-11 03:35:35] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1928
    [type] => Individual Membership
)

[2025-10-11 03:35:35] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1928
)

[2025-10-11 03:35:35] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:35:35] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88067
    [total] => 77.63
)

[2025-10-11 03:35:35] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:35:35] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:35:35] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:35:35] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:35:35] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1928
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:35:35] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:35:35] [debug] LGL Constituents: All data set for user 1928
[2025-10-11 03:35:35] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946827
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:35:35Z
            [updated_at] => 2025-10-11T07:35:35Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946827,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:35:35Z","updated_at":"2025-10-11T07:35:35Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:35:35] [debug] MembershipOrderHandler: User data updated 1928
[2025-10-11 03:35:35] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:35:35] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1928
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88067
)

[2025-10-11 03:35:35] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:35:35] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:35:35] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168134
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88067
    [user_id] => 1928
)

[2025-10-11 03:35:35] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:35:35
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:35:35] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1928
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88067
)

[2025-10-11 03:35:35] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1928
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:35:35] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:35:35] [debug] Payment method set:  online
[2025-10-11 03:35:35] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:35:35] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:35:35] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:35:35] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:35:36] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:35:36] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:35:36] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:35:36] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:35:36] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:35:36] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:35:36] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:35:36] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:35:36] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:35:36] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:35:36] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1928
)

[2025-10-11 03:35:36] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1928
    [type] => Individual Membership
)

[2025-10-11 03:35:36] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1928
)

[2025-10-11 03:35:36] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:35:36] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88067
    [total] => 77.63
)

[2025-10-11 03:35:36] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:35:36] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:35:36] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:35:36] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:35:36] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1928
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:35:36] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:35:36] [debug] LGL Constituents: All data set for user 1928
[2025-10-11 03:35:36] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:35:36Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:35:36Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:35:37] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:35:37] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:35:37] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1928
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:35:37] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88067
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:35:37] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:35:37] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:35:37] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:35:37] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88067
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88067
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:35:37] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905222
)

[2025-10-11 03:35:37] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88067
    [amount] => 77.63
)

[2025-10-11 03:35:37] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905222
    [lgl_id] => 944817
    [order_id] => 88067
    [amount] => 77.63
)

[2025-10-11 03:35:37] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1928
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:35:37] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1928
    [success] => Registration call completed
)

[2025-10-11 03:35:37] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1928
    [lgl_api_called] => YES
)

[2025-10-11 03:35:37] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:35:37] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88067
    [user_id] => 1928
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:35:37] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:35:37] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:35:37] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88067
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:36:18] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88068
    [timestamp] => 2025-10-11 03:36:18
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:36:18] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88068
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1929
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:36:18
    [item_count] => 0
)

[2025-10-11 03:36:18] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1929
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:36:18] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1929
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:36:18] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:36:18] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:36:18] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1929
    [order_id] => 88068
)

[2025-10-11 03:36:18] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:36:18] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88068
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:36:18] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:36:18] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88068
    [product_id] => 67487
)

[2025-10-11 03:36:18] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:36:19] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88068
    [timestamp] => 2025-10-11 03:36:19
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:36:19] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88068
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1929
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:36:18
    [item_count] => 1
)

[2025-10-11 03:36:19] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1929
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:36:19] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1929
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:36:19] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:36:19] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:36:19] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1929
    [order_id] => 88068
)

[2025-10-11 03:36:19] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:36:19] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:36:19] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:36:19] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1929
    [order_id] => 88068
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:36:19] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:36:19] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1929
    [order_id] => 88068
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:36:19
)

[2025-10-11 03:36:19] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:36:19] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:36:19] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:36:19] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:36:19] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:36:19] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:36:19] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:36:19] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1929
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:36:19] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1929
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:36:19] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1929
[2025-10-11 03:36:19] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:36:19] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:36:19] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:36:19] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168178
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88068
    [user_id] => 1929
)

[2025-10-11 03:36:19] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:36:19] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:36:19] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:36:19] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1929
)

[2025-10-11 03:36:19] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1929
    [type] => Individual Membership
)

[2025-10-11 03:36:19] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1929
)

[2025-10-11 03:36:19] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:36:19] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88068
    [total] => 77.63
)

[2025-10-11 03:36:19] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:36:19] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:36:19] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:36:19] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:36:19] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1929
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:36:19] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:36:19] [debug] LGL Constituents: All data set for user 1929
[2025-10-11 03:36:19] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946832
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:36:19Z
            [updated_at] => 2025-10-11T07:36:19Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946832,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:36:19Z","updated_at":"2025-10-11T07:36:19Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:36:19] [debug] MembershipOrderHandler: User data updated 1929
[2025-10-11 03:36:19] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:36:19] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1929
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88068
)

[2025-10-11 03:36:19] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:36:19] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:36:19] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168178
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88068
    [user_id] => 1929
)

[2025-10-11 03:36:19] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:36:19
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:36:19] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1929
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88068
)

[2025-10-11 03:36:19] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1929
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:36:19] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:36:19] [debug] Payment method set:  online
[2025-10-11 03:36:19] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:36:19] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:36:19] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:36:19] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:36:20] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:36:20] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:36:20] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:36:20] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:36:20] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:36:20] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:36:20] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:36:20] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:36:20] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:36:20] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:36:20] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1929
)

[2025-10-11 03:36:20] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1929
    [type] => Individual Membership
)

[2025-10-11 03:36:20] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1929
)

[2025-10-11 03:36:20] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:36:20] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88068
    [total] => 77.63
)

[2025-10-11 03:36:20] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 0
    [levels] => Array
        (
        )

)

[2025-10-11 03:36:20] [debug] LGL Constituents: âš ï¸ No membership levels configured in settings
[2025-10-11 03:36:20] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:36:20] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:36:20] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1929
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:36:20] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:36:20] [debug] LGL Constituents: All data set for user 1929
[2025-10-11 03:36:21] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:36:21Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:36:21Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:36:21] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:36:21] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:36:21] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1929
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:36:21] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88068
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:36:21] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:36:21] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:36:21] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:36:21] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88068
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88068
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:36:22] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905227
)

[2025-10-11 03:36:22] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88068
    [amount] => 77.63
)

[2025-10-11 03:36:22] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905227
    [lgl_id] => 944817
    [order_id] => 88068
    [amount] => 77.63
)

[2025-10-11 03:36:22] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1929
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:36:22] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1929
    [success] => Registration call completed
)

[2025-10-11 03:36:22] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1929
    [lgl_api_called] => YES
)

[2025-10-11 03:36:22] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:36:22] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88068
    [user_id] => 1929
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:36:22] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:36:22] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:36:22] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88068
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:36:49] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88069
    [timestamp] => 2025-10-11 03:36:49
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:36:49] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88069
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1930
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:36:49
    [item_count] => 0
)

[2025-10-11 03:36:49] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1930
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:36:49] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1930
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:36:49] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:36:49] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:36:49] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1930
    [order_id] => 88069
)

[2025-10-11 03:36:49] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:36:49] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88069
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:36:49] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:36:49] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88069
    [product_id] => 67487
)

[2025-10-11 03:36:49] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:36:50] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88069
    [timestamp] => 2025-10-11 03:36:50
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:36:50] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88069
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1930
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:36:49
    [item_count] => 1
)

[2025-10-11 03:36:50] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1930
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:36:50] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1930
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:36:50] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:36:50] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:36:50] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1930
    [order_id] => 88069
)

[2025-10-11 03:36:50] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:36:50] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:36:50] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:36:50] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1930
    [order_id] => 88069
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:36:50] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:36:50] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1930
    [order_id] => 88069
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:36:50
)

[2025-10-11 03:36:50] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:36:50] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:36:50] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:36:50] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:36:50] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:36:50] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:36:50] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:36:50] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1930
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:36:50] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1930
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:36:50] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1930
[2025-10-11 03:36:50] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:36:50] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:36:50] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:36:50] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168209
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88069
    [user_id] => 1930
)

[2025-10-11 03:36:50] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:36:50] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:36:50] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:36:50] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1930
)

[2025-10-11 03:36:50] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1930
    [type] => Individual Membership
)

[2025-10-11 03:36:50] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1930
)

[2025-10-11 03:36:50] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:36:50] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88069
    [total] => 77.63
)

[2025-10-11 03:36:50] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:36:50] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:36:50] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:36:50] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:36:50] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1930
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:36:50] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:36:50] [debug] LGL Constituents: All data set for user 1930
[2025-10-11 03:36:50] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946837
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:36:50Z
            [updated_at] => 2025-10-11T07:36:50Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946837,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:36:50Z","updated_at":"2025-10-11T07:36:50Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:36:50] [debug] MembershipOrderHandler: User data updated 1930
[2025-10-11 03:36:50] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:36:50] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1930
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88069
)

[2025-10-11 03:36:50] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:36:50] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:36:50] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168209
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88069
    [user_id] => 1930
)

[2025-10-11 03:36:50] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:36:50
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:36:50] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1930
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88069
)

[2025-10-11 03:36:50] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1930
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:36:50] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:36:50] [debug] Payment method set:  online
[2025-10-11 03:36:50] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:36:50] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:36:50] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:36:50] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:36:51] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:36:51] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:36:51] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:36:51] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:36:51] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:36:51] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:36:51] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:36:51] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:36:51] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:36:51] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:36:51] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1930
)

[2025-10-11 03:36:51] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1930
    [type] => Individual Membership
)

[2025-10-11 03:36:51] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1930
)

[2025-10-11 03:36:51] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:36:51] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88069
    [total] => 77.63
)

[2025-10-11 03:36:51] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:36:51] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:36:51] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:36:51] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:36:51] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1930
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:36:51] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:36:51] [debug] LGL Constituents: All data set for user 1930
[2025-10-11 03:36:51] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:36:51Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:36:51Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:36:51] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:36:51] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:36:51] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1930
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:36:51] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88069
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:36:51] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:36:51] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:36:51] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:36:51] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88069
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88069
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:36:52] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905232
)

[2025-10-11 03:36:52] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88069
    [amount] => 77.63
)

[2025-10-11 03:36:52] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905232
    [lgl_id] => 944817
    [order_id] => 88069
    [amount] => 77.63
)

[2025-10-11 03:36:52] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1930
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:36:52] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1930
    [success] => Registration call completed
)

[2025-10-11 03:36:52] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1930
    [lgl_api_called] => YES
)

[2025-10-11 03:36:52] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:36:52] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88069
    [user_id] => 1930
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:36:52] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:36:52] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:36:52] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88069
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:37:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88070
    [timestamp] => 2025-10-11 03:37:13
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:37:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88070
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1931
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:37:13
    [item_count] => 0
)

[2025-10-11 03:37:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1931
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:37:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1931
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:37:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:37:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:37:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1931
    [order_id] => 88070
)

[2025-10-11 03:37:13] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:37:13] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88070
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:37:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:37:13] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88070
    [product_id] => 67487
)

[2025-10-11 03:37:13] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:37:13] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88070
    [timestamp] => 2025-10-11 03:37:13
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:37:13] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88070
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1931
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:37:13
    [item_count] => 1
)

[2025-10-11 03:37:13] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1931
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:37:13] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1931
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:37:13] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:37:13] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:37:13] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1931
    [order_id] => 88070
)

[2025-10-11 03:37:13] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:37:13] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:37:13] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:37:13] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1931
    [order_id] => 88070
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:37:13] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:37:13] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1931
    [order_id] => 88070
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:37:13
)

[2025-10-11 03:37:13] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:37:13] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:37:13] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:37:13] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:37:13] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:37:13] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:37:13] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:37:13] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1931
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:37:13] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1931
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:37:13] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1931
[2025-10-11 03:37:13] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:37:13] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:37:13] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:37:13] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168233
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88070
    [user_id] => 1931
)

[2025-10-11 03:37:13] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:37:13] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:37:13] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:37:13] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1931
)

[2025-10-11 03:37:13] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1931
    [type] => Individual Membership
)

[2025-10-11 03:37:13] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1931
)

[2025-10-11 03:37:13] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:37:13] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88070
    [total] => 77.63
)

[2025-10-11 03:37:13] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:37:13] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:37:13] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:37:13] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:37:13] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1931
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:37:13] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:37:13] [debug] LGL Constituents: All data set for user 1931
[2025-10-11 03:37:14] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946842
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:37:14Z
            [updated_at] => 2025-10-11T07:37:14Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946842,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:37:14Z","updated_at":"2025-10-11T07:37:14Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:37:14] [debug] MembershipOrderHandler: User data updated 1931
[2025-10-11 03:37:14] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:37:14] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1931
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88070
)

[2025-10-11 03:37:14] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:37:14] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:37:14] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168233
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88070
    [user_id] => 1931
)

[2025-10-11 03:37:14] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:37:14
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:37:14] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1931
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88070
)

[2025-10-11 03:37:14] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1931
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:37:14] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:37:14] [debug] Payment method set:  online
[2025-10-11 03:37:14] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:37:14] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:37:14] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:37:14] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:37:14] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:37:14] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:37:14] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:37:14] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:37:14] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:37:14] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:37:14] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:37:14] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:37:14] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:37:14] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:37:14] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1931
)

[2025-10-11 03:37:14] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1931
    [type] => Individual Membership
)

[2025-10-11 03:37:14] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1931
)

[2025-10-11 03:37:14] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:37:14] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88070
    [total] => 77.63
)

[2025-10-11 03:37:14] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:37:14] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:37:14] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:37:14] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:37:14] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1931
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:37:14] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:37:14] [debug] LGL Constituents: All data set for user 1931
[2025-10-11 03:37:15] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:37:15Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:37:15Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:37:15] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:37:15] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:37:15] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1931
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:37:15] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88070
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:37:15] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:37:15] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:37:15] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:37:15] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88070
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88070
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:37:16] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905237
)

[2025-10-11 03:37:16] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88070
    [amount] => 77.63
)

[2025-10-11 03:37:16] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905237
    [lgl_id] => 944817
    [order_id] => 88070
    [amount] => 77.63
)

[2025-10-11 03:37:16] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1931
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:37:16] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1931
    [success] => Registration call completed
)

[2025-10-11 03:37:16] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1931
    [lgl_api_called] => YES
)

[2025-10-11 03:37:16] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:37:16] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88070
    [user_id] => 1931
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:37:16] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:37:16] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:37:16] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88070
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:37:31] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88071
    [timestamp] => 2025-10-11 03:37:31
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:37:31] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88071
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1932
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:37:31
    [item_count] => 0
)

[2025-10-11 03:37:31] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1932
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:37:31] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1932
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:37:31] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:37:31] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:37:31] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1932
    [order_id] => 88071
)

[2025-10-11 03:37:31] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:37:31] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88071
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:37:31] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:37:31] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88071
    [product_id] => 67487
)

[2025-10-11 03:37:31] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:37:31] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88071
    [timestamp] => 2025-10-11 03:37:31
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:37:31] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88071
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1932
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:37:31
    [item_count] => 1
)

[2025-10-11 03:37:31] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1932
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:37:31] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1932
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:37:31] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:37:31] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:37:31] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1932
    [order_id] => 88071
)

[2025-10-11 03:37:31] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:37:31] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:37:31] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:37:31] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1932
    [order_id] => 88071
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:37:31] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:37:31] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1932
    [order_id] => 88071
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:37:31
)

[2025-10-11 03:37:31] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:37:31] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:37:31] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:37:31] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:37:31] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:37:31] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:37:31] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:37:31] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1932
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:37:31] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1932
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:37:31] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1932
[2025-10-11 03:37:31] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:37:31] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:37:31] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:37:31] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168251
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88071
    [user_id] => 1932
)

[2025-10-11 03:37:31] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:37:31] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:37:31] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:37:31] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1932
)

[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1932
    [type] => Individual Membership
)

[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1932
)

[2025-10-11 03:37:32] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88071
    [total] => 77.63
)

[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:37:32] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:37:32] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:37:32] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1932
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:37:32] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:37:32] [debug] LGL Constituents: All data set for user 1932
[2025-10-11 03:37:32] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946847
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:37:32Z
            [updated_at] => 2025-10-11T07:37:32Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946847,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:37:32Z","updated_at":"2025-10-11T07:37:32Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:37:32] [debug] MembershipOrderHandler: User data updated 1932
[2025-10-11 03:37:32] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:37:32] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1932
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88071
)

[2025-10-11 03:37:32] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:37:32] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:37:32] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168251
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88071
    [user_id] => 1932
)

[2025-10-11 03:37:32] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:37:32
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:37:32] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1932
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88071
)

[2025-10-11 03:37:32] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1932
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:37:32] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:37:32] [debug] Payment method set:  online
[2025-10-11 03:37:32] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:37:32] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:37:32] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:37:32] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:37:32] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:37:32] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:37:32] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:37:32] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:37:32] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:37:32] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:37:32] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:37:32] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:37:32] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:37:32] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1932
)

[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1932
    [type] => Individual Membership
)

[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1932
)

[2025-10-11 03:37:32] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88071
    [total] => 77.63
)

[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:37:32] [debug] LGL Constituents: âŒ No membership level found matching price Array
(
    [order_total] => 77.63
    [available_levels] => Array
        (
            [0] => Array
                (
                    [name] => Indvidual
                    [price] => 75
                )

            [1] => Array
                (
                    [name] => Family
                    [price] => 125
                )

            [2] => Array
                (
                    [name] => Patron
                    [price] => 200
                )

            [3] => Array
                (
                    [name] => Patron Family
                    [price] => 250
                )

        )

)

[2025-10-11 03:37:32] [debug] LGL Constituents: ðŸ“‹ Final level config
[2025-10-11 03:37:32] [debug] LGL Constituents: âŒ No membership_level_id found! This will cause LGL API to fail.
[2025-10-11 03:37:32] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1932
    [membership_type] => Individual Membership
    [level_config] => 
    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 
            [membership_level_name] => Individual Membership
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:37:32] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 
    [membership_level_name] => Individual Membership
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:37:32] [debug] LGL Constituents: All data set for user 1932
[2025-10-11 03:37:33] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:37:33Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:37:33Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:37:33] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:37:33] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:37:33] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1932
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:37:33] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88071
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:37:33] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:37:33] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:37:33] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:37:34] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88071
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88071
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:37:34] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905242
)

[2025-10-11 03:37:34] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88071
    [amount] => 77.63
)

[2025-10-11 03:37:34] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905242
    [lgl_id] => 944817
    [order_id] => 88071
    [amount] => 77.63
)

[2025-10-11 03:37:34] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1932
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:37:34] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1932
    [success] => Registration call completed
)

[2025-10-11 03:37:34] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1932
    [lgl_api_called] => YES
)

[2025-10-11 03:37:34] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:37:34] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88071
    [user_id] => 1932
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:37:34] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:37:34] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:37:34] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88071
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:37:59] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88072
    [timestamp] => 2025-10-11 03:37:59
    [memory_usage] => 150.8125MB
)

[2025-10-11 03:37:59] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88072
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1933
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:37:59
    [item_count] => 0
)

[2025-10-11 03:37:59] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1933
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:37:59] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1933
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:37:59] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:37:59] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:37:59] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1933
    [order_id] => 88072
)

[2025-10-11 03:37:59] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:37:59] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88072
    [final_memory_usage] => 150.8125MB
)

[2025-10-11 03:37:59] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:37:59] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88072
    [product_id] => 67487
)

[2025-10-11 03:37:59] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:37:59] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88072
    [timestamp] => 2025-10-11 03:37:59
    [memory_usage] => 154.8125MB
)

[2025-10-11 03:37:59] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88072
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1933
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:37:59
    [item_count] => 1
)

[2025-10-11 03:37:59] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1933
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:37:59] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1933
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:37:59] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:37:59] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:37:59] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1933
    [order_id] => 88072
)

[2025-10-11 03:37:59] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:37:59] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:37:59] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:37:59] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1933
    [order_id] => 88072
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:37:59] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:37:59] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1933
    [order_id] => 88072
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:37:59
)

[2025-10-11 03:37:59] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:37:59] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:37:59] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:37:59] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:37:59] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:37:59] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:37:59] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:37:59] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1933
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:37:59] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1933
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:37:59] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1933
[2025-10-11 03:37:59] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:37:59] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:37:59] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:37:59] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168279
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88072
    [user_id] => 1933
)

[2025-10-11 03:37:59] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:37:59] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:37:59] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:38:00] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1933
)

[2025-10-11 03:38:00] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1933
    [type] => Individual Membership
)

[2025-10-11 03:38:00] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1933
)

[2025-10-11 03:38:00] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:38:00] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88072
    [total] => 77.63
)

[2025-10-11 03:38:00] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:38:00] [debug] LGL Constituents: ðŸ” Checking price match Array
(
    [level_name] => Indvidual
    [level_price] => 75
    [order_total] => 77.63
    [difference] => 2.63
    [tolerance] => 7.5
    [matches] => 1
)

[2025-10-11 03:38:00] [debug] LGL Constituents: âœ… Found matching membership level by price Array
(
    [level] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [order_total] => 77.63
    [level_price] => 75
    [difference] => 2.63
)

[2025-10-11 03:38:00] [debug] LGL Constituents: ðŸ“‹ Final level config Array
(
    [level_name] => Indvidual
    [level_slug] => individual
    [lgl_membership_level_id] => 412
    [price] => 75
)

[2025-10-11 03:38:00] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1933
    [membership_type] => Individual Membership
    [level_config] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 412
            [membership_level_name] => Indvidual
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:38:00] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 412
    [membership_level_name] => Indvidual
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:38:00] [debug] LGL Constituents: All data set for user 1933
[2025-10-11 03:38:00] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946852
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:38:00Z
            [updated_at] => 2025-10-11T07:38:00Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946852,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:38:00Z","updated_at":"2025-10-11T07:38:00Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:38:00] [debug] MembershipOrderHandler: User data updated 1933
[2025-10-11 03:38:00] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:38:00] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1933
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88072
)

[2025-10-11 03:38:00] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:38:00] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:38:00] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168279
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88072
    [user_id] => 1933
)

[2025-10-11 03:38:00] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:38:00
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:38:00] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1933
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88072
)

[2025-10-11 03:38:00] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1933
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:38:00] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:38:00] [debug] Payment method set:  online
[2025-10-11 03:38:00] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:38:00] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:38:00] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:38:00] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:38:01] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:38:01] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:38:01] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:38:01] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:38:01] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:38:01] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:38:01] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:38:01] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:38:01] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:38:01] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:38:01] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1933
)

[2025-10-11 03:38:01] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1933
    [type] => Individual Membership
)

[2025-10-11 03:38:01] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1933
)

[2025-10-11 03:38:01] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:38:01] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88072
    [total] => 77.63
)

[2025-10-11 03:38:01] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:38:01] [debug] LGL Constituents: ðŸ” Checking price match Array
(
    [level_name] => Indvidual
    [level_price] => 75
    [order_total] => 77.63
    [difference] => 2.63
    [tolerance] => 7.5
    [matches] => 1
)

[2025-10-11 03:38:01] [debug] LGL Constituents: âœ… Found matching membership level by price Array
(
    [level] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [order_total] => 77.63
    [level_price] => 75
    [difference] => 2.63
)

[2025-10-11 03:38:01] [debug] LGL Constituents: ðŸ“‹ Final level config Array
(
    [level_name] => Indvidual
    [level_slug] => individual
    [lgl_membership_level_id] => 412
    [price] => 75
)

[2025-10-11 03:38:01] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1933
    [membership_type] => Individual Membership
    [level_config] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 412
            [membership_level_name] => Indvidual
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:38:01] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 412
    [membership_level_name] => Indvidual
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:38:01] [debug] LGL Constituents: All data set for user 1933
[2025-10-11 03:38:01] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:38:01Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:38:01Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:38:02] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:38:02] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:38:02] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1933
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:38:02] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88072
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:38:02] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:38:02] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:38:02] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:38:02] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88072
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88072
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:38:02] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905247
)

[2025-10-11 03:38:02] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88072
    [amount] => 77.63
)

[2025-10-11 03:38:02] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905247
    [lgl_id] => 944817
    [order_id] => 88072
    [amount] => 77.63
)

[2025-10-11 03:38:02] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1933
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:38:02] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1933
    [success] => Registration call completed
)

[2025-10-11 03:38:02] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1933
    [lgl_api_called] => YES
)

[2025-10-11 03:38:02] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:38:02] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88072
    [user_id] => 1933
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:38:02] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:38:02] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:38:02] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88072
    [final_memory_usage] => 154.8125MB
)

[2025-10-11 03:38:50] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:38:51] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88073
    [timestamp] => 2025-10-11 03:38:51
    [memory_usage] => 124MB
)

[2025-10-11 03:38:51] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88073
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1934
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:38:51
    [item_count] => 0
)

[2025-10-11 03:38:51] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1934
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:38:51] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1934
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:38:51] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:38:51] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:38:51] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1934
    [order_id] => 88073
)

[2025-10-11 03:38:51] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:38:51] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88073
    [final_memory_usage] => 124MB
)

[2025-10-11 03:38:51] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:38:51] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88073
    [product_id] => 67487
)

[2025-10-11 03:38:51] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:38:51] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88073
    [timestamp] => 2025-10-11 03:38:51
    [memory_usage] => 128MB
)

[2025-10-11 03:38:51] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88073
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1934
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:38:51
    [item_count] => 1
)

[2025-10-11 03:38:51] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1934
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:38:51] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1934
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:38:51] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:38:51] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:38:51] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1934
    [order_id] => 88073
)

[2025-10-11 03:38:51] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:38:51] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:38:51] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:38:51] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1934
    [order_id] => 88073
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:38:51] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:38:51] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1934
    [order_id] => 88073
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:38:51
)

[2025-10-11 03:38:51] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:38:51] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:38:51] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:38:51] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:38:51] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:38:51] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:38:51] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:38:51] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1934
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:38:51] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1934
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:38:51] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1934
[2025-10-11 03:38:51] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:38:51] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:38:51] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:38:51] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168331
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88073
    [user_id] => 1934
)

[2025-10-11 03:38:51] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:38:51] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:38:51] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:38:51] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1934
)

[2025-10-11 03:38:51] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1934
    [type] => Individual Membership
)

[2025-10-11 03:38:51] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1934
)

[2025-10-11 03:38:51] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:38:51] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88073
    [total] => 77.63
)

[2025-10-11 03:38:51] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:38:51] [debug] LGL Constituents: ðŸ” Checking price match Array
(
    [level_name] => Indvidual
    [level_price] => 75
    [order_total] => 77.63
    [difference] => 2.63
    [tolerance] => 7.5
    [matches] => 1
)

[2025-10-11 03:38:51] [debug] LGL Constituents: âœ… Found matching membership level by price Array
(
    [level] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [order_total] => 77.63
    [level_price] => 75
    [difference] => 2.63
)

[2025-10-11 03:38:51] [debug] LGL Constituents: ðŸ“‹ Final level config Array
(
    [level_name] => Indvidual
    [level_slug] => individual
    [lgl_membership_level_id] => 412
    [price] => 75
)

[2025-10-11 03:38:51] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1934
    [membership_type] => Individual Membership
    [level_config] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 412
            [membership_level_name] => Indvidual
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:38:51] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 412
    [membership_level_name] => Indvidual
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:38:51] [debug] LGL Constituents: All data set for user 1934
[2025-10-11 03:38:51] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946857
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:38:51Z
            [updated_at] => 2025-10-11T07:38:51Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946857,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:38:51Z","updated_at":"2025-10-11T07:38:51Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:38:51] [debug] MembershipOrderHandler: User data updated 1934
[2025-10-11 03:38:51] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:38:51] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1934
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88073
)

[2025-10-11 03:38:51] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:38:51] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:38:51] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168331
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88073
    [user_id] => 1934
)

[2025-10-11 03:38:51] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:38:51
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:38:51] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1934
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88073
)

[2025-10-11 03:38:51] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1934
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:38:51] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:38:51] [debug] Payment method set:  online
[2025-10-11 03:38:51] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:38:51] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:38:51] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:38:51] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:38:52] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:38:52] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:38:52] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:38:52] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:38:52] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:38:52] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:38:52] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:38:52] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:38:52] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:38:52] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:38:52] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1934
)

[2025-10-11 03:38:52] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1934
    [type] => Individual Membership
)

[2025-10-11 03:38:52] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1934
)

[2025-10-11 03:38:52] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:38:52] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88073
    [total] => 77.63
)

[2025-10-11 03:38:52] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:38:52] [debug] LGL Constituents: ðŸ” Checking price match Array
(
    [level_name] => Indvidual
    [level_price] => 75
    [order_total] => 77.63
    [difference] => 2.63
    [tolerance] => 7.5
    [matches] => 1
)

[2025-10-11 03:38:52] [debug] LGL Constituents: âœ… Found matching membership level by price Array
(
    [level] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [order_total] => 77.63
    [level_price] => 75
    [difference] => 2.63
)

[2025-10-11 03:38:52] [debug] LGL Constituents: ðŸ“‹ Final level config Array
(
    [level_name] => Indvidual
    [level_slug] => individual
    [lgl_membership_level_id] => 412
    [price] => 75
)

[2025-10-11 03:38:52] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1934
    [membership_type] => Individual Membership
    [level_config] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 412
            [membership_level_name] => Indvidual
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:38:52] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 412
    [membership_level_name] => Indvidual
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:38:52] [debug] LGL Constituents: All data set for user 1934
[2025-10-11 03:38:52] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:38:52Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:38:52Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:38:53] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:38:53] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:38:53] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1934
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:38:53] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88073
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:38:53] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:38:53] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:38:53] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:38:53] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88073
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88073
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:38:54] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905252
)

[2025-10-11 03:38:54] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88073
    [amount] => 77.63
)

[2025-10-11 03:38:54] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905252
    [lgl_id] => 944817
    [order_id] => 88073
    [amount] => 77.63
)

[2025-10-11 03:38:54] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1934
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:38:54] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1934
    [success] => Registration call completed
)

[2025-10-11 03:38:54] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1934
    [lgl_api_called] => YES
)

[2025-10-11 03:38:54] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:38:54] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88073
    [user_id] => 1934
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:38:54] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:38:54] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:38:54] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88073
    [final_memory_usage] => 130MB
)

[2025-10-11 03:39:01] [debug] Membership cron jobs scheduled successfully
[2025-10-11 03:39:01] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88074
    [timestamp] => 2025-10-11 03:39:01
    [memory_usage] => 124MB
)

[2025-10-11 03:39:01] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88074
    [order_status] => pending
    [order_total] => 0.00
    [customer_id] => 1935
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:39:01
    [item_count] => 0
)

[2025-10-11 03:39:01] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1935
    [billing_email] => debug.test@example.com
    [billing_first_name] => 
    [billing_last_name] => 
    [billing_phone] => 
)

[2025-10-11 03:39:01] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1935
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:39:01] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => 
    [country] => 
    [referral] => 
    [reason] => 
    [about] => 
)

[2025-10-11 03:39:01] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:39:01] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 0
    [user_id] => 1935
    [order_id] => 88074
)

[2025-10-11 03:39:01] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 0
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:39:01] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88074
    [final_memory_usage] => 124MB
)

[2025-10-11 03:39:01] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:39:01] [debug] OrderEmailCustomizer: Rendered email template Array
(
    [template] => membership-confirmation.html
    [order_id] => 88074
    [product_id] => 67487
)

[2025-10-11 03:39:02] [debug] OrderEmailCustomizer: Running email customizer
[2025-10-11 03:39:02] [debug] ðŸš€ OrderProcessor::processCompletedOrder() STARTED Array
(
    [order_id] => 88074
    [timestamp] => 2025-10-11 03:39:02
    [memory_usage] => 128MB
)

[2025-10-11 03:39:02] [debug] ðŸ“‹ OrderProcessor: Order Details Array
(
    [order_id] => 88074
    [order_status] => completed
    [order_total] => 77.63
    [customer_id] => 1935
    [customer_email] => debug.test@example.com
    [payment_method] => 
    [order_date] => 2025-10-11 03:39:01
    [item_count] => 1
)

[2025-10-11 03:39:02] [debug] ðŸ‘¤ OrderProcessor: Customer Info Array
(
    [user_id] => 1935
    [billing_email] => debug.test@example.com
    [billing_first_name] => Debug
    [billing_last_name] => Test
    [billing_phone] => 555-DEBUG
)

[2025-10-11 03:39:02] [debug] OrderProcessor: Payment method updated Array
(
    [user_id] => 1935
    [payment_method] => 
    [stored_as] => online
)

[2025-10-11 03:39:02] [debug] ðŸ“ OrderProcessor: Order Metadata Extracted Array
(
    [languages] => English, Spanish
    [country] => United States
    [referral] => 
    [reason] => Testing debug functionality
    [about] => 
)

[2025-10-11 03:39:02] [debug] ðŸ›ï¸ OrderProcessor: Starting product processing...
[2025-10-11 03:39:02] [debug] ðŸ›ï¸ OrderProcessor::processOrderProducts() STARTED Array
(
    [total_products] => 1
    [user_id] => 1935
    [order_id] => 88074
)

[2025-10-11 03:39:02] [debug] ðŸ” OrderProcessor: Processing Product #1 Array
(
    [name] => Membership - Individual
    [quantity] => 1
    [product_id] => 68386
    [parent_id] => 67487
    [categories] => Array
        (
            [0] => memberships
        )

    [item_total] => 75
    [item_subtotal] => 75
)

[2025-10-11 03:39:02] [debug] ðŸ·ï¸ OrderProcessor: Product Type Detection Array
(
    [product_name] => Membership - Individual
    [is_membership] => YES
    [is_language_class] => NO
    [is_event] => NO
    [categories] => Array
        (
            [0] => memberships
        )

)

[2025-10-11 03:39:02] [debug] ðŸŽ¯ OrderProcessor: ROUTING TO MEMBERSHIP HANDLER Array
(
    [product_name] => Membership - Individual
    [handler] => MembershipOrderHandler
)

[2025-10-11 03:39:02] [debug] ðŸŽ¯ OrderProcessor::processMembershipProduct() STARTED Array
(
    [user_id] => 1935
    [order_id] => 88074
    [product_name] => Membership - Individual
    [product_id] => 67487
    [handler_class] => UpstateInternational\LGL\WooCommerce\MembershipOrderHandler
    [handler_available] => YES
)

[2025-10-11 03:39:02] [debug] ðŸ”„ OrderProcessor: Delegating to MembershipOrderHandler...
[2025-10-11 03:39:02] [debug] ðŸŽ¯ MembershipOrderHandler::processOrder() STARTED Array
(
    [user_id] => 1935
    [order_id] => 88074
    [membership_level] => Membership - Individual
    [order_total] => 77.63
    [customer_email] => debug.test@example.com
    [timestamp] => 2025-10-11 03:39:02
)

[2025-10-11 03:39:02] [debug] ðŸ›ï¸ MembershipOrderHandler: Product Details Array
(
    [product_id] => 67487
    [variation_id] => 68386
    [product_name] => Membership - Individual
    [product_total] => 75
    [wc_name_passed] => Membership - Individual
    [product_meta_keys] => Array
        (
            [0] => _variation_description
            [1] => total_sales
            [2] => _tax_status
            [3] => _tax_class
            [4] => _manage_stock
            [5] => _backorders
            [6] => _sold_individually
            [7] => _virtual
            [8] => _downloadable
            [9] => _download_limit
            [10] => _download_expiry
            [11] => _stock
            [12] => _stock_status
            [13] => _wc_average_rating
            [14] => _wc_review_count
            [15] => attribute_level
            [16] => _product_version
            [17] => _regular_price
            [18] => _price
            [19] => _subscription_payment_sync_date
            [20] => _hf_subscription_prorate
            [21] => _hf_subscription_price
            [22] => _subscription_sign_up_fee
            [23] => _subscription_period
            [24] => _subscription_period_interval
            [25] => _subscription_length
            [26] => _subscription_trial_period
            [27] => _subscription_trial_length
            [28] => _thumbnail_id
            [29] => _subscription_price
            [30] => _ppcp_enable_subscription_product
            [31] => addf_vf_roles_select_roles
        )

)

[2025-10-11 03:39:02] [debug] ðŸ” MembershipOrderHandler: Determining membership level Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
)

[2025-10-11 03:39:02] [debug] ðŸ”„ Helper: Converting price to membership name Array
(
    [price] => 75
)

[2025-10-11 03:39:02] [debug] âœ… Helper: Price mapping found Array
(
    [price] => 75
    [membership_name] => Individual Membership
)

[2025-10-11 03:39:02] [debug] âœ… MembershipOrderHandler: Using price-based detection Array
(
    [price] => 75
    [membership_level] => Individual Membership
    [method] => price_based
)

[2025-10-11 03:39:02] [debug] ðŸŽ¯ MembershipOrderHandler: Membership Level Determination Array
(
    [wc_product_name] => Membership - Individual
    [product_price] => 75
    [determined_membership_level] => Individual Membership
    [method] => price_based_detection
)

[2025-10-11 03:39:02] [debug] ðŸ‘¤ MembershipOrderHandler: Updating user role...
[2025-10-11 03:39:02] [debug] ðŸ‘¤ Helper: Changing user role Array
(
    [user_id] => 1935
    [old_role] => customer
    [new_role] => ui_member
)

[2025-10-11 03:39:02] [debug] âœ… Helper: User role changed successfully Array
(
    [user_id] => 1935
    [from] => customer
    [to] => ui_member
    [current_roles] => Array
        (
            [0] => ui_member
        )

)

[2025-10-11 03:39:02] [debug] MembershipOrderHandler: Updated user role to ui_member (individual) 1935
[2025-10-11 03:39:02] [debug] ðŸ“‹ MembershipOrderHandler: Building registration request...
[2025-10-11 03:39:02] [debug] ðŸ”„ Helper: Converting WC name to LGL name Array
(
    [input] => Individual Membership
)

[2025-10-11 03:39:02] [debug] âš ï¸ Helper: No name mapping found, returning original Array
(
    [wc_name] => Individual Membership
)

[2025-10-11 03:39:02] [debug] ðŸ“‹ MembershipOrderHandler: Registration request built Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168341
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88074
    [user_id] => 1935
)

[2025-10-11 03:39:02] [debug] ðŸ’¾ MembershipOrderHandler: Processing user data updates...
[2025-10-11 03:39:02] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:39:02] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:39:02] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1935
)

[2025-10-11 03:39:02] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1935
    [type] => Individual Membership
)

[2025-10-11 03:39:02] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1935
)

[2025-10-11 03:39:02] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:39:02] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88074
    [total] => 77.63
)

[2025-10-11 03:39:02] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:39:02] [debug] LGL Constituents: ðŸ” Checking price match Array
(
    [level_name] => Indvidual
    [level_price] => 75
    [order_total] => 77.63
    [difference] => 2.63
    [tolerance] => 7.5
    [matches] => 1
)

[2025-10-11 03:39:02] [debug] LGL Constituents: âœ… Found matching membership level by price Array
(
    [level] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [order_total] => 77.63
    [level_price] => 75
    [difference] => 2.63
)

[2025-10-11 03:39:02] [debug] LGL Constituents: ðŸ“‹ Final level config Array
(
    [level_name] => Indvidual
    [level_slug] => individual
    [lgl_membership_level_id] => 412
    [price] => 75
)

[2025-10-11 03:39:02] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1935
    [membership_type] => Individual Membership
    [level_config] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 412
            [membership_level_name] => Indvidual
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:39:02] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 412
    [membership_level_name] => Indvidual
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:39:02] [debug] LGL Constituents: All data set for user 1935
[2025-10-11 03:39:02] [debug] LGL Constituents: Constituent created successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 946862
            [external_constituent_id] => 
            [is_org] => 
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => 
            [job_title] => 
            [addressee] => Debug Test
            [salutation] => Debug
            [sort_name] => Test, Debug
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => Debug Test
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2025-10-11
            [alt_salutation] => Debug
            [alt_addressee] => Debug Test
            [honorary_name] => Debug Test
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2025-10-11T07:39:02Z
            [updated_at] => 2025-10-11T07:39:02Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                )

            [phone_numbers] => Array
                (
                )

            [email_addresses] => Array
                (
                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":946862,"external_constituent_id":null,"is_org":false,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":null,"job_title":null,"addressee":"Debug Test","salutation":"Debug","sort_name":"Test, Debug","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":"Debug Test","birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2025-10-11","alt_salutation":"Debug","alt_addressee":"Debug Test","honorary_name":"Debug Test","assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2025-10-11T07:39:02Z","updated_at":"2025-10-11T07:39:02Z","class_affiliations":[],"relationships":[],"street_addresses":[],"phone_numbers":[],"email_addresses":[],"web_addresses":[],"categories":[],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:39:02] [debug] MembershipOrderHandler: User data updated 1935
[2025-10-11 03:39:02] [debug] ðŸ”— MembershipOrderHandler: Starting LGL registration...
[2025-10-11 03:39:02] [debug] ðŸ”— MembershipOrderHandler::registerUserInLGL() STARTED Array
(
    [user_id] => 1935
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88074
)

[2025-10-11 03:39:02] [debug] ðŸ”„ MembershipOrderHandler: Getting LGL_API instance...
[2025-10-11 03:39:02] [debug] ðŸ“¤ MembershipOrderHandler: Sending registration request to LGL_API...
[2025-10-11 03:39:02] [debug] ðŸ“‹ MembershipOrderHandler: Full registration data Array
(
    [user_firstname] => Debug
    [user_lastname] => Test
    [user_company] => 
    [username] => debug_test_user
    [user_email] => debug.test@example.com
    [user_phone] => 555-DEBUG
    [user-address-1] => 
    [user-address-2] => 
    [user-city] => 
    [user-state] => 
    [user-postal-code] => 
    [user-country-of-origin] => United States
    [current_date] => 1760168341
    [price] => 77.63
    [ui-membership-type] => Individual Membership
    [inserted_post_id] => 88074
    [user_id] => 1935
)

[2025-10-11 03:39:02] [debug] ðŸš€ UserRegistrationAction::handle() STARTED Array
(
    [timestamp] => 2025-10-11 03:39:02
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

    [action_handler_type] => array
)

[2025-10-11 03:39:02] [debug] ðŸ“‹ UserRegistrationAction: Processing valid request Array
(
    [user_id] => 1935
    [user_email] => debug.test@example.com
    [membership_type] => Individual Membership
    [order_id] => 88074
)

[2025-10-11 03:39:02] [debug] ðŸ‘¤ UserRegistrationAction: User Details Array
(
    [user_id] => 1935
    [username] => Debug%20Test
    [email] => debug.test@example.com
    [membership_level] => Individual Membership
    [method] => 
)

[2025-10-11 03:39:02] [debug] ðŸ’³ UserRegistrationAction: Setting payment method...
[2025-10-11 03:39:02] [debug] Payment method set:  online
[2025-10-11 03:39:02] [debug] ðŸ·ï¸ UserRegistrationAction: Assigning membership role...
[2025-10-11 03:39:02] [debug] ðŸ” UserRegistrationAction: Searching for existing LGL contact...
[2025-10-11 03:39:02] [debug] ðŸ” Connection::searchByName() STARTED Array
(
    [name] => Debug%20Test
    [email] => debug.test@example.com
)

[2025-10-11 03:39:02] [debug] ðŸ” Trying search method 1 Array
(
    [endpoint] => constituents
    [params] => Array
        (
            [email] => debug.test@example.com
        )

)

[2025-10-11 03:39:03] [debug] ðŸ” Search method 1 response Array
(
    [success] => 1
    [http_code] => 200
    [has_data] => 1
    [data_type] => array
)

[2025-10-11 03:39:03] [debug] ðŸ” extractConstituentsFromResponse() - Raw data analysis Array
(
    [data_type] => array
    [data_keys] => Array
        (
            [0] => api_version
            [1] => items_count
            [2] => total_items
            [3] => limit
            [4] => offset
            [5] => next_item
            [6] => next_link
            [7] => item_type
            [8] => items
        )

    [data_sample] => 
)

[2025-10-11 03:39:03] [debug] âœ… Found LGL API format with items array Array
(
    [count] => 25
)

[2025-10-11 03:39:03] [debug] âœ… Found 25 constituents with method 1
[2025-10-11 03:39:03] [debug] ðŸ” Examining first constituent structure Array
(
    [constituent_type] => array
    [constituent_keys] => Array
        (
            [0] => id
            [1] => external_constituent_id
            [2] => is_org
            [3] => constituent_contact_type_id
            [4] => constituent_contact_type_name
            [5] => prefix
            [6] => first_name
            [7] => middle_name
            [8] => last_name
            [9] => suffix
            [10] => spouse_name
            [11] => org_name
            [12] => job_title
            [13] => addressee
            [14] => salutation
            [15] => sort_name
            [16] => constituent_interest_level_id
            [17] => constituent_interest_level_name
            [18] => constituent_rating_id
            [19] => constituent_rating_name
            [20] => is_deceased
            [21] => deceased_date
            [22] => annual_report_name
            [23] => birthday
            [24] => gender
            [25] => maiden_name
            [26] => nick_name
            [27] => spouse_nick_name
            [28] => date_added
            [29] => alt_salutation
            [30] => alt_addressee
            [31] => honorary_name
            [32] => assistant_name
            [33] => marital_status_id
            [34] => marital_status_name
            [35] => is_anon
            [36] => created_at
            [37] => updated_at
        )

    [has_id_property] => 1
    [id_value] => 944817
)

[2025-10-11 03:39:03] [debug] âœ… Email search match found Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:39:03] [debug] ðŸ” UserRegistrationAction: LGL search result Array
(
    [lgl_id] => 944817
    [found_existing] => YES
)

[2025-10-11 03:39:03] [debug] ðŸ”„ UserRegistrationAction: Updating existing LGL constituent...
[2025-10-11 03:39:03] [debug] LGL Constituents: Name set Array
(
    [first_name] => Debug
    [last_name] => Test
    [full_name] => Debug Test
)

[2025-10-11 03:39:03] [debug] LGL Constituents: Email set debug.test@example.com
[2025-10-11 03:39:03] [debug] LGL Constituents: ðŸŽ¯ setMembership() CALLED! Array
(
    [user_id] => 1935
)

[2025-10-11 03:39:03] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [user_id] => 1935
    [type] => Individual Membership
)

[2025-10-11 03:39:03] [debug] LGL Constituents: ðŸ” Looking up membership level config Array
(
    [membership_type] => Individual Membership
    [user_id] => 1935
)

[2025-10-11 03:39:03] [debug] LGL Constituents: âš ï¸ No level config found by name, trying price-based lookup
[2025-10-11 03:39:03] [debug] LGL Constituents: ðŸ›’ Found recent order Array
(
    [order_id] => 88074
    [total] => 77.63
)

[2025-10-11 03:39:03] [debug] LGL Constituents: ðŸ” Constituents: Retrieved membership levels from ApiSettings Array
(
    [count] => 4
    [levels] => Array
        (
            [0] => Array
                (
                    [level_name] => Indvidual
                    [level_slug] => individual
                    [lgl_membership_level_id] => 412
                    [price] => 75
                )

            [1] => Array
                (
                    [level_name] => Family
                    [level_slug] => family
                    [lgl_membership_level_id] => 407
                    [price] => 125
                )

            [2] => Array
                (
                    [level_name] => Patron
                    [level_slug] => patron
                    [lgl_membership_level_id] => 402
                    [price] => 200
                )

            [3] => Array
                (
                    [level_name] => Patron Family
                    [level_slug] => patron-family
                    [lgl_membership_level_id] => 417
                    [price] => 250
                )

        )

)

[2025-10-11 03:39:03] [debug] LGL Constituents: ðŸ” Checking price match Array
(
    [level_name] => Indvidual
    [level_price] => 75
    [order_total] => 77.63
    [difference] => 2.63
    [tolerance] => 7.5
    [matches] => 1
)

[2025-10-11 03:39:03] [debug] LGL Constituents: âœ… Found matching membership level by price Array
(
    [level] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [order_total] => 77.63
    [level_price] => 75
    [difference] => 2.63
)

[2025-10-11 03:39:03] [debug] LGL Constituents: ðŸ“‹ Final level config Array
(
    [level_name] => Indvidual
    [level_slug] => individual
    [lgl_membership_level_id] => 412
    [price] => 75
)

[2025-10-11 03:39:03] [debug] LGL Constituents: Modern Membership Data Created Array
(
    [user_id] => 1935
    [membership_type] => Individual Membership
    [level_config] => Array
        (
            [level_name] => Indvidual
            [level_slug] => individual
            [lgl_membership_level_id] => 412
            [price] => 75
        )

    [membership_data] => Array
        (
            [membership_type] => Individual Membership
            [membership_level_id] => 412
            [membership_level_name] => Indvidual
            [membership_status] => active
            [date_start] => 2025-10-11
            [finish_date] => 2026-10-11
            [payment_method] => 
            [note] => Membership created via Modern LGL API on 2025-10-11
            [parent_user_id] => 
        )

)

[2025-10-11 03:39:03] [debug] LGL Constituents: Final Membership Data Set Array
(
    [membership_type] => Individual Membership
    [membership_level_id] => 412
    [membership_level_name] => Indvidual
    [membership_status] => active
    [date_start] => 2025-10-11
    [finish_date] => 2026-10-11
    [payment_method] => 
    [note] => Membership created via Modern LGL API on 2025-10-11
    [parent_user_id] => 
)

[2025-10-11 03:39:03] [debug] LGL Constituents: All data set for user 1935
[2025-10-11 03:39:03] [debug] LGL Constituents: Constituent updated successfully Array
(
    [success] => 1
    [http_code] => 200
    [data] => Array
        (
            [api_version] => 1.0
            [id] => 944817
            [external_constituent_id] => t00004
            [is_org] => 1
            [constituent_contact_type_id] => 1247
            [constituent_contact_type_name] => Primary
            [prefix] => 
            [first_name] => Debug
            [middle_name] => 
            [last_name] => Test
            [suffix] => 
            [spouse_name] => 
            [org_name] => Avengers Mansion Headquarters of the Avengers
            [job_title] => 
            [addressee] => Headquarters of the Avengers
            [salutation] => Debug
            [sort_name] => Avengers Mansion Headquarters of the Avengers
            [constituent_interest_level_id] => 
            [constituent_interest_level_name] => 
            [constituent_rating_id] => 
            [constituent_rating_name] => 
            [is_deceased] => 
            [deceased_date] => 
            [annual_report_name] => 
            [birthday] => 
            [gender] => 
            [maiden_name] => 
            [nick_name] => 
            [spouse_nick_name] => 
            [date_added] => 2023-02-27
            [alt_salutation] => Debug
            [alt_addressee] => Headquarters of the Avengers
            [honorary_name] => 
            [assistant_name] => 
            [marital_status_id] => 
            [marital_status_name] => 
            [is_anon] => 
            [created_at] => 2023-02-27T13:27:32Z
            [updated_at] => 2025-10-11T07:39:03Z
            [class_affiliations] => Array
                (
                )

            [relationships] => Array
                (
                )

            [street_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 838407
                            [street] => 890 Fifth Avenue
                            [city] => Manhattan
                            [state] => NY
                            [country] => US
                            [postal_code] => 10021
                            [county] => 
                            [street_address_type_id] => 1
                            [street_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [seasonal_from] => 01-01
                            [seasonal_to] => 12-31
                            [seasonal] => 
                            [lat] => 
                            [lng] => 
                            [zip5] => 10021
                            [verified] => 
                            [verified_on] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [phone_numbers] => Array
                (
                    [0] => Array
                        (
                            [id] => 479977
                            [number] => (888) 555-0004
                            [phone_number_type_id] => 2
                            [phone_type_name] => Work
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [normalized_number] => 8885550004
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [email_addresses] => Array
                (
                    [0] => Array
                        (
                            [id] => 276867
                            [address] => mansion@avengers.com
                            [email_address_type_id] => 1
                            [email_type_name] => Home
                            [is_preferred] => 1
                            [not_current] => 
                            [parent_id] => 
                            [created_at] => 2023-02-27T13:27:32Z
                            [updated_at] => 2023-02-27T13:27:32Z
                        )

                )

            [web_addresses] => Array
                (
                )

            [categories] => Array
                (
                    [0] => Array
                        (
                            [id] => 1287
                            [item_type] => Constituent
                            [name] => Giving Status
                            [key] => giving_status
                            [facet_type] => list
                            [ordinal] => 100
                            [removable] => 
                            [editable] => 
                            [display_format] => compact
                            [keywords] => Array
                                (
                                    [0] => Array
                                        (
                                            [id] => 12777
                                            [category_id] => 1287
                                            [name] => Top 100 Donor
                                            [description] => 
                                            [short_code] => top_100_donor
                                            [ordinal] => 0
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                    [1] => Array
                                        (
                                            [id] => 12792
                                            [category_id] => 1287
                                            [name] => Lapsed Donor
                                            [description] => 
                                            [short_code] => lapsed_donor
                                            [ordinal] => 3
                                            [removable] => 
                                            [can_change] => 1
                                            [can_select] => 1
                                            [created_at] => 2023-02-25T00:56:33Z
                                            [updated_at] => 2023-02-25T00:56:33Z
                                        )

                                )

                        )

                )

            [groups] => Array
                (
                )

            [memberships] => Array
                (
                )

            [custom_attrs] => Array
                (
                )

        )

    [raw_response] => {"api_version":"1.0","id":944817,"external_constituent_id":"t00004","is_org":true,"constituent_contact_type_id":1247,"constituent_contact_type_name":"Primary","prefix":null,"first_name":"Debug","middle_name":null,"last_name":"Test","suffix":null,"spouse_name":null,"org_name":"Avengers Mansion Headquarters of the Avengers","job_title":null,"addressee":"Headquarters of the Avengers","salutation":"Debug","sort_name":"Avengers Mansion Headquarters of the Avengers","constituent_interest_level_id":null,"constituent_interest_level_name":null,"constituent_rating_id":null,"constituent_rating_name":null,"is_deceased":false,"deceased_date":null,"annual_report_name":null,"birthday":null,"gender":"","maiden_name":null,"nick_name":null,"spouse_nick_name":null,"date_added":"2023-02-27","alt_salutation":"Debug","alt_addressee":"Headquarters of the Avengers","honorary_name":null,"assistant_name":null,"marital_status_id":null,"marital_status_name":null,"is_anon":false,"created_at":"2023-02-27T13:27:32Z","updated_at":"2025-10-11T07:39:03Z","class_affiliations":[],"relationships":[],"street_addresses":[{"id":838407,"street":"890 Fifth Avenue","city":"Manhattan","state":"NY","country":"US","postal_code":"10021","county":null,"street_address_type_id":1,"street_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"seasonal_from":"01-01","seasonal_to":"12-31","seasonal":null,"lat":null,"lng":null,"zip5":"10021","verified":false,"verified_on":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"phone_numbers":[{"id":479977,"number":"(888) 555-0004","phone_number_type_id":2,"phone_type_name":"Work","is_preferred":true,"not_current":false,"parent_id":null,"normalized_number":"8885550004","created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"email_addresses":[{"id":276867,"address":"mansion@avengers.com","email_address_type_id":1,"email_type_name":"Home","is_preferred":true,"not_current":false,"parent_id":null,"created_at":"2023-02-27T13:27:32Z","updated_at":"2023-02-27T13:27:32Z"}],"web_addresses":[],"categories":[{"id":1287,"item_type":"Constituent","name":"Giving Status","key":"giving_status","facet_type":"list","ordinal":100,"removable":false,"editable":false,"display_format":"compact","keywords":[{"id":12777,"category_id":1287,"name":"Top 100 Donor","description":null,"short_code":"top_100_donor","ordinal":0,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"},{"id":12792,"category_id":1287,"name":"Lapsed Donor","description":null,"short_code":"lapsed_donor","ordinal":3,"removable":false,"can_change":true,"can_select":true,"created_at":"2023-02-25T00:56:33Z","updated_at":"2023-02-25T00:56:33Z"}]}],"groups":[],"memberships":[],"custom_attrs":[]}
)

[2025-10-11 03:39:04] [debug] âœ… Updated LGL constituent Array
(
    [lgl_id] => 944817
)

[2025-10-11 03:39:04] [debug] ðŸ’³ UserRegistrationAction: Adding payment object...
[2025-10-11 03:39:04] [debug] ðŸ’³ UserRegistrationAction: Starting payment creation Array
(
    [uid] => 1935
    [lgl_id] => 944817
    [request_keys] => Array
        (
            [0] => user_firstname
            [1] => user_lastname
            [2] => user_company
            [3] => username
            [4] => user_email
            [5] => user_phone
            [6] => user-address-1
            [7] => user-address-2
            [8] => user-city
            [9] => user-state
            [10] => user-postal-code
            [11] => user-country-of-origin
            [12] => current_date
            [13] => price
            [14] => ui-membership-type
            [15] => inserted_post_id
            [16] => user_id
        )

)

[2025-10-11 03:39:04] [debug] ðŸ’³ Payment details extracted Array
(
    [order_id] => 88074
    [price] => 77.63
    [date] => 2025-10-11
    [payment_type] => online
)

[2025-10-11 03:39:04] [debug] ðŸ” LGL Payments: retrievePaymentTypes called Array
(
    [method] => Memberships
)

[2025-10-11 03:39:04] [debug] ðŸ” LGL Payments: Using cached data
[2025-10-11 03:39:04] [debug] LGL Payments: Payment data retrieved Array
(
    [method] => Memberships
    [data_keys] => Array
        (
            [0] => payment_types
            [1] => gift_types
            [2] => funds
            [3] => campaigns
            [4] => categories
            [5] => method
            [6] => retrieved_at
        )

    [funds_count] => 9
    [campaigns_count] => 7
    [payment_types_count] => 7
)

[2025-10-11 03:39:04] [debug] ðŸ’³ Connection::addPayment() Array
(
    [lgl_id] => 944817
    [payment_data] => Array
        (
            [external_id] => 88074
            [is_anon] => 
            [gift_type_id] => 
            [gift_type_name] => Other Income
            [gift_category_id] => 
            [gift_category_name] => Donation
            [campaign_id] => 
            [campaign_name] => Membership Fees
            [fund_id] => 
            [fund_name] => General Fund
            [appeal_id] => 0
            [appeal_name] => 
            [event_id] => 0
            [event_name] => 
            [received_amount] => 77.63
            [received_date] => 2025-10-11
            [payment_type_id] => 
            [payment_type_name] => online
            [check_number] => 
            [deductible_amount] => 77.63
            [note] => Website Registration, Order #88074
            [ack_template_name] => 
            [deposit_date] => 2025-10-11
            [deposited_amount] => 77.63
            [parent_gift_id] => 0
            [parent_external_id] => 0
            [team_member] => 
        )

)

[2025-10-11 03:39:04] [debug] âœ… Payment added successfully Array
(
    [payment_id] => 905257
)

[2025-10-11 03:39:04] [debug] LGL Payments: Membership payment created Array
(
    [lgl_id] => 944817
    [order_id] => 88074
    [amount] => 77.63
)

[2025-10-11 03:39:04] [debug] âœ… Added payment object successfully Array
(
    [payment_id] => 905257
    [lgl_id] => 944817
    [order_id] => 88074
    [amount] => 77.63
)

[2025-10-11 03:39:04] [debug] âœ… UserRegistrationAction::handle() COMPLETED SUCCESSFULLY Array
(
    [user_id] => 1935
    [lgl_id] => 944817
    [DEBUG_CHECKPOINT] => handleExistingConstituent should have been called above
)

[2025-10-11 03:39:04] [debug] ðŸ“¥ MembershipOrderHandler: LGL_API registration result Array
(
    [result] => 
    [user_id] => 1935
    [success] => Registration call completed
)

[2025-10-11 03:39:04] [debug] âœ… MembershipOrderHandler::registerUserInLGL() COMPLETED Array
(
    [user_id] => 1935
    [lgl_api_called] => YES
)

[2025-10-11 03:39:04] [debug] âœ… MembershipOrderHandler: Completing order...
[2025-10-11 03:39:04] [debug] âœ… MembershipOrderHandler::processOrder() COMPLETED SUCCESSFULLY Array
(
    [order_id] => 88074
    [user_id] => 1935
    [final_membership_level] => Individual Membership
)

[2025-10-11 03:39:04] [debug] âœ… OrderProcessor: MembershipOrderHandler completed successfully
[2025-10-11 03:39:04] [debug] âœ… OrderProcessor::processOrderProducts() COMPLETED Array
(
    [products_processed] => 1
    [events_processed] => 0
    [attendees_created] => 0
)

[2025-10-11 03:39:04] [debug] âœ… OrderProcessor::processCompletedOrder() COMPLETED Array
(
    [order_id] => 88074
    [final_memory_usage] => 130MB
)

